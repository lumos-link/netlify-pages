<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>申请使用 - 数据资产管理系统</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <style>
    body { background: #f6f8fa; }
    .content-card { background: white; border-radius: 1rem; box-shadow: 0 2px 16px 0 #2563eb22; }
    .btn-primary { background: #2563eb; color: #fff; border-radius: 0.5rem; padding: 0.5rem 1.5rem; font-weight: 600; transition: background 0.2s; }
    .btn-primary:hover { background: #1d4ed8; }
    .btn-secondary { background: #6b7280; color: #fff; border-radius: 0.5rem; padding: 0.5rem 1.5rem; font-weight: 600; transition: background 0.2s; }
    .btn-secondary:hover { background: #4b5563; }
    .required::after { content: " *"; color: #dc2626; }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <!-- 顶部主导航栏 -->
  <header class="bg-gradient-to-r from-red-900 via-red-800 to-red-900 shadow flex items-center justify-between px-10 h-16 sticky top-0 z-20">
    <div class="flex items-center space-x-4">
      <div class="h-10 w-10 rounded-full border-2 border-red-400 shadow bg-white flex items-center justify-center">
        <svg class="h-6 w-6 text-red-500" fill="currentColor" viewBox="0 0 20 20">
          <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
      </div>
      <span class="text-xl font-bold text-white tracking-wide whitespace-nowrap">数据资产管理系统</span>
    </div>
    <nav class="flex-1 flex items-center justify-center space-x-8">
    </nav>
    <div class="flex items-center space-x-4">
      <a href="首页.html" class="text-red-100 hover:text-red-400 font-medium px-3 py-1 rounded border border-red-400 hover:bg-red-700 transition">
        <i class="fas fa-home mr-2"></i>返回首页
      </a>
      <div class="relative" id="user-dropdown">
        <div class="flex items-center space-x-2 cursor-pointer hover:bg-red-700 px-2 py-1 rounded-lg transition" onclick="toggleUserDropdown()">
          <img src="https://i.pravatar.cc/32?img=3" class="rounded-full w-8 h-8 border-2 border-red-200" alt="用户头像">
          <span class="text-red-100 text-sm">张三</span>
          <i class="fas fa-chevron-down text-xs text-red-300 transition-transform" id="dropdown-arrow"></i>
        </div>
        <div id="user-dropdown-menu" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-200 py-2 hidden z-50">
          <a href="个人中心.html" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 transition">
            <i class="fas fa-user-circle mr-3 text-red-500"></i>
            个人中心
          </a>
          <a href="#" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 transition">
            <i class="fas fa-cog mr-3 text-red-500"></i>
            系统管理
          </a>
          <div class="border-t border-gray-200 my-1"></div>
          <a href="#" class="flex items-center px-4 py-2 text-red-600 hover:bg-red-50 transition">
            <i class="fas fa-sign-out-alt mr-3"></i>
            退出
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- 主体内容区 -->
  <main class="flex-1 w-full max-w-7xl mx-auto py-8 px-4">
    <!-- 页面标题 -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-gray-900 mb-2">申请使用数据资产</h1>
      <p class="text-gray-600">填写申请表单以使用数据资产</p>
    </div>

    <!-- 申请表单 -->
    <div class="content-card p-8">
      <form id="applyForm" class="space-y-8">
        <!-- 申请类型选择 -->
        <div>
          <h3 class="text-lg font-semibold text-gray-800 mb-4">申请类型</h3>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <label class="flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors" onclick="selectApplyType('internal')">
              <input type="radio" name="applyType" value="internal" class="mr-3 text-blue-600 focus:ring-blue-500">
              <div class="flex-1">
                <div class="font-medium text-gray-800">集团内申请</div>
                <div class="text-sm text-gray-500 mt-1">申请使用集团内部数据资产</div>
              </div>
            </label>
            <label class="flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors" onclick="selectApplyType('external')">
              <input type="radio" name="applyType" value="external" class="mr-3 text-blue-600 focus:ring-blue-500">
              <div class="flex-1">
                <div class="font-medium text-gray-800">集团外申请</div>
                <div class="text-sm text-gray-500 mt-1">申请使用集团外部数据资产</div>
              </div>
            </label>
            <label class="flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors" onclick="selectApplyType('transfer')">
              <input type="radio" name="applyType" value="transfer" class="mr-3 text-blue-600 focus:ring-blue-500">
              <div class="flex-1">
                <div class="font-medium text-gray-800">资产权属转移</div>
                <div class="text-sm text-gray-500 mt-1">申请转移数据资产权属</div>
              </div>
            </label>
          </div>
        </div>

        <!-- 选择申请范围 -->
        <div id="selectScopeSection">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">选择申请范围</h3>

          <!-- 资产树形目录 -->
          <div class="border border-gray-200 rounded-lg p-4 max-h-96 overflow-y-auto">
            <div id="assetTree" class="space-y-2">
              <!-- 业务发展 -->
              <div class="tree-node">
                <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('business-development')">
                  <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="business-development-arrow"></i>
                  <i class="fas fa-folder text-blue-500 mr-2"></i>
                  <span class="font-medium text-gray-800">业务发展</span>
                </div>
                <div id="business-development" class="ml-6 hidden space-y-1">
                  <!-- 业务管理 -->
                  <div class="tree-node">
                    <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('business-management')">
                      <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="business-management-arrow"></i>
                      <i class="fas fa-folder text-green-500 mr-2"></i>
                      <span class="text-gray-700">业务管理</span>
                    </div>
                    <div id="business-management" class="ml-6 hidden space-y-1">
                      <!-- 非招标 -->
                      <div class="tree-node">
                        <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('non-bidding')">
                          <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="non-bidding-arrow"></i>
                          <i class="fas fa-database text-purple-500 mr-2"></i>
                          <span class="text-gray-700">非招标业务管理系统</span>
                        </div>
                        <div id="non-bidding" class="ml-6 hidden space-y-1">
                          <!-- 数据集 -->
                          <div class="tree-node">
                            <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('non-bidding-datasets')">
                              <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="non-bidding-datasets-arrow"></i>
                              <i class="fas fa-table text-orange-500 mr-2"></i>
                              <span class="text-gray-600">数据集</span>
                            </div>
                            <div id="non-bidding-datasets" class="ml-6 hidden space-y-1">
                              <div class="flex items-center hover:bg-gray-50 p-2 rounded">
                                <input type="checkbox" class="mr-3 text-blue-600 focus:ring-blue-500" value="non-bidding-contract" onchange="updateApplicationList()">
                                <i class="fas fa-table text-gray-400 mr-2"></i>
                                <span class="text-gray-600">合同数据表</span>
                              </div>
                              <div class="flex items-center hover:bg-gray-50 p-2 rounded">
                                <input type="checkbox" class="mr-3 text-blue-600 focus:ring-blue-500" value="non-bidding-supplier" onchange="updateApplicationList()">
                                <i class="fas fa-table text-gray-400 mr-2"></i>
                                <span class="text-gray-600">供应商数据表</span>
                              </div>
                              <div class="flex items-center hover:bg-gray-50 p-2 rounded">
                                <input type="checkbox" class="mr-3 text-blue-600 focus:ring-blue-500" value="non-bidding-bid" onchange="updateApplicationList()">
                                <i class="fas fa-table text-gray-400 mr-2"></i>
                                <span class="text-gray-600">投标数据表</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- 商城 -->
                      <div class="tree-node">
                        <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('mall')">
                          <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="mall-arrow"></i>
                          <i class="fas fa-database text-purple-500 mr-2"></i>
                          <span class="text-gray-700">商城运营管理系统</span>
                        </div>
                        <div id="mall" class="ml-6 hidden space-y-1">
                          <div class="tree-node">
                            <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('mall-datasets')">
                              <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="mall-datasets-arrow"></i>
                              <i class="fas fa-table text-orange-500 mr-2"></i>
                              <span class="text-gray-600">数据集</span>
                            </div>
                            <div id="mall-datasets" class="ml-6 hidden space-y-1">
                              <div class="flex items-center hover:bg-gray-50 p-2 rounded">
                                <input type="checkbox" class="mr-3 text-blue-600 focus:ring-blue-500" value="mall-product" onchange="updateApplicationList()">
                                <i class="fas fa-table text-gray-400 mr-2"></i>
                                <span class="text-gray-600">商品数据表</span>
                              </div>
                              <div class="flex items-center hover:bg-gray-50 p-2 rounded">
                                <input type="checkbox" class="mr-3 text-blue-600 focus:ring-blue-500" value="mall-order" onchange="updateApplicationList()">
                                <i class="fas fa-table text-gray-400 mr-2"></i>
                                <span class="text-gray-600">订单数据表</span>
                              </div>
                              <div class="flex items-center hover:bg-gray-50 p-2 rounded">
                                <input type="checkbox" class="mr-3 text-blue-600 focus:ring-blue-500" value="mall-user" onchange="updateApplicationList()">
                                <i class="fas fa-table text-gray-400 mr-2"></i>
                                <span class="text-gray-600">用户数据表</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- 集采 -->
                      <div class="tree-node">
                        <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('procurement')">
                          <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="procurement-arrow"></i>
                          <i class="fas fa-database text-purple-500 mr-2"></i>
                          <span class="text-gray-700">集采业务管理系统</span>
                        </div>
                        <div id="procurement" class="ml-6 hidden space-y-1">
                          <div class="tree-node">
                            <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('procurement-datasets')">
                              <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="procurement-datasets-arrow"></i>
                              <i class="fas fa-table text-orange-500 mr-2"></i>
                              <span class="text-gray-600">数据集</span>
                            </div>
                            <div id="procurement-datasets" class="ml-6 hidden space-y-1">
                              <div class="flex items-center hover:bg-gray-50 p-2 rounded">
                                <input type="checkbox" class="mr-3 text-blue-600 focus:ring-blue-500" value="procurement-plan" onchange="updateApplicationList()">
                                <i class="fas fa-table text-gray-400 mr-2"></i>
                                <span class="text-gray-600">采购计划表</span>
                              </div>
                              <div class="flex items-center hover:bg-gray-50 p-2 rounded">
                                <input type="checkbox" class="mr-3 text-blue-600 focus:ring-blue-500" value="procurement-contract" onchange="updateApplicationList()">
                                <i class="fas fa-table text-gray-400 mr-2"></i>
                                <span class="text-gray-600">采购合同表</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- 决策支持 -->
                  <div class="tree-node">
                    <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('decision-support')">
                      <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="decision-support-arrow"></i>
                      <i class="fas fa-folder text-green-500 mr-2"></i>
                      <span class="text-gray-700">决策支持</span>
                    </div>
                    <div id="decision-support" class="ml-6 hidden space-y-1">
                      <div class="tree-node">
                        <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('decision-support-datasets')">
                          <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="decision-support-datasets-arrow"></i>
                          <i class="fas fa-table text-orange-500 mr-2"></i>
                          <span class="text-gray-600">数据集</span>
                        </div>
                        <div id="decision-support-datasets" class="ml-6 hidden space-y-1">
                          <div class="flex items-center hover:bg-gray-50 p-2 rounded">
                            <input type="checkbox" class="mr-3 text-blue-600 focus:ring-blue-500" value="decision-report" onchange="updateApplicationList()">
                            <i class="fas fa-table text-gray-400 mr-2"></i>
                            <span class="text-gray-600">决策报告表</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- 绿色发展 -->
              <div class="tree-node">
                <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('green-development')">
                  <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="green-development-arrow"></i>
                  <i class="fas fa-folder text-blue-500 mr-2"></i>
                  <span class="font-medium text-gray-800">绿色发展</span>
                </div>
                <div id="green-development" class="ml-6 hidden space-y-1">
                  <div class="tree-node">
                    <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('carbon-footprint')">
                      <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="carbon-footprint-arrow"></i>
                      <i class="fas fa-database text-purple-500 mr-2"></i>
                      <span class="text-gray-700">产品碳足迹核算模型与数据</span>
                    </div>
                    <div id="carbon-footprint" class="ml-6 hidden space-y-1">
                      <div class="tree-node">
                        <div class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="toggleNode('carbon-footprint-datasets')">
                          <i class="fas fa-chevron-right text-gray-400 mr-2 transform transition-transform" id="carbon-footprint-datasets-arrow"></i>
                          <i class="fas fa-table text-orange-500 mr-2"></i>
                          <span class="text-gray-600">数据集</span>
                        </div>
                        <div id="carbon-footprint-datasets" class="ml-6 hidden space-y-1">
                          <div class="flex items-center hover:bg-gray-50 p-2 rounded">
                            <input type="checkbox" class="mr-3 text-blue-600 focus:ring-blue-500" value="carbon-emission" onchange="updateApplicationList()">
                            <i class="fas fa-table text-gray-400 mr-2"></i>
                            <span class="text-gray-600">碳排放数据表</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 申请清单 -->
          <div class="mt-6">
            <h4 class="text-md font-semibold text-gray-800 mb-3">申请清单</h4>
            <div id="applicationList" class="bg-gray-50 rounded-lg p-4 min-h-20">
              <div class="text-gray-500 text-sm">请选择要申请的数据表</div>
            </div>
          </div>
        </div>
      </div>

        <!-- 内部申请表单 -->
        <div id="internalApplyForm" class="hidden">
          <div class="space-y-6">
            <!-- 表单标题 -->
            <div class="text-center mb-8">
              <h2 class="text-2xl font-bold text-gray-800">物资公司数据使用申请单</h2>
            </div>

            <!-- 编号和申请日期 -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">编号</label>
                <input type="text" id="serialNumber" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="系统自动生成" readonly>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">申请日期 <span class="text-red-500">*</span></label>
                <input type="date" id="applicationDate" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
            </div>

            <!-- 申请人信息 -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">需求单位 <span class="text-red-500">*</span></label>
                <input type="text" id="requestingUnit" value="数据管理部" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">经办人 <span class="text-red-500">*</span></label>
                <input type="text" id="handler" value="张三" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">邮箱 <span class="text-red-500">*</span></label>
                <input type="email" id="email" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">联系电话 <span class="text-red-500">*</span></label>
                <input type="tel" id="phone" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
            </div>

            <!-- 需求类型 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">需求类型 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <label class="flex items-center">
                  <input type="checkbox" name="requestType" value="data_extraction" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">数据提取</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="requestType" value="data_access" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">数据接入 (API接口等方式)</span>
                </label>
              </div>
            </div>

            <!-- 使用期限 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">使用期限 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                <label class="flex items-center">
                  <input type="radio" name="usagePeriod" value="single" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">单次</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="usagePeriod" value="permanent" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">永久</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="usagePeriod" value="periodic" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">周期性</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="usagePeriod" value="other" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">其他</span>
                </label>
              </div>
            </div>

            <!-- 需求原因 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">需求原因 <span class="text-red-500">*</span></label>
              <textarea id="reason" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请详细说明申请使用该数据资产的原因和目的"></textarea>
            </div>

             <!-- 使用范围 -->
             <div>
               <label class="block text-sm font-medium text-gray-700 mb-3">使用范围 <span class="text-red-500">*</span></label>
               <div class="space-y-2">
                 <label class="flex items-center">
                   <input type="radio" name="usageScope" value="internal" class="mr-2 text-blue-600 focus:ring-blue-500">
                   <span class="text-sm text-gray-700">物资公司部门 (所属单位) 内部使用（不含物资公司下子公司）</span>
                 </label>
                 <label class="flex items-center">
                   <input type="radio" name="usageScope" value="group_internal" class="mr-2 text-blue-600 focus:ring-blue-500">
                   <span class="text-sm text-gray-700">物资公司外部、集团公司内部（含物资公司下子公司）</span>
                 </label>
                 <label class="flex items-center">
                   <input type="radio" name="usageScope" value="other" class="mr-2 text-blue-600 focus:ring-blue-500">
                   <span class="text-sm text-gray-700">其他</span>
                 </label>
               </div>
             </div>

            <!-- 使用时效 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">使用时效 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                <label class="flex items-center">
                  <input type="radio" name="usageValidity" value="within_week" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">一周内</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="usageValidity" value="within_month" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">一个月内</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="usageValidity" value="within_quarter" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">一个季度内</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="usageValidity" value="within_half_year" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">半年内</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="usageValidity" value="within_year" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">一年内</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="usageValidity" value="long_term" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">长期</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="usageValidity" value="other" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">其他</span>
                </label>
              </div>
            </div>

            <!-- 信息系统 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">信息系统 <span class="text-red-500">*</span></label>
              <input type="text" id="informationSystem" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入将使用该数据资产的信息系统名称">
            </div>

            <!-- 数据等级 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">数据等级 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                <label class="flex items-center">
                  <input type="radio" name="dataLevel" value="core" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">核心数据</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="dataLevel" value="important" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">重要数据</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="dataLevel" value="general" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">一般数据</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="dataLevel" value="public" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">公开数据</span>
                </label>
              </div>
            </div>

            <!-- 数据分类 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">数据分类 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                <label class="flex items-center">
                  <input type="checkbox" name="dataClassification" value="basic" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">基础数据</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="dataClassification" value="master" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">主数据</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="dataClassification" value="transaction" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">交易数据</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="dataClassification" value="indicator" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">指标数据</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="dataClassification" value="production" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">生产数据</span>
                </label>
              </div>
            </div>

            <!-- 权属类型 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">权属类型 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                <label class="flex items-center">
                  <input type="checkbox" name="ownershipType" value="data_holding" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">数据资源持有权</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="ownershipType" value="data_processing" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">数据加工使用权</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="ownershipType" value="data_product" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">数据产品经营权</span>
                </label>
              </div>
            </div>

            <!-- 数据类型 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">数据类型 <span class="text-red-500">*</span></label>
              <div class="flex space-x-6">
                <label class="flex items-center">
                  <input type="radio" name="dataType" value="raw" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">原始数据</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="dataType" value="processed" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">加工数据</span>
                </label>
              </div>
            </div>

            <!-- 需求内容 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">需求内容 <span class="text-red-500">*</span></label>
              <textarea id="requestContent" rows="4" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请详细描述对数据资产的具体需求，包括数据字段、格式要求、处理方式等"></textarea>
            </div>

            <!-- 需求单位意见 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">需求单位意见</label>
              <textarea id="unitOpinion" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请填写需求单位对该申请的意见和建议"></textarea>
            </div>

             <!-- 负责人签字和日期 -->
             <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
               <div>
                 <label class="block text-sm font-medium text-gray-700 mb-2">负责人签字</label>
                 <input type="text" id="signature" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入负责人姓名">
               </div>
               <div>
                 <label class="block text-sm font-medium text-gray-700 mb-2">年···月···日</label>
                 <input type="date" id="signatureDate" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
               </div>
             </div>

             <!-- 附件上传 -->
             <div>
               <label class="block text-sm font-medium text-gray-700 mb-2">附件上传</label>
               <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                 <input type="file" id="attachment-upload" class="hidden" multiple onchange="updateAttachmentFileNames()">
                 <label for="attachment-upload" class="cursor-pointer">
                   <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                   <div class="text-sm text-gray-600">点击上传附件</div>
                   <div class="text-xs text-gray-500 mt-1">支持 PDF, DOC, DOCX, XLS, XLSX, JPG, PNG 格式</div>
                 </label>
                 <div id="attachment-file-names" class="mt-2 text-sm text-blue-600 hidden"></div>
               </div>
             </div>
           </div>
         </div>

        <!-- 外部申请表单 -->
        <div id="externalApplyForm" class="hidden">
          <div class="space-y-6">
            <!-- 表单标题 -->
            <div class="text-center mb-8">
              <h2 class="text-2xl font-bold text-gray-800">物资公司数据使用申请单（外部）</h2>
            </div>

            <!-- 编号和申请日期 -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">编号</label>
                <input type="text" id="external-serialNumber" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="系统自动生成" readonly>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">申请日期 <span class="text-red-500">*</span></label>
                <input type="date" id="external-applicationDate" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
            </div>

            <!-- 申请人信息 -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">需求单位 <span class="text-red-500">*</span></label>
                <input type="text" id="external-requestingUnit" value="数据管理部" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">经办人 <span class="text-red-500">*</span></label>
                <input type="text" id="external-handler" value="张三" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">邮箱 <span class="text-red-500">*</span></label>
                <input type="email" id="external-email" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">联系电话 <span class="text-red-500">*</span></label>
                <input type="tel" id="external-phone" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
            </div>

            <!-- 需求类型 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">需求类型 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <label class="flex items-center">
                  <input type="checkbox" name="external-requestType" value="data_extraction" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">数据提取</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="external-requestType" value="data_access" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">数据接入 (API接口等方式)</span>
                </label>
              </div>
            </div>

            <!-- 使用期限 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">使用期限 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                <label class="flex items-center">
                  <input type="radio" name="external-usagePeriod" value="single" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">单次</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-usagePeriod" value="permanent" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">永久</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-usagePeriod" value="periodic" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">周期性</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-usagePeriod" value="other" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">其他</span>
                </label>
              </div>
            </div>

            <!-- 需求原因 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">需求原因 <span class="text-red-500">*</span></label>
              <textarea id="external-reason" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请详细说明申请使用该数据资产的原因和目的"></textarea>
            </div>

             <!-- 使用范围 -->
             <div>
               <label class="block text-sm font-medium text-gray-700 mb-3">使用范围 <span class="text-red-500">*</span></label>
               <div class="space-y-2">
                 <label class="flex items-center">
                   <input type="radio" name="external-usageScope" value="group_external" class="mr-2 text-blue-600 focus:ring-blue-500">
                   <span class="text-sm text-gray-700">集团公司外部</span>
                 </label>
                 <label class="flex items-center">
                   <input type="radio" name="external-usageScope" value="other" class="mr-2 text-blue-600 focus:ring-blue-500">
                   <span class="text-sm text-gray-700">其他</span>
                 </label>
               </div>
             </div>

            <!-- 使用时效 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">使用时效 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                <label class="flex items-center">
                  <input type="radio" name="external-usageValidity" value="within_week" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">一周内</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-usageValidity" value="within_month" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">一个月内</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-usageValidity" value="within_quarter" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">一个季度内</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-usageValidity" value="within_half_year" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">半年内</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-usageValidity" value="within_year" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">一年内</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-usageValidity" value="long_term" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">长期</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-usageValidity" value="other" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">其他</span>
                </label>
              </div>
            </div>

            <!-- 信息系统 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">信息系统 <span class="text-red-500">*</span></label>
              <input type="text" id="external-informationSystem" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入将使用该数据资产的信息系统名称">
            </div>

            <!-- 数据等级 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">数据等级 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                <label class="flex items-center">
                  <input type="radio" name="external-dataLevel" value="core" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">核心数据</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-dataLevel" value="important" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">重要数据</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-dataLevel" value="general" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">一般数据</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-dataLevel" value="public" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">公开数据</span>
                </label>
              </div>
            </div>

            <!-- 数据分类 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">数据分类 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                <label class="flex items-center">
                  <input type="checkbox" name="external-dataClassification" value="basic" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">基础数据</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="external-dataClassification" value="master" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">主数据</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="external-dataClassification" value="transaction" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">交易数据</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="external-dataClassification" value="indicator" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">指标数据</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="external-dataClassification" value="production" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">生产数据</span>
                </label>
              </div>
            </div>

            <!-- 权属类型 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">权属类型 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                <label class="flex items-center">
                  <input type="checkbox" name="external-ownershipType" value="data_holding" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">数据资源持有权</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="external-ownershipType" value="data_processing" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">数据加工使用权</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="external-ownershipType" value="data_product" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">数据产品经营权</span>
                </label>
              </div>
            </div>

            <!-- 数据类型 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">数据类型 <span class="text-red-500">*</span></label>
              <div class="flex space-x-6">
                <label class="flex items-center">
                  <input type="radio" name="external-dataType" value="raw" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">原始数据</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="external-dataType" value="processed" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">加工数据</span>
                </label>
              </div>
            </div>

            <!-- 需求内容 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">需求内容 <span class="text-red-500">*</span></label>
              <textarea id="external-requestContent" rows="4" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请详细描述对数据资产的具体需求，包括数据字段、格式要求、处理方式等"></textarea>
            </div>

            <!-- 需求单位意见 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">需求单位意见</label>
              <textarea id="external-unitOpinion" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请填写需求单位对该申请的意见和建议"></textarea>
            </div>

            <!-- 负责人签字和日期 -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">负责人签字</label>
                <input type="text" id="external-signature" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入负责人姓名">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">年···月···日</label>
                <input type="date" id="external-signatureDate" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
            </div>

            <!-- 合同上传 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">合同文件 <span class="text-red-500">*</span></label>
              <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                <input type="file" id="external-contract-upload" class="hidden" onchange="updateExternalContractFileName()">
                <label for="external-contract-upload" class="cursor-pointer">
                  <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                  <div class="text-sm text-gray-600">点击上传合同文件</div>
                  <div class="text-xs text-gray-500 mt-1">支持 PDF, DOC, DOCX 格式</div>
                </label>
                <div id="external-contract-file-name" class="mt-2 text-sm text-blue-600 hidden"></div>
              </div>
            </div>

            <!-- 买受方和账面价值 -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">买受方 <span class="text-red-500">*</span></label>
                <input type="text" id="external-buyer" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入买受方信息">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">账面价值 <span class="text-red-500">*</span></label>
                <input type="text" id="external-bookValue" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入账面价值">
              </div>
            </div>
          </div>
        </div>

        <!-- 资产权属转移表单 -->
        <div id="transferApplyForm" class="hidden">
          <div class="space-y-6">
            <!-- 表单标题 -->
            <div class="text-center mb-8">
              <h2 class="text-2xl font-bold text-gray-800">物资公司资产权属转移申请单</h2>
            </div>

            <!-- 基本信息 -->
            <div class="mb-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">基本信息</h3>
              
              <!-- 编号和申请日期 -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">编号</label>
                  <input type="text" id="transfer-serialNumber" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="系统自动生成" readonly>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">申请日期 <span class="text-red-500">*</span></label>
                  <input type="date" id="transfer-applicationDate" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
              </div>

              <!-- 申请人信息 -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">需求单位 <span class="text-red-500">*</span></label>
                  <input type="text" id="transfer-requestingUnit" value="数据管理部" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">经办人 <span class="text-red-500">*</span></label>
                  <input type="text" id="transfer-handler" value="张三" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">邮箱 <span class="text-red-500">*</span></label>
                  <input type="email" id="transfer-email" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">联系电话 <span class="text-red-500">*</span></label>
                  <input type="tel" id="transfer-phone" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
              </div>
            </div>

            <!-- 需求类型 -->
            <div class="mb-6">
              <label class="block text-sm font-medium text-gray-700 mb-3">需求类型 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <label class="flex items-center">
                  <input type="checkbox" name="transfer-requestType" value="data_extraction" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">数据提取</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="transfer-requestType" value="data_access" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">数据接入 (API接口等方式)</span>
                </label>
              </div>
            </div>

            <!-- 信息系统 -->
            <div class="mb-6">
              <label class="block text-sm font-medium text-gray-700 mb-2">信息系统 <span class="text-red-500">*</span></label>
              <input type="text" id="transfer-informationSystem" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入使用的信息系统名称">
            </div>

            <!-- 数据等级 -->
            <div class="mb-6">
              <label class="block text-sm font-medium text-gray-700 mb-3">数据等级 <span class="text-red-500">*</span></label>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                <label class="flex items-center">
                  <input type="radio" name="transfer-dataLevel" value="core" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">核心数据</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="transfer-dataLevel" value="important" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">重要数据</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="transfer-dataLevel" value="general" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">一般数据</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="transfer-dataLevel" value="public" class="mr-2 text-blue-600 focus:ring-blue-500">
                  <span class="text-sm text-gray-700">公开数据</span>
                </label>
              </div>
            </div>

            <!-- 负责人签字和日期 -->
            <div class="mb-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">负责人签字</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">负责人签字 <span class="text-red-500">*</span></label>
                  <input type="text" id="transfer-signature" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入负责人姓名">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">填写日期 <span class="text-red-500">*</span></label>
                  <input type="date" id="transfer-signatureDate" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
              </div>
            </div>

            <!-- 合同 -->
            <div class="mb-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">合同信息</h3>
              
              <!-- 合同上传 -->
              <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">合同文件 <span class="text-red-500">*</span></label>
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                  <input type="file" id="transfer-contract-upload" class="hidden" onchange="updateTransferContractFileName()">
                  <label for="transfer-contract-upload" class="cursor-pointer">
                    <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                    <div class="text-sm text-gray-600">点击上传合同文件</div>
                    <div class="text-xs text-gray-500 mt-1">支持 PDF, DOC, DOCX 格式</div>
                  </label>
                  <div id="transfer-contract-file-name" class="mt-2 text-sm text-blue-600 hidden"></div>
                </div>
              </div>

              <!-- 买受方和合同额 -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">买受方 <span class="text-red-500">*</span></label>
                  <input type="text" id="transfer-buyer" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入买受方信息">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">合同额 <span class="text-red-500">*</span></label>
                  <div class="relative">
                    <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">¥</span>
                    <input type="number" id="transfer-contractAmount" placeholder="请输入合同额" step="0.01" min="0" class="w-full border border-gray-300 rounded-lg pl-8 pr-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 提交按钮 -->
        <div class="flex items-center justify-end space-x-4 pt-6 border-t border-gray-200">
          <button type="button" onclick="window.location.href='数据资产.html'" class="btn-secondary">
            取消
          </button>
          <button type="button" onclick="submitApplicationAndReturn()" class="btn-primary">
            提交申请
          </button>
        </div>
      </form>
    </div>
  </main>

  <script>
    // 资产信息映射
    const assetInfoMap = {
      'non-bidding': '非招标业务全流程管理系统，涵盖非招标申请、审批、执行、监控等核心业务环节',
      'mall': '商城运营全流程管理系统，涵盖商品管理、订单处理、用户行为分析等核心业务数据',
      'procurement': '集中采购业务管理系统，涵盖采购计划、供应商管理、合同执行等核心业务数据',
      'supplier': '评估供应商信用状况和合规性，为供应商选择和风险管理提供数据支撑',
      'review-experts': '评审专家管理相关数据资产，包括专家信息、评审记录、专业能力评估等数据',
      'expense': '费用管理相关数据资产，涵盖收支管理、节支率管理、成本控制等财务数据',
      'master-data': '主数据管理相关数据资产，包括物资主数据、基础数据标准化等核心数据',
      'carbon-footprint': '产品碳足迹核算相关数据资产，涵盖碳排放计算模型、环保指标监控等绿色数据',
      'green-supplier': '绿色供应商管理相关数据资产，包括环保认证、绿色采购、可持续发展等数据',
      'smart-review': '智能评审相关数据资产，包括大模型数据集、智能分析算法等AI技术数据',
      'predictive': '预测分析相关数据资产，涵盖需求预测、价格监控、趋势分析等智能数据',
      'performance': '绩效考核相关数据资产，包括效率效能分析、考核与对标管理等监督数据',
      'monitoring': '监控预警相关数据资产，涵盖异常监控、风险合规、预警机制等监管数据'
    };

    // 选择申请类型
    function selectApplyType(type) {
      // 更新单选按钮状态
      document.querySelectorAll('input[name="applyType"]').forEach(radio => {
        radio.checked = radio.value === type;
      });
      
      // 隐藏所有表单
      document.getElementById('internalApplyForm').classList.add('hidden');
      document.getElementById('externalApplyForm').classList.add('hidden');
      document.getElementById('transferApplyForm').classList.add('hidden');
      
      // 显示选中的表单，"选择申请范围"始终显示
      if (type === 'internal') {
        document.getElementById('internalApplyForm').classList.remove('hidden');
      } else if (type === 'external') {
        document.getElementById('externalApplyForm').classList.remove('hidden');
      } else if (type === 'transfer') {
        document.getElementById('transferApplyForm').classList.remove('hidden');
      }
    }

    // 树形目录节点切换
    function toggleNode(nodeId) {
      const node = document.getElementById(nodeId);
      const arrow = document.getElementById(nodeId + '-arrow');
      
      if (node.classList.contains('hidden')) {
        node.classList.remove('hidden');
        arrow.style.transform = 'rotate(90deg)';
      } else {
        node.classList.add('hidden');
        arrow.style.transform = 'rotate(0deg)';
      }
    }

    // 更新申请清单
    function updateApplicationList() {
      const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
      const applicationList = document.getElementById('applicationList');
      
      if (checkboxes.length === 0) {
        applicationList.innerHTML = '<div class="text-gray-500 text-sm">请选择要申请的数据表</div>';
        return;
      }
      
      let listHTML = '<div class="space-y-2">';
      checkboxes.forEach(checkbox => {
        const tableName = checkbox.parentElement.querySelector('span').textContent;
        listHTML += `
          <div class="flex items-center justify-between bg-white p-3 rounded border">
            <div class="flex items-center">
              <i class="fas fa-table text-blue-500 mr-2"></i>
              <span class="text-gray-700">${tableName}</span>
            </div>
            <button onclick="removeFromList('${checkbox.value}')" class="text-red-500 hover:text-red-700">
              <i class="fas fa-times"></i>
            </button>
          </div>
        `;
      });
      listHTML += '</div>';
      
      applicationList.innerHTML = listHTML;
    }

    // 从申请清单中移除项目
    function removeFromList(value) {
      const checkbox = document.querySelector(`input[value="${value}"]`);
      if (checkbox) {
        checkbox.checked = false;
        updateApplicationList();
      }
    }


    // 更新资产信息（保留原函数以兼容）
    function updateAssetInfo() {
      // 这个函数现在不再需要，因为使用了树形目录
    }

    // 更新合同文件名
    function updateContractFileName() {
      const fileInput = document.getElementById('contract-upload');
      const fileNameDiv = document.getElementById('contract-file-name');
      
      if (fileInput.files.length > 0) {
        const fileName = fileInput.files[0].name;
        fileNameDiv.textContent = `已选择文件: ${fileName}`;
        fileNameDiv.classList.remove('hidden');
      } else {
        fileNameDiv.classList.add('hidden');
      }
    }

     // 更新外部合同文件名
     function updateExternalContractFileName() {
       const fileInput = document.getElementById('external-contract-upload');
       const fileNameDiv = document.getElementById('external-contract-file-name');
       
       if (fileInput.files.length > 0) {
         const fileName = fileInput.files[0].name;
         fileNameDiv.textContent = `已选择文件: ${fileName}`;
         fileNameDiv.classList.remove('hidden');
       } else {
         fileNameDiv.classList.add('hidden');
       }
     }

     // 更新权属转移合同文件名
     function updateTransferContractFileName() {
       const fileInput = document.getElementById('transfer-contract-upload');
       const fileNameDiv = document.getElementById('transfer-contract-file-name');
       
       if (fileInput.files.length > 0) {
         const fileName = fileInput.files[0].name;
         fileNameDiv.textContent = `已选择文件: ${fileName}`;
         fileNameDiv.classList.remove('hidden');
       } else {
         fileNameDiv.classList.add('hidden');
       }
     }

     // 更新附件文件名
     function updateAttachmentFileNames() {
       const fileInput = document.getElementById('attachment-upload');
       const fileNameDiv = document.getElementById('attachment-file-names');
       
       if (fileInput.files.length > 0) {
         let fileNames = Array.from(fileInput.files).map(file => file.name).join(', ');
         fileNameDiv.innerHTML = `已选择文件: ${fileNames}`;
         fileNameDiv.classList.remove('hidden');
       } else {
         fileNameDiv.classList.add('hidden');
       }
     }

    // 生成申请编号
    function generateSerialNumber() {
      const now = new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');
      const seconds = String(now.getSeconds()).padStart(2, '0');
      
      return `SQ${year}${month}${day}${hours}${minutes}${seconds}`;
    }

    // 生成外部申请编号
    function generateExternalSerialNumber() {
      const now = new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');
      const seconds = String(now.getSeconds()).padStart(2, '0');
      
      return `WBSQ${year}${month}${day}${hours}${minutes}${seconds}`;
    }

    // 生成权属转移申请编号
    function generateTransferSerialNumber() {
      const now = new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');
      const seconds = String(now.getSeconds()).padStart(2, '0');
      
      return `QZ${year}${month}${day}${hours}${minutes}${seconds}`;
    }

    // 权属类型相关函数已移除，因为现在默认都涉及权属

    // 提交申请
    function submitApplication() {
      const applyType = document.querySelector('input[name="applyType"]:checked')?.value;
      
      if (!applyType) {
        alert('请选择申请类型！');
        return false;
      }
      
      // 获取选中的申请清单
      const selectedTables = Array.from(document.querySelectorAll('input[type="checkbox"]:checked'))
        .map(checkbox => checkbox.parentElement.querySelector('span').textContent);

      if (selectedTables.length === 0) {
        alert('请至少选择一个数据表！');
        return false;
      }
      
      // 验证必填字段
      if (applyType === 'internal') {
        const requiredFields = ['requestingUnit', 'applicationDate', 'handler', 'phone', 'email', 'reason', 'informationSystem', 'requestContent'];
        for (const fieldId of requiredFields) {
          const field = document.getElementById(fieldId);
          if (!field.value.trim()) {
            alert(`请填写${field.previousElementSibling.textContent.replace('*', '').trim()}！`);
            return false;
          }
        }
        
        const requestTypes = Array.from(document.querySelectorAll('input[name="requestType"]:checked'));
        if (requestTypes.length === 0) {
          alert('请选择需求类型！');
          return false;
        }
        
        const usagePeriod = document.querySelector('input[name="usagePeriod"]:checked');
        if (!usagePeriod) {
          alert('请选择使用期限！');
          return false;
        }
        
        const usageScope = document.querySelector('input[name="usageScope"]:checked');
        if (!usageScope) {
          alert('请选择使用范围！');
          return false;
        }
        
        const usageValidity = document.querySelector('input[name="usageValidity"]:checked');
        if (!usageValidity) {
          alert('请选择使用时效！');
          return false;
        }
        
        const dataLevel = document.querySelector('input[name="dataLevel"]:checked');
        if (!dataLevel) {
          alert('请选择数据等级！');
          return false;
        }
        
        const dataClassification = Array.from(document.querySelectorAll('input[name="dataClassification"]:checked'));
        if (dataClassification.length === 0) {
          alert('请选择数据分类！');
          return false;
        }

        const dataType = document.querySelector('input[name="dataType"]:checked');
        if (!dataType) {
          alert('请选择数据类型！');
          return false;
        }

        const ownershipType = Array.from(document.querySelectorAll('input[name="ownershipType"]:checked'));
        if (ownershipType.length === 0) {
          alert('请选择权属类型！');
          return false;
        }
      } else if (applyType === 'external') {
        const requiredFields = ['external-requestingUnit', 'external-applicationDate', 'external-handler', 'external-phone', 'external-email', 'external-reason', 'external-requestContent', 'external-buyer', 'external-bookValue'];
        for (const fieldId of requiredFields) {
          const field = document.getElementById(fieldId);
          if (!field.value.trim()) {
            alert(`请填写${field.previousElementSibling.textContent.replace('*', '').trim()}！`);
            return false;
          }
        }

        const contractFile = document.getElementById('external-contract-upload');
        if (!contractFile.files.length) {
          alert('请上传合同文件！');
          return false;
        }

        const externalOwnershipType = Array.from(document.querySelectorAll('input[name="external-ownershipType"]:checked'));
        if (externalOwnershipType.length === 0) {
          alert('请选择权属类型！');
          return false;
        }
      } else if (applyType === 'transfer') {
        const requiredFields = ['transfer-requestingUnit', 'transfer-applicationDate', 'transfer-handler', 'transfer-phone', 'transfer-email', 'transfer-informationSystem', 'transfer-signature', 'transfer-signatureDate', 'transfer-buyer', 'transfer-contractAmount'];
        for (const fieldId of requiredFields) {
          const field = document.getElementById(fieldId);
          if (!field.value.trim()) {
            alert(`请填写${field.previousElementSibling.textContent.replace('*', '').trim()}！`);
            return false;
          }
        }

        const requestTypes = Array.from(document.querySelectorAll('input[name="transfer-requestType"]:checked'));
        if (requestTypes.length === 0) {
          alert('请选择需求类型！');
          return false;
        }

        const dataLevel = document.querySelector('input[name="transfer-dataLevel"]:checked');
        if (!dataLevel) {
          alert('请选择数据等级！');
          return false;
        }

        const contractFile = document.getElementById('transfer-contract-upload');
        if (!contractFile.files.length) {
          alert('请上传合同文件！');
          return false;
        }
      }
      
      // 模拟提交申请
      console.log('提交申请数据:', {
        applyType,
        selectedTables
      });
      
      // 显示成功消息
      alert('申请提交成功！我们将在1-3个工作日内处理您的申请。');
      
      return true;
    }

    // 提交申请并返回数据资产页面
    function submitApplicationAndReturn() {
      // 先执行提交申请的逻辑
      const success = submitApplication();
      
      // 如果提交成功，则跳转到数据资产页面
      if (success) {
        setTimeout(() => {
          window.location.href = '数据资产.html';
        }, 1000); // 延迟1秒让用户看到成功提示
      }
    }

    // 用户下拉菜单切换
    function toggleUserDropdown() {
      const dropdownMenu = document.getElementById('user-dropdown-menu');
      const arrow = document.getElementById('dropdown-arrow');
      
      if (dropdownMenu.classList.contains('hidden')) {
        dropdownMenu.classList.remove('hidden');
        arrow.style.transform = 'rotate(180deg)';
      } else {
        dropdownMenu.classList.add('hidden');
        arrow.style.transform = 'rotate(0deg)';
      }
    }
    
    // 点击外部关闭下拉菜单
    document.addEventListener('click', function(event) {
      const dropdown = document.getElementById('user-dropdown');
      const dropdownMenu = document.getElementById('user-dropdown-menu');
      const arrow = document.getElementById('dropdown-arrow');
      
      if (!dropdown.contains(event.target)) {
        dropdownMenu.classList.add('hidden');
        arrow.style.transform = 'rotate(0deg)';
      }
    });

    // 页面加载时设置默认申请日期和生成编号
    document.addEventListener('DOMContentLoaded', function() {
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('applicationDate').value = today;
      document.getElementById('external-applicationDate').value = today;
      document.getElementById('transfer-applicationDate').value = today;
      document.getElementById('transfer-signatureDate').value = today;
      
      // 生成申请编号
      document.getElementById('serialNumber').value = generateSerialNumber();
      document.getElementById('external-serialNumber').value = generateExternalSerialNumber();
      document.getElementById('transfer-serialNumber').value = generateTransferSerialNumber();
    });
  </script>
</body>
</html>
