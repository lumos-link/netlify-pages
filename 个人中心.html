<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人中心 - 数据资产管理系统</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        .sidebar-item.active {
            background-color: #3b82f6;
            color: white;
        }
        .sidebar-item:hover {
            background-color: #f3f4f6;
        }
        .notification-item.unread {
            background-color: #f0f9ff;
            border-left: 4px solid #3b82f6;
        }
        .process-step.completed {
            color: #10b981;
        }
        .process-step.current {
            color: #3b82f6;
            font-weight: 600;
        }
        .process-step.pending {
            color: #6b7280;
        }
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        .status-pending { background-color: #fef3c7; color: #d97706; }
        .status-processing { background-color: #dbeafe; color: #2563eb; }
        .status-approved { background-color: #d1fae5; color: #059669; }
        .status-rejected { background-color: #fee2e2; color: #dc2626; }
        .status-completed { background-color: #e0e7ff; color: #7c3aed; }
        .modal-scroll-content {
            max-height: 60vh;
            overflow-y: auto;
            padding-right: 0.5rem;
        }
        .modal-tabs {
            margin-top: 1.25rem;
        }
        .modal-tab-buttons {
            display: flex;
            gap: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
        }
        .modal-tab-button {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem 0.5rem 0 0;
            background-color: #f9fafb;
            color: #6b7280;
            font-size: 0.875rem;
            font-weight: 500;
            border: 1px solid transparent;
            border-bottom: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .modal-tab-button:hover {
            color: #1f2937;
            background-color: #f3f4f6;
        }
        .modal-tab-button.active {
            background-color: #ffffff;
            color: #2563eb;
            border-color: #d1d5db;
            border-bottom: 1px solid #ffffff;
            box-shadow: 0 -2px 8px rgba(37, 99, 235, 0.08);
        }
        .modal-tab-panel {
            display: none;
            padding-top: 1rem;
        }
        .modal-tab-panel.active {
            display: block;
        }
        
        /* 任务操作按钮主题 */
        .task-btn-orange {
            background: linear-gradient(135deg, #f97316, #fb923c);
            color: #fff;
            box-shadow: 0 6px 16px rgba(249, 115, 22, 0.35);
        }
        .task-btn-orange:hover {
            background: linear-gradient(135deg, #ea580c, #f97316);
            color: #fff;
            box-shadow: 0 10px 20px rgba(249, 115, 22, 0.45);
        }
        .task-btn-orange:active {
            background: linear-gradient(135deg, #c2410c, #ea580c);
            color: #fff;
        }
        
        .task-btn-teal {
            background: linear-gradient(135deg, #14b8a6, #2dd4bf);
            color: #fff;
            box-shadow: 0 6px 16px rgba(20, 184, 166, 0.35);
        }
        .task-btn-teal:hover {
            background: linear-gradient(135deg, #0d9488, #14b8a6);
            color: #fff;
            box-shadow: 0 10px 20px rgba(20, 184, 166, 0.45);
        }
        .task-btn-teal:active {
            background: linear-gradient(135deg, #0f766e, #0d9488);
            color: #fff;
        }
        
        .task-btn-gray {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            color: #fff;
            box-shadow: 0 6px 16px rgba(75, 85, 99, 0.35);
        }
        .task-btn-gray:hover {
            background: linear-gradient(135deg, #4b5563, #374151);
            color: #fff;
            box-shadow: 0 10px 20px rgba(55, 65, 81, 0.45);
        }
        .task-btn-gray:active {
            background: linear-gradient(135deg, #374151, #1f2937);
            color: #fff;
        }
        
        .task-btn-cyan {
            background: linear-gradient(135deg, #06b6d4, #22d3ee);
            color: #fff;
            box-shadow: 0 6px 16px rgba(6, 182, 212, 0.35);
        }
        .task-btn-cyan:hover {
            background: linear-gradient(135deg, #0891b2, #06b6d4);
            color: #fff;
            box-shadow: 0 10px 20px rgba(6, 182, 212, 0.45);
        }
        .task-btn-cyan:active {
            background: linear-gradient(135deg, #0e7490, #0891b2);
            color: #fff;
        }
        
        /* 内容卡片样式 */
        .content-card { 
            background: rgba(255, 255, 255, 0.95); 
            backdrop-filter: blur(10px);
            border-radius: 1rem; 
            box-shadow: 0 4px 20px rgba(37, 99, 235, 0.15);
        }
        
        /* 子菜单样式 */
        .submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        .submenu.open {
            max-height: 500px;
        }
        .submenu-arrow {
            transition: transform 0.3s ease;
        }
        .submenu-arrow.rotated {
            transform: rotate(180deg);
        }
        
        /* 隐藏类 */
        .hidden {
            display: none !important;
        }
        
        /* 任务详情弹窗内滚动区域 */
        #taskDetailModal .task-detail-scroll-area {
            max-height: calc(75vh - 168px);
            overflow-y: auto;
            padding-right: 0.5rem;
        }
        @media (max-width: 768px) {
            #taskDetailModal .task-detail-scroll-area {
                max-height: calc(80vh - 156px);
            }
        }
        
        /* 强制显示我的任务页面 */
        #my-tasks-page {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: relative !important;
            z-index: 1 !important;
        }
        
        #my-tasks-page * {
            display: block !important;
            visibility: visible !important;
        }
        
        #my-tasks-page .grid {
            display: grid !important;
        }
        
        #my-tasks-page .flex {
            display: flex !important;
        }
        
        /* 响应式布局优化 */
        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
            }
            .sidebar-left {
                width: 100%;
                margin-bottom: 1rem;
            }
            .content-right {
                width: 100%;
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <!-- 顶部主导航栏 -->
    <header class="bg-gradient-to-r from-red-900 via-red-800 to-red-900 shadow flex items-center justify-between px-10 h-16 sticky top-0 z-20">
        <div class="flex items-center space-x-4">
            <img src="https://img1.imgtp.com/2023/07/21/0Qw6Qk4n.png" alt="LOGO" class="h-10 w-10 rounded-full border-2 border-red-400 shadow bg-white object-contain">
            <span class="text-xl font-bold text-white tracking-wide whitespace-nowrap">数据资产管理系统</span>
        </div>
        <nav class="flex-1 flex items-center justify-center space-x-8">
        </nav>
        <div class="flex items-center space-x-4">
            <a href="首页.html" class="text-red-100 hover:text-red-400 font-medium px-3 py-1 rounded border border-red-400 hover:bg-red-700 transition">
                <i class="fas fa-home mr-2"></i>返回首页
            </a>
            <div class="relative" id="user-dropdown">
                <div class="flex items-center space-x-2 cursor-pointer hover:bg-red-700 px-2 py-1 rounded-lg transition" onclick="toggleUserDropdown()">
                    <img src="https://i.pravatar.cc/32?img=3" class="rounded-full w-8 h-8 border-2 border-red-200" alt="用户头像">
                    <span class="text-red-100 text-sm">张三</span>
                    <i class="fas fa-chevron-down text-xs text-red-300 transition-transform" id="dropdown-arrow"></i>
                </div>
                <div id="user-dropdown-menu" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-200 py-2 hidden z-50">
                    <a href="个人中心.html" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 transition">
                        <i class="fas fa-user-circle mr-3 text-red-500"></i>
                        个人中心
                    </a>
                    <a href="#" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 transition">
                        <i class="fas fa-cog mr-3 text-red-500"></i>
                        系统管理
                    </a>
                    <div class="border-t border-gray-200 my-1"></div>
                    <a href="#" class="flex items-center px-4 py-2 text-red-600 hover:bg-red-50 transition">
                        <i class="fas fa-sign-out-alt mr-3"></i>
                        退出
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- 主体内容区 -->
    <main class="flex-1 w-full max-w-7xl mx-auto flex gap-8 py-8 px-4">
        <!-- 左侧导航栏 -->
        <div class="w-64 bg-white shadow-sm rounded-lg h-fit sticky top-20">
            <div class="p-4">
                <nav class="space-y-2">
                    <!-- 我的任务 -->
                    <div id="nav-process" class="sidebar-item active flex items-center px-3 py-2 text-sm font-medium text-white rounded-lg cursor-pointer" onclick="showPersonalCenter()">
                        <i class="fas fa-tasks mr-3"></i>
                        我的任务
                    </div>

                    <!-- 消息中心 -->
                    <div id="nav-messages" class="sidebar-item flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100 cursor-pointer" onclick="showMessagesCenter()">
                        <i class="fas fa-bell mr-3"></i>
                        消息中心
                    </div>
                </nav>
            </div>
        </div>

        <!-- 主内容区域 -->
        <div class="flex-1">
            <!-- 消息中心页面 -->
            <div id="messages-center-page" class="content-card p-6 hidden">
                <!-- 页面标题 -->
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">消息中心</h2>
                    <p class="text-gray-600 mt-1">查看和管理您的消息通知</p>
                </div>

                <!-- 消息统计 -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="flex items-center">
                            <div class="p-2 bg-blue-100 rounded-lg">
                                <i class="fas fa-bell text-blue-600"></i>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-600">总消息</p>
                                <p class="text-2xl font-bold text-blue-600" id="total-messages">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <div class="flex items-center">
                            <div class="p-2 bg-green-100 rounded-lg">
                                <i class="fas fa-envelope-open text-green-600"></i>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-600">已读</p>
                                <p class="text-2xl font-bold text-green-600" id="read-messages">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <div class="flex items-center">
                            <div class="p-2 bg-yellow-100 rounded-lg">
                                <i class="fas fa-envelope text-yellow-600"></i>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-600">未读</p>
                                <p class="text-2xl font-bold text-yellow-600" id="unread-messages">0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 消息筛选 -->
                <div class="bg-white border border-gray-200 rounded-lg p-4 mb-6">
                    <div class="flex flex-wrap items-center gap-4">
                        <div class="flex items-center space-x-2">
                            <label class="text-sm font-medium text-gray-700">筛选：</label>
                            <select id="message-filter" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="all">全部消息</option>
                                <option value="unread">未读消息</option>
                                <option value="read">已读消息</option>
                            </select>
                        </div>
                        <div class="flex items-center space-x-2">
                            <label class="text-sm font-medium text-gray-700">类型：</label>
                            <select id="message-type-filter" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="all">全部类型</option>
                                <option value="system">知会通知</option>
                                <option value="process">流程通知</option>
                                <option value="approval">审批通知</option>
                            </select>
                        </div>
                        <button onclick="markAllAsRead()" class="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition">
                            <i class="fas fa-check-double mr-2"></i>全部标记为已读
                        </button>
                    </div>
                </div>

                <!-- 消息列表 -->
                <div class="bg-white border border-gray-200 rounded-lg">
                    <div class="p-4 border-b border-gray-200">
                        <h3 class="text-lg font-medium text-gray-900">消息列表</h3>
                    </div>
                    <div id="messages-list" class="divide-y divide-gray-200">
                        <!-- 消息列表内容将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>

            <!-- 个人中心页面（我的任务） -->
            <div id="personal-center-page" class="content-card p-6">
                <!-- 页面标题 -->
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">我的任务</h2>
                    <p class="text-gray-600 mt-1">查看和管理您的任务进度</p>
                </div>

            <!-- 统计卡片 -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <div class="flex items-center">
                        <div class="p-3 bg-blue-100 rounded-lg">
                            <i class="fas fa-tasks text-blue-600 text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-600">进行中流程</p>
                            <p class="text-2xl font-bold text-gray-900" id="processingCount">5</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <div class="flex items-center">
                        <div class="p-3 bg-green-100 rounded-lg">
                            <i class="fas fa-check-circle text-green-600 text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-600">已完成流程</p>
                            <p class="text-2xl font-bold text-gray-900" id="completedCount">8</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <div class="flex items-center">
                        <div class="p-3 bg-yellow-100 rounded-lg">
                            <i class="fas fa-clock text-yellow-600 text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-600">待处理事项</p>
                            <p class="text-2xl font-bold text-gray-900" id="pendingCount">3</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 流程进度内容 -->
            <div class="bg-white rounded-lg shadow-sm">
                <div class="p-6">
                    <!-- 流程筛选 -->
                    <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center space-x-4">
                                <select id="processFilter" class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="all">全部</option>
                                    <option value="permission">数据资产权限申请</option>
                                    <option value="content">资产内容变更</option>
                                    <option value="development-init">数据资产开发(立项)</option>
                                    <option value="attribute">数据属性变更</option>
                                    <option value="catalog">资产目录变更</option>
                                    <option value="development-dev">数据资产开发(开发)</option>
                                    <option value="impairment">减值变更</option>
                                    <option value="decline">跌价变更</option>
                                    <option value="reversal">转回变更</option>
                                    <option value="disclosure">披露变更</option>
                                    <option value="disposal">资产处置</option>
                                    <option value="development-form">数据资产开发(形成)</option>
                                    <option value="tag">资产标签变更</option>
                                    <option value="custom-classification-update">自定义分级分类更新至资产</option>
                                    <option value="scan-resource-update">扫描资源更新至资产</option>
                                </select>
                                <select id="statusFilter" class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="all">全部状态</option>
                                    <option value="pending">待处理</option>
                                    <option value="processing">进行中</option>
                                    <option value="approved">已通过</option>
                                    <option value="rejected">已拒绝</option>
                                    <option value="completed">已完成</option>
                                </select>
                            </div>
                        <div class="text-sm text-gray-500">
                            共 <span id="totalProcesses">18</span> 个流程
                        </div>
                    </div>

                    <!-- 流程列表 -->
                    <div class="space-y-6" id="processList">
                        <!-- 流程列表内容将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>

            <!-- 我的任务页面 -->
            <div id="my-tasks-page" class="content-card p-6 hidden">
                <!-- 任务列表 -->
                <div class="space-y-4" id="taskList">
                    <!-- 1. 数据资产权限申请 -->
                    <div class="bg-white border-l-4 border-blue-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                            <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-key text-blue-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">数据资产权限申请</h3>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                            待处理
                                        </span>
                                    </div>
                                </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">张三</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">数据分析部</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">申请访问客户数据资产</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(1, 'process')" class="px-5 py-2.5 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 active:bg-blue-700 transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(1, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-blue-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 2. 资产内容变更 -->
                            <div class="bg-white border-l-4 border-orange-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-edit text-orange-600 text-xl"></i>
                                    </div>
                                    <div>
                                            <h3 class="text-lg font-bold text-gray-900">资产内容变更</h3>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                        进行中
                                    </span>
                                </div>
                            </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">王五</span>
                                </div>
                            </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">产品部</span>
                                </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">申请更新客户画像数据资产内容</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(2, 'process')" class="px-5 py-2.5 text-sm rounded-lg transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5 task-btn-orange">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(2, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-orange-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                    </button>
                                </div>
                            </div>
                        </div>

                            <!-- 3. 数据资产开发(立项) -->
                            <div class="bg-white border-l-4 border-purple-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                            <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-project-diagram text-purple-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">数据资产开发(立项)</h3>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                            待处理
                                        </span>
                                    </div>
                                </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">李四</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">技术部</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">申请新建数据资产开发项目立项</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(3, 'process')" class="px-5 py-2.5 text-sm bg-purple-500 text-white rounded-lg hover:bg-purple-600 active:bg-purple-700 transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(3, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-purple-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 4. 数据属性变更 -->
                            <div class="bg-white border-l-4 border-cyan-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-cyan-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-tags text-cyan-600 text-xl"></i>
                                    </div>
                                    <div>
                                            <h3 class="text-lg font-bold text-gray-900">数据属性变更</h3>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        已完成
                                    </span>
                                </div>
                            </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">周八</span>
                                </div>
                            </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">数据管理部</span>
                                </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">申请修改数据资产属性信息</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(4, 'process')" class="px-5 py-2.5 text-sm rounded-lg transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5 task-btn-cyan">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(4, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-cyan-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                    </button>
                                </div>
                            </div>
                        </div>

                            <!-- 5. 资产目录变更 -->
                            <div class="bg-white border-l-4 border-yellow-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-sitemap text-yellow-600 text-xl"></i>
            </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">资产目录变更</h3>
                </div>
            </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                            进行中
                                        </span>
            </div>
                </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">冯十</span>
                            </div>
                            </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">运营部</span>
                        </div>
                    </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">申请调整数据资产目录结构</span>
                            </div>
                            </div>
                        </div>
                    </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(5, 'process')" class="px-5 py-2.5 text-sm bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 active:bg-yellow-700 transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(5, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-yellow-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                            </div>
                            </div>
                        </div>

                            <!-- 8. 数据资产开发(开发) -->
                            <div class="bg-white border-l-4 border-indigo-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-code text-indigo-600 text-xl"></i>
                    </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">数据资产开发(开发)</h3>
                            </div>
                            </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                            进行中
                                        </span>
                        </div>
                    </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">陈十一</span>
                </div>
                            </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">开发部</span>
                            </div>
                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">正在进行数据资产开发工作</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(8, 'process')" class="px-5 py-2.5 text-sm bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 active:bg-indigo-700 transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(8, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-indigo-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 9. 减值变更 -->
                            <div class="bg-white border-l-4 border-orange-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-chart-line-down text-orange-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">减值变更</h3>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                            待处理
                                        </span>
                                    </div>
                                </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">褚十二</span>
                                    </div>
                                </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">财务部</span>
                                    </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">申请计提数据资产减值准备</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(9, 'process')" class="px-5 py-2.5 text-sm bg-orange-500 text-white rounded-lg hover:bg-orange-600 active:bg-orange-700 transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(9, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-orange-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 10. 跌价变更 -->
                            <div class="bg-white border-l-4 border-blue-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-arrow-down text-blue-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">跌价变更</h3>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                            待处理
                                        </span>
                                    </div>
                                </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">褚十二</span>
                                    </div>
                                </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">财务部</span>
                                    </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">申请计提数据资产跌价准备</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(10, 'process')" class="px-5 py-2.5 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 active:bg-blue-700 transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(10, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-blue-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 11. 转回变更 -->
                            <div class="bg-white border-l-4 border-emerald-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-arrow-up text-emerald-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">转回变更</h3>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                            待处理
                                        </span>
                                    </div>
                                </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">褚十二</span>
                                    </div>
                                </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">财务部</span>
                                    </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">申请转回数据资产跌价准备</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(11, 'process')" class="px-5 py-2.5 text-sm bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 active:bg-emerald-700 transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(11, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-emerald-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 12. 披露变更 -->
                            <div class="bg-white border-l-4 border-purple-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-file-alt text-purple-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">披露变更</h3>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                            待处理
                                        </span>
                                    </div>
                                </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">褚十二</span>
                                    </div>
                                </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">财务部</span>
                                    </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">申请披露数据资产核算调整信息</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(12, 'process')" class="px-5 py-2.5 text-sm bg-purple-500 text-white rounded-lg hover:bg-purple-600 active:bg-purple-700 transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(12, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-purple-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 13. 资产处置 -->
                            <div class="bg-white border-l-4 border-gray-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-trash-alt text-gray-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">资产处置</h3>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                            待处理
                                        </span>
                                    </div>
                                </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">蒋十三</span>
                                    </div>
                                </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">资产管理部</span>
                                    </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">申请处置过期数据资产</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(13, 'process')" class="px-5 py-2.5 text-sm rounded-lg transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5 task-btn-gray">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(13, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-gray-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 11. 数据资产开发(形成) -->
                            <div class="bg-white border-l-4 border-blue-600 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-blue-200 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-check-double text-blue-700 text-xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">数据资产开发(形成)</h3>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                            已完成
                                        </span>
                                    </div>
                                </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">韩十四</span>
                                    </div>
                                </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">项目组</span>
                                    </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">申请数据资产开发项目验收</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(14, 'process')" class="px-5 py-2.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 active:bg-blue-800 transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(14, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-blue-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 12. 资产标签变更 -->
                            <div class="bg-white border-l-4 border-teal-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-teal-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-tag text-teal-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">资产标签变更</h3>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                            进行中
                                        </span>
                                    </div>
                                </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">朱十五</span>
                                    </div>
                                </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">标签管理部</span>
                                    </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">申请更新数据资产标签信息</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(15, 'process')" class="px-5 py-2.5 text-sm rounded-lg transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5 task-btn-teal">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(15, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-teal-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                                </div>
                            </div>
                        </div>

                            <!-- 16. 自定义分级分类更新至资产 -->
                            <div class="bg-white border-l-4 border-indigo-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-exchange-alt text-indigo-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">自定义分级分类更新至资产</h3>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                            待处理
                                        </span>
                                    </div>
                                </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">系统自动</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">数据管理部</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">资源字段变更需要同步更新资产信息</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(16, 'process')" class="px-5 py-2.5 text-sm bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 active:bg-indigo-700 transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(16, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-indigo-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 17. 扫描资源更新至资产 -->
                            <div class="bg-white border-l-4 border-purple-500 rounded-lg p-5 hover:shadow-lg transition-all duration-200">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center shadow-sm">
                                            <i class="fas fa-sync-alt text-purple-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">扫描资源更新至资产</h3>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                            待处理
                                        </span>
                                    </div>
                                </div>
                                <div class="mb-4 pl-16">
                                    <div class="grid grid-cols-3 gap-4 mb-3">
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-user text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">申请人</span>
                                                <span class="text-sm font-medium text-gray-900">系统自动</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-building text-gray-400 text-sm"></i>
                                            <div>
                                                <span class="text-xs text-gray-500 block">部门</span>
                                                <span class="text-sm font-medium text-gray-900">数据管理部</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2.5">
                                            <i class="fas fa-file-alt text-gray-400 text-sm"></i>
                                            <div class="min-w-0 flex-1">
                                                <span class="text-xs text-gray-500 block">申请内容</span>
                                                <span class="text-sm font-medium text-gray-900 truncate">扫描报告触发资源更新至资产</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-end pl-16">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="showTaskDetail(17, 'process')" class="px-5 py-2.5 text-sm bg-purple-500 text-white rounded-lg hover:bg-purple-600 active:bg-purple-700 transition-all font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                                            <i class="fas fa-check-circle mr-1.5"></i>处理任务
                                        </button>
                                        <button onclick="showTaskDetail(17, 'view')" class="px-4 py-2.5 text-sm text-gray-600 hover:text-purple-600 transition-colors font-medium border-0 bg-transparent hover:underline">
                                            <i class="fas fa-eye mr-1.5"></i>查看详情
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 消息详情弹窗 -->
    <div id="messageDetailModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between p-6 border-b border-gray-200">
                <h3 class="text-xl font-bold text-gray-800">消息详情</h3>
                <button onclick="hideMessageDetail()" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-6">
                <div id="messageDetailContent">
                    <!-- 消息详情内容 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 流程详情弹窗 -->
    <div id="processDetailModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between p-6 border-b border-gray-200">
                <h3 class="text-xl font-bold text-gray-800">流程详情</h3>
                <button onclick="hideProcessDetail()" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-6">
                <div id="processDetailContent">
                    <!-- 流程详情内容 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 任务详情弹窗 -->
    <div id="taskDetailModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-4xl mx-4 max-h-[75vh] overflow-hidden flex flex-col">
            <!-- 弹窗头部 -->
            <div class="flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0">
                <div class="flex items-center space-x-3">
                    <div id="taskDetailIcon" class="w-10 h-10 rounded-full flex items-center justify-center">
                        <i class="fas text-lg"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800" id="taskDetailTitle">任务详情</h3>
                        <div class="flex items-center space-x-2 mt-1">
                            <span id="taskDetailStatus" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"></span>
                        </div>
                    </div>
                </div>
                <button onclick="hideTaskDetail()" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <!-- 弹窗内容区域（可滚动） -->
            <div class="flex-1 p-6 flex flex-col min-h-0">
                <div class="flex-1 min-h-0 space-y-6 task-detail-scroll-area" id="taskDetailScrollArea">
                    <!-- 任务基本信息 -->
                    <div>
                        <h4 class="text-sm font-semibold text-gray-700 mb-4 flex items-center">
                            <i class="fas fa-info-circle mr-2 text-blue-500"></i>基本信息
                        </h4>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="text-xs font-medium text-gray-500 block mb-1">任务类型</label>
                                    <p class="text-sm text-gray-900" id="taskDetailType">-</p>
                                </div>
                                <div>
                                    <label class="text-xs font-medium text-gray-500 block mb-1">申请人</label>
                                    <p class="text-sm text-gray-900" id="taskDetailApplicant">-</p>
                                </div>
                                <div>
                                    <label class="text-xs font-medium text-gray-500 block mb-1">所属部门</label>
                                    <p class="text-sm text-gray-900" id="taskDetailDepartment">-</p>
                                </div>
                                <div>
                                    <label class="text-xs font-medium text-gray-500 block mb-1">创建时间</label>
                                    <p class="text-sm text-gray-900" id="taskDetailCreateTime">-</p>
                                </div>
                                <div id="taskDetailCompleteTimeContainer" class="hidden">
                                    <label class="text-xs font-medium text-gray-500 block mb-1">完成时间</label>
                                    <p class="text-sm text-gray-900" id="taskDetailCompleteTime">-</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 操作历史/审批记录 -->
                    <div class="hidden">
                        <h4 class="text-sm font-semibold text-gray-700 mb-4 flex items-center">
                            <i class="fas fa-history mr-2 text-blue-500"></i>操作历史
                        </h4>
                        <div class="bg-white border border-gray-200 rounded-lg">
                            <div id="taskDetailHistory" class="divide-y divide-gray-200">
                                <!-- 操作历史将通过JavaScript动态生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- 任务专用内容 -->
                    <div id="taskDetailCustomContent" class="space-y-6 hidden"></div>

                    <!-- 流程进度（仅审批/审核类任务显示） -->
                    <div id="taskDetailProcessContainer" class="hidden">
                        <h4 class="text-sm font-semibold text-gray-700 mb-4 flex items-center">
                            <i class="fas fa-project-diagram mr-2 text-blue-500"></i>流程进度
                        </h4>
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div id="taskDetailProcessSteps" class="space-y-3">
                                <!-- 流程步骤将通过JavaScript动态生成 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 弹窗底部操作栏 -->
            <div class="border-t border-gray-200 p-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4 flex-shrink-0 bg-gray-50">
                <div class="w-full md:max-w-xl">
                    <label for="taskDetailOpinion" class="block text-sm font-medium text-gray-700 mb-2">审批意见</label>
                    <textarea id="taskDetailOpinion" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none" rows="3" placeholder="在此填写审批意见..."></textarea>
                </div>
                <div class="flex items-center justify-end space-x-3 flex-shrink-0" id="taskDetailActions">
                    <!-- 操作按钮将通过JavaScript动态生成 -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // 用户下拉菜单切换
        function toggleUserDropdown() {
            const dropdown = document.getElementById('user-dropdown-menu');
            const arrow = document.getElementById('dropdown-arrow');
            
            if (dropdown.classList.contains('hidden')) {
                dropdown.classList.remove('hidden');
                arrow.style.transform = 'rotate(180deg)';
            } else {
                dropdown.classList.add('hidden');
                arrow.style.transform = 'rotate(0deg)';
            }
        }

        // 点击外部关闭下拉菜单
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('user-dropdown');
            const dropdownMenu = document.getElementById('user-dropdown-menu');
            
            if (!dropdown.contains(event.target)) {
                dropdownMenu.classList.add('hidden');
                document.getElementById('dropdown-arrow').style.transform = 'rotate(0deg)';
            }
        });

        // 子菜单切换功能
        function toggleSubmenu(menuId) {
            const submenu = document.getElementById(menuId + '-submenu');
            const arrow = document.getElementById(menuId + '-arrow');
            
            if (submenu.classList.contains('open')) {
                submenu.classList.remove('open');
                arrow.classList.remove('rotated');
            } else {
                // 关闭其他子菜单
                const allSubmenus = document.querySelectorAll('.submenu');
                const allArrows = document.querySelectorAll('.submenu-arrow');
                
                allSubmenus.forEach(menu => {
                    if (menu.id !== menuId + '-submenu') {
                        menu.classList.remove('open');
                    }
                });
                
                allArrows.forEach(arrow => {
                    if (arrow.id !== menuId + '-arrow') {
                        arrow.classList.remove('rotated');
                    }
                });
                
                // 切换当前子菜单
                submenu.classList.toggle('open');
                arrow.classList.toggle('rotated');
            }
        }

        // 页面加载时默认展开个人中心子菜单
        document.addEventListener('DOMContentLoaded', function() {
            const personalSubmenu = document.getElementById('personal-submenu');
            const personalArrow = document.getElementById('personal-arrow');
            
            if (personalSubmenu && personalArrow) {
                personalSubmenu.classList.add('open');
                personalArrow.classList.add('rotated');
            }
            
            // 初始化消息中心
            initializeMessagesCenter();
        });

        // 显示消息中心页面
        function showMessagesCenter() {
            // 隐藏个人中心页面
            document.getElementById('personal-center-page').classList.add('hidden');
            // 隐藏我的任务页面（如果存在）
            const myTasksPage = document.getElementById('my-tasks-page');
            if (myTasksPage) {
                myTasksPage.classList.add('hidden');
            }
            // 显示消息中心页面
            document.getElementById('messages-center-page').classList.remove('hidden');
            
            // 更新导航状态
            updateNavigationState('messages');
            
            // 加载消息数据
            loadMessagesData();
        }

        // 显示个人中心页面（我的任务）
        function showPersonalCenter() {
            // 隐藏消息中心页面
            document.getElementById('messages-center-page').classList.add('hidden');
            // 隐藏我的任务页面（如果存在）
            const myTasksPage = document.getElementById('my-tasks-page');
            if (myTasksPage) {
                myTasksPage.classList.add('hidden');
            }
            // 显示个人中心页面
            document.getElementById('personal-center-page').classList.remove('hidden');
            
            // 更新导航状态
            updateNavigationState('personal');
        }

        // 显示我的任务页面
        function showMyTasks() {
            console.log('showMyTasks called');
            
            // 隐藏消息中心页面
            const messagesPage = document.getElementById('messages-center-page');
            if (messagesPage) {
                messagesPage.classList.add('hidden');
                console.log('Messages page hidden');
            }
            
            // 隐藏个人中心页面
            const personalPage = document.getElementById('personal-center-page');
            if (personalPage) {
                personalPage.classList.add('hidden');
                console.log('Personal center page hidden');
            }
            
            // 显示我的任务页面
            const tasksPage = document.getElementById('my-tasks-page');
            if (tasksPage) {
                tasksPage.classList.remove('hidden');
                tasksPage.style.display = 'block';
                tasksPage.style.visibility = 'visible';
                tasksPage.style.opacity = '1';
                tasksPage.style.position = 'relative';
                tasksPage.style.zIndex = '1';
                console.log('Tasks page shown');
                console.log('Tasks page element:', tasksPage);
                console.log('Tasks page content:', tasksPage.innerHTML.substring(0, 200));
            } else {
                console.error('Tasks page element not found!');
            }
            
            // 更新导航状态
            updateNavigationState('personal');
        }

        // 更新导航状态
        function updateNavigationState(activePage) {
            // 重置所有导航项状态
            const allNavItems = document.querySelectorAll('.sidebar-item');
            allNavItems.forEach(item => {
                item.classList.remove('active', 'text-white');
                item.classList.add('text-gray-700');
            });
            
            // 设置当前激活的导航项
            if (activePage === 'messages') {
                const messagesNav = document.getElementById('nav-messages');
                if (messagesNav) {
                    messagesNav.classList.add('active');
                    messagesNav.classList.remove('text-gray-700');
                    messagesNav.classList.add('text-white');
                }
            } else if (activePage === 'personal') {
                const processNav = document.getElementById('nav-process');
                if (processNav) {
                    processNav.classList.add('active');
                    processNav.classList.remove('text-gray-700');
                    processNav.classList.add('text-white');
                }
            }
        }

        // 初始化消息中心
        function initializeMessagesCenter() {
            // 添加筛选器事件监听
            document.getElementById('message-filter').addEventListener('change', filterMessages);
            document.getElementById('message-type-filter').addEventListener('change', filterMessages);
        }

        // 加载消息数据
        function loadMessagesData() {
            // 更新统计信息
            updateMessageStatistics();
            // 渲染消息列表
            renderMessagesList();
        }

        // 更新消息统计
        function updateMessageStatistics() {
            const totalMessages = messageData.length;
            const readMessages = messageData.filter(msg => msg.read).length;
            const unreadMessages = totalMessages - readMessages;
            
            document.getElementById('total-messages').textContent = totalMessages;
            document.getElementById('read-messages').textContent = readMessages;
            document.getElementById('unread-messages').textContent = unreadMessages;
        }

        // 渲染消息列表
        function renderMessagesList() {
            const messagesList = document.getElementById('messages-list');
            const filter = document.getElementById('message-filter').value;
            const typeFilter = document.getElementById('message-type-filter').value;
            
            let filteredMessages = messageData;
            
            // 应用筛选
            if (filter === 'unread') {
                filteredMessages = filteredMessages.filter(msg => !msg.read);
            } else if (filter === 'read') {
                filteredMessages = filteredMessages.filter(msg => msg.read);
            }
            
            if (typeFilter !== 'all') {
                filteredMessages = filteredMessages.filter(msg => msg.type === typeFilter);
            }
            
            // 清空列表
            messagesList.innerHTML = '';
            
            if (filteredMessages.length === 0) {
                messagesList.innerHTML = `
                    <div class="p-8 text-center text-gray-500">
                        <i class="fas fa-inbox text-4xl mb-4"></i>
                        <p>暂无消息</p>
                    </div>
                `;
                return;
            }
            
            // 渲染消息项
            filteredMessages.forEach(message => {
                const messageItem = createMessageItem(message);
                messagesList.appendChild(messageItem);
            });
        }

        // 创建消息项
        function createMessageItem(message) {
            const messageItem = document.createElement('div');
            messageItem.className = `p-4 hover:bg-gray-50 cursor-pointer ${!message.read ? 'bg-blue-50 border-l-4 border-blue-500' : ''}`;
            messageItem.onclick = () => showMessageDetail(message.id);
            
            const timeAgo = getTimeAgo(message.timestamp);
            const typeClass = getMessageTypeClass(message.type);
            const typeText = getMessageTypeText(message.type);
            
            messageItem.innerHTML = `
                <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0">
                        <div class="w-8 h-8 rounded-full ${typeClass} flex items-center justify-center">
                            <i class="fas ${getMessageIcon(message.type)} text-xs"></i>
                        </div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center justify-between">
                            <p class="text-sm font-medium text-gray-900 truncate">${message.title}</p>
                            <div class="flex items-center space-x-2">
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${typeClass}">
                                    ${typeText}
                                </span>
                                <span class="text-xs text-gray-500">${timeAgo}</span>
                            </div>
                        </div>
                        <p class="text-sm text-gray-600 mt-1">${message.content}</p>
                        ${!message.read ? '<div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>' : ''}
                    </div>
                </div>
            `;
            
            return messageItem;
        }

        // 获取消息图标
        function getMessageIcon(type) {
            const icons = {
                'system': 'fa-cog',
                'process': 'fa-tasks',
                'approval': 'fa-check-circle'
            };
            return icons[type] || 'fa-bell';
        }

        // 获取时间差
        function getTimeAgo(timestamp) {
            const now = new Date();
            const messageTime = new Date(timestamp);
            const diffInMinutes = Math.floor((now - messageTime) / (1000 * 60));
            
            if (diffInMinutes < 1) return '刚刚';
            if (diffInMinutes < 60) return `${diffInMinutes}分钟前`;
            if (diffInMinutes < 1440) return `${Math.floor(diffInMinutes / 60)}小时前`;
            return `${Math.floor(diffInMinutes / 1440)}天前`;
        }

        // 筛选消息
        function filterMessages() {
            renderMessagesList();
        }

        // 全部标记为已读
        function markAllAsRead() {
            messageData.forEach(message => {
                message.read = true;
            });
            saveDataToStorage();
            updateMessageStatistics();
            renderMessagesList();
        }

        // 消息数据
        const messageData = [
            {
                id: 1,
                type: 'system',
                title: '系统维护通知',
                content: '系统将于今晚22:00-24:00进行维护升级，期间可能影响部分功能使用，请提前保存工作内容。',
                timestamp: '2024-01-15 14:30',
                read: false,
                important: true
            },
            {
                id: 2,
                type: 'process',
                title: '数据资产权限申请已提交',
                content: '您申请的"采购数据专题分析模型"使用权限已提交，正在等待审批，预计1-3个工作日处理。',
                timestamp: '2024-01-15 10:15',
                read: false,
                important: false
            },
            {
                id: 3,
                type: 'approval',
                title: '待审批：数据来源新建申请',
                content: '李四提交了"客户行为数据"来源新建申请，需要您的审批。',
                timestamp: '2024-01-15 09:45',
                read: false,
                important: true
            },
            {
                id: 4,
                type: 'process',
                title: '资产内容变更已完成',
                content: '您申请的"销售数据分析模型"内容变更已通过审批并完成更新。',
                timestamp: '2024-01-14 16:20',
                read: true,
                important: false
            },
            {
                id: 5,
                type: 'system',
                title: '新功能上线通知',
                content: '数据资产管理系统新增了个人中心功能，您可以在这里查看消息通知和流程进度。',
                timestamp: '2024-01-14 11:30',
                read: true,
                important: false
            },
            {
                id: 6,
                type: 'process',
                title: '资源变更申请进度更新',
                content: '您申请的数据存储资源配置调整已进入技术实施阶段。',
                timestamp: '2024-01-13 18:20',
                read: true,
                important: false
            },
            {
                id: 7,
                type: 'approval',
                title: '待审批：权限申请',
                content: '王五提交了"客户画像数据资产"访问权限申请，需要您的审批。',
                timestamp: '2024-01-13 15:30',
                read: false,
                important: false
            },
            {
                id: 8,
                type: 'system',
                title: '数据安全培训通知',
                content: '本周五下午2点将进行数据安全培训，请准时参加。',
                timestamp: '2024-01-12 09:00',
                read: true,
                important: false
            }
        ];

        // 任务数据
        const taskData = [
            {
                id: 1,
                type: 'approval',
                title: '数据资产权限申请',
                description: '申请人：张三（数据分析部）申请访问客户数据资产，用于业务分析和客户画像构建。申请的数据资产包括：客户基本信息表、客户交易记录表、客户行为分析表。',
                status: 'pending',
                applicant: '张三',
                department: '数据分析部',
                createTime: '2024-01-15 09:30',
                deadline: '2024-01-20 18:00',
                assignee: '李经理',
                completeTime: null,
                processSteps: [
                    { name: '提交申请', status: 'completed', time: '2024-01-15 09:30', operator: '张三' },
                    { name: '部门审批', status: 'current', time: null, operator: '李经理' },
                    { name: '安全审查', status: 'pending', time: null, operator: '安全部' },
                    { name: '最终审批', status: 'pending', time: null, operator: '部门总监' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-15 09:30', comment: '任务已创建并分配给李经理' },
                    { action: '申请提交', operator: '张三', time: '2024-01-15 09:30', comment: '已提交数据资产权限申请' }
                ],
                attachments: []
            },
            {
                id: 2,
                type: 'processing',
                title: '资产内容变更',
                description: '申请人：王五（产品部）申请更新客户画像数据资产，增加新的分析维度。变更内容包括：新增用户活跃度分析维度、优化用户分群算法、更新数据更新频率。',
                status: 'processing',
                applicant: '王五',
                department: '产品部',
                createTime: '2024-01-16 11:45',
                deadline: '2024-01-25 18:00',
                assignee: '赵经理',
                completeTime: null,
                processSteps: [
                    { name: '提交变更', status: 'completed', time: '2024-01-16 11:45', operator: '王五' },
                    { name: '内容审核', status: 'current', time: '2024-01-17 14:20', operator: '赵经理' },
                    { name: '发布更新', status: 'pending', time: null, operator: '技术部' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-16 11:45', comment: '任务已创建并分配给赵经理' },
                    { action: '变更提交', operator: '王五', time: '2024-01-16 11:45', comment: '已提交资产内容变更申请' },
                    { action: '开始审核', operator: '赵经理', time: '2024-01-17 14:20', comment: '正在审核变更内容' }
                ],
                attachments: [
                    { name: '变更需求文档.docx', size: '856KB', url: '#' }
                ]
            },
            {
                id: 3,
                type: 'review',
                title: '数据资产开发(立项)',
                description: '申请人：李四（技术部）申请新建数据资产开发项目立项。项目旨在开发新的数据资产，提升数据价值和应用能力。',
                status: 'pending',
                applicant: '李四',
                department: '技术部',
                createTime: '2024-01-16 10:00',
                deadline: '2024-01-26 18:00',
                assignee: '技术主管',
                completeTime: null,
                processSteps: [
                    { name: '提交申请', status: 'completed', time: '2024-01-16 10:00', operator: '李四' },
                    { name: '立项审核', status: 'current', time: null, operator: '技术主管' },
                    { name: '项目启动', status: 'pending', time: null, operator: '项目组' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-16 10:00', comment: '任务已创建并分配给技术主管' },
                    { action: '申请提交', operator: '李四', time: '2024-01-16 10:00', comment: '已提交数据资产开发项目立项申请' }
                ],
                attachments: [
                    { name: '项目立项申请书.pdf', size: '3.5MB', url: '#' },
                    { name: '技术方案.docx', size: '2.8MB', url: '#' }
                ]
            },
            {
                id: 4,
                type: 'processing',
                title: '数据属性变更',
                description: '申请人：周八（数据管理部）申请修改数据资产属性信息。需要更新资产的基本属性、元数据信息，确保资产信息的准确性和完整性。',
                status: 'completed',
                applicant: '周八',
                department: '数据管理部',
                createTime: '2024-01-13 09:00',
                deadline: '2024-01-20 18:00',
                assignee: '数据主管',
                completeTime: '2024-01-19 15:30',
                processSteps: [
                    { name: '提交申请', status: 'completed', time: '2024-01-13 09:00', operator: '周八' },
                    { name: '属性审核', status: 'completed', time: '2024-01-15 14:00', operator: '数据主管' },
                    { name: '属性更新', status: 'completed', time: '2024-01-19 15:30', operator: '技术部' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-13 09:00', comment: '任务已创建并分配给数据主管' },
                    { action: '申请提交', operator: '周八', time: '2024-01-13 09:00', comment: '已提交数据属性变更申请' },
                    { action: '审核通过', operator: '数据主管', time: '2024-01-15 14:00', comment: '属性变更审核通过' },
                    { action: '更新完成', operator: '技术部', time: '2024-01-19 15:30', comment: '数据属性已成功更新' }
                ],
                customData: {
                    type: 'attribute-change',
                    attribute: {
                        name: '客户画像准确率',
                        description: '衡量近30天画像模型对目标客户群识别准确程度的指标，用于驱动精准营销与客户洞察分析。',
                        enabled: true,
                        parent: '客户画像指标体系'
                    }
                },
                attachments: [
                    { name: '属性变更清单.xlsx', size: '1.2MB', url: '#' }
                ]
            },
            {
                id: 5,
                type: 'processing',
                title: '资产目录变更',
                description: '申请人：冯十（运营部）申请调整数据资产目录结构。需要重新组织资产目录层级，优化资产查找和管理的效率。',
                status: 'processing',
                applicant: '冯十',
                department: '运营部',
                createTime: '2024-01-19 14:20',
                deadline: '2024-01-30 18:00',
                assignee: '运营主管',
                completeTime: null,
                processSteps: [
                    { name: '提交申请', status: 'completed', time: '2024-01-19 14:20', operator: '冯十' },
                    { name: '目录设计', status: 'current', time: '2024-01-20 09:00', operator: '运营主管' },
                    { name: '实施更新', status: 'pending', time: null, operator: '技术部' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-19 14:20', comment: '任务已创建并分配给运营主管' },
                    { action: '申请提交', operator: '冯十', time: '2024-01-19 14:20', comment: '已提交资产目录变更申请' },
                    { action: '开始设计', operator: '运营主管', time: '2024-01-20 09:00', comment: '正在设计新的目录结构' }
                ],
                customData: {
                    type: 'catalog-change',
                    catalog: {
                        name: '客户运营模型目录',
                        parent: '内容管理',
                        path: '/数据资产/内容管理/客户运营模型',
                        status: '启用',
                        owner: '赵经理',
                        tags: ['运营数据', '客户服务'],
                        description: '集中管理与客户运营相关的数据模型、指标体系与明细资源，支持客户旅程洞察与服务优化。',
                        attachment: '目录结构方案.xlsx'
                    },
                    changeSummary: '新增实时画像分支，整合客户视图与权益目录，并按客服/运营场景细化访问权限。'
                },
                attachments: [
                    { name: '目录结构方案.xlsx', size: '1.8MB', url: '#' }
                ]
            },
            {
                id: 6,
                type: 'processing',
                title: '数据资产开发(开发)',
                description: '申请人：陈十一（开发部）正在进行数据资产开发工作。项目包括：数据清洗、数据建模、数据质量提升等开发任务。',
                status: 'processing',
                applicant: '陈十一',
                department: '开发部',
                createTime: '2024-01-15 08:00',
                deadline: '2024-02-15 18:00',
                assignee: '开发主管',
                completeTime: null,
                processSteps: [
                    { name: '需求分析', status: 'completed', time: '2024-01-15 08:00', operator: '陈十一' },
                    { name: '开发实施', status: 'current', time: '2024-01-20 09:00', operator: '开发主管' },
                    { name: '测试验收', status: 'pending', time: null, operator: '测试部' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-15 08:00', comment: '任务已创建并分配给开发主管' },
                    { action: '开始开发', operator: '陈十一', time: '2024-01-15 08:00', comment: '已开始数据资产开发工作' },
                    { action: '开发进行中', operator: '开发主管', time: '2024-01-20 09:00', comment: '开发工作正在进行中，预计2周完成' }
                ],
                attachments: [
                    { name: '开发需求文档.docx', size: '2.5MB', url: '#' },
                    { name: '技术方案.pdf', size: '3.1MB', url: '#' }
                ]
            },
            {
                id: 9,
                type: 'processing',
                title: '减值变更',
                description: '申请人：褚十二（财务部）申请计提数据资产减值准备。需要更新资产价值计算方法，优化会计核算流程。',
                status: 'pending',
                applicant: '褚十二',
                department: '财务部',
                createTime: '2024-01-21 11:00',
                deadline: '2024-02-01 18:00',
                assignee: '财务主管',
                completeTime: null,
                processSteps: [
                    { name: '提交申请', status: 'completed', time: '2024-01-21 11:00', operator: '褚十二' },
                    { name: '财务审核', status: 'current', time: null, operator: '财务主管' },
                    { name: '系统更新', status: 'pending', time: null, operator: '技术部' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-21 11:00', comment: '任务已创建并分配给财务主管' },
                    { action: '申请提交', operator: '褚十二', time: '2024-01-21 11:00', comment: '已提交减值变更申请' }
                ],
                customData: {
                    type: 'impairment-change',
                    asset: {
                        code: 'ZC002',
                        name: '供应商信用评价与合规性分析数据集',
                        category: '存货',
                        status: '正常',
                        bookValue: '¥560,000',
                        location: '财务共享平台',
                        disclosureStatus: '未披露'
                    },
                    impairment: {
                        originalValue: '¥800,000',
                        accumulatedAmortization: '¥240,000',
                        recoverableAmount: '¥680,000',
                        proposedImpairment: '¥120,000',
                        evaluationDate: '2024-01-18',
                        attachments: [
                            { name: '资产减值评估报告.pdf', size: '940KB' },
                            { name: '现金流预测模型.xlsx', size: '520KB' }
                        ],
                        reason: '市场需求下降导致预计现金流减少，需要计提减值准备。',
                        description: '依据近期供应链业务报告，数据资产预计产生的经济利益下降，需要计提减值，并同步调整折旧计划。'
                    }
                },
                attachments: [
                    { name: '资产减值评估报告.pdf', size: '940KB', url: '#' },
                    { name: '现金流预测模型.xlsx', size: '520KB', url: '#' }
                ]
            },
            {
                id: 10,
                type: 'processing',
                title: '跌价变更',
                description: '申请人：褚十二（财务部）申请计提数据资产跌价准备。需要更新资产价值计算方法，优化会计核算流程。',
                status: 'pending',
                applicant: '褚十二',
                department: '财务部',
                createTime: '2024-01-21 11:00',
                deadline: '2024-02-01 18:00',
                assignee: '财务主管',
                completeTime: null,
                processSteps: [
                    { name: '提交申请', status: 'completed', time: '2024-01-21 11:00', operator: '褚十二' },
                    { name: '财务审核', status: 'current', time: null, operator: '财务主管' },
                    { name: '系统更新', status: 'pending', time: null, operator: '技术部' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-21 11:00', comment: '任务已创建并分配给财务主管' },
                    { action: '申请提交', operator: '褚十二', time: '2024-01-21 11:00', comment: '已提交跌价变更申请' }
                ],
                customData: {
                    type: 'decline-change',
                    asset: {
                        code: 'ZC002',
                        name: '供应商信用评价与合规性分析数据集',
                        category: '存货',
                        status: '正常',
                        bookValue: '¥560,000',
                        location: '财务共享平台',
                        disclosureStatus: '未披露'
                    },
                    priceDecline: {
                        bookBalance: '¥560,000',
                        existingProvision: '¥80,000',
                        proposedProvision: '¥60,000',
                        description: '库存类数据资产近两期利用率大幅下降，市场价值较账面价值低100,000元，拟计提跌价准备 60,000 元。',
                        attachmentTips: '请上传审批文件、外部评估报告等，支持多附件。',
                        attachments: [
                            { name: '库存价值评估报告.pdf', size: '860KB' },
                            { name: '市场价格监测明细.xlsx', size: '430KB' }
                        ]
                    }
                },
                attachments: [
                    { name: '库存价值评估报告.pdf', size: '860KB', url: '#' },
                    { name: '市场价格监测明细.xlsx', size: '430KB', url: '#' }
                ]
            },
            {
                id: 11,
                type: 'processing',
                title: '转回变更',
                description: '申请人：褚十二（财务部）申请转回数据资产跌价准备。需要更新资产价值计算方法，优化会计核算流程。',
                status: 'pending',
                applicant: '褚十二',
                department: '财务部',
                createTime: '2024-01-21 11:00',
                deadline: '2024-02-01 18:00',
                assignee: '财务主管',
                completeTime: null,
                processSteps: [
                    { name: '提交申请', status: 'completed', time: '2024-01-21 11:00', operator: '褚十二' },
                    { name: '财务审核', status: 'current', time: null, operator: '财务主管' },
                    { name: '系统更新', status: 'pending', time: null, operator: '技术部' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-21 11:00', comment: '任务已创建并分配给财务主管' },
                    { action: '申请提交', operator: '褚十二', time: '2024-01-21 11:00', comment: '已提交转回变更申请' }
                ],
                customData: {
                    type: 'reversal-change',
                    asset: {
                        code: 'ZC002',
                        name: '供应商信用评价与合规性分析数据集',
                        category: '存货',
                        status: '正常',
                        bookValue: '¥560,000',
                        location: '财务共享平台',
                        disclosureStatus: '未披露'
                    },
                    priceReversal: {
                        history: [
                            { date: '2023-09-12', amount: '¥45,000', reversed: '¥15,000', reversible: '¥30,000', remark: '阶段性市场调整，保留余量' },
                            { date: '2023-11-30', amount: '¥35,000', reversed: '¥0', reversible: '¥35,000', remark: '新数据节点上线，准备转回' }
                        ],
                        plan: {
                            selectedAmount: '¥30,000',
                            reason: '近期上线的供应链监控模块提升资产利用率，预计市场价值恢复。',
                            attachmentsHint: '需提供业务复盘记录及市场回升证明材料。',
                            attachments: [
                                { name: '业务复盘记录.docx', size: '410KB' },
                                { name: '市场回升证明材料.pdf', size: '720KB' }
                            ]
                        }
                    }
                },
                attachments: [
                    { name: '业务复盘记录.docx', size: '410KB', url: '#' },
                    { name: '市场回升证明材料.pdf', size: '720KB', url: '#' }
                ]
            },
            {
                id: 12,
                type: 'processing',
                title: '披露变更',
                description: '申请人：褚十二（财务部）申请披露数据资产核算调整信息。需要更新资产价值计算方法，优化会计核算流程。',
                status: 'pending',
                applicant: '褚十二',
                department: '财务部',
                createTime: '2024-01-21 11:00',
                deadline: '2024-02-01 18:00',
                assignee: '财务主管',
                completeTime: null,
                processSteps: [
                    { name: '提交申请', status: 'completed', time: '2024-01-21 11:00', operator: '褚十二' },
                    { name: '财务审核', status: 'current', time: null, operator: '财务主管' },
                    { name: '系统更新', status: 'pending', time: null, operator: '技术部' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-21 11:00', comment: '任务已创建并分配给财务主管' },
                    { action: '申请提交', operator: '褚十二', time: '2024-01-21 11:00', comment: '已提交披露变更申请' }
                ],
                customData: {
                    type: 'disclosure-change',
                    asset: {
                        code: 'ZC002',
                        name: '供应商信用评价与合规性分析数据集',
                        category: '存货',
                        status: '正常',
                        bookValue: '¥560,000',
                        location: '财务共享平台',
                        disclosureStatus: '未披露'
                    },
                    disclosure: {
                        type: '季度报告',
                        date: '2024-02-28',
                        title: '2024Q1 数据资产核算调整说明',
                        content: '披露资产减值、跌价准备及转回的关键事实，包括计提依据、影响金额、管理措施等，并同步说明后续核算策略。',
                        scope: '内部披露 - 财务管理层与审计部门',
                        attachments: [
                            { name: '2024Q1核算调整说明.pdf', size: '1.1MB' },
                            { name: '跌价准备评估.xlsx', size: '620KB' }
                        ]
                    }
                },
                attachments: [
                    { name: '2024Q1核算调整说明.pdf', size: '1.1MB', url: '#' },
                    { name: '跌价准备评估.xlsx', size: '620KB', url: '#' }
                ]
            },
            {
                id: 13,
                type: 'processing',
                title: '资产处置',
                description: '申请人：蒋十三（资产管理部）申请处置过期数据资产。需要清理不再使用的历史数据，释放存储资源。涉及资产：2018-2020年历史交易数据、已停用业务系统数据。',
                status: 'pending',
                applicant: '蒋十三',
                department: '资产管理部',
                createTime: '2024-01-22 09:30',
                deadline: '2024-02-05 18:00',
                assignee: '资产主管',
                completeTime: null,
                processSteps: [
                    { name: '提交申请', status: 'completed', time: '2024-01-22 09:30', operator: '蒋十三' },
                    { name: '处置审核', status: 'current', time: null, operator: '资产主管' },
                    { name: '执行处置', status: 'pending', time: null, operator: '技术部' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-22 09:30', comment: '任务已创建并分配给资产主管' },
                    { action: '申请提交', operator: '蒋十三', time: '2024-01-22 09:30', comment: '已提交资产处置申请' }
                ],
                customData: {
                    type: 'asset-disposal',
                    asset: {
                        code: 'ASSET-2020-ARCHIVE',
                        name: '2018-2020 历史交易数据备份',
                        category: '结构化数据',
                        department: '资产管理部',
                        storage: '对象存储（归档层）',
                        size: '3.4 TB',
                        retentionPolicy: '原保留周期 36 个月，现已超过 18 个月'
                    },
                    plan: {
                        type: '销毁（含安全擦除及日志留存）',
                        targetDate: '2024-02-05',
                        responsibleTeam: '技术运营中心',
                        approvalRequirement: '需业务负责人+合规负责人联合签批',
                        reason: '数据超过保留周期且已完成业务稽核，需及时处置释放存储资源，并确保删除前完成审计备份。',
                        steps: [
                            '确认审计留存备份并输出验证报告',
                            '对敏感分区执行离线脱敏处理',
                            '使用集中工具执行七次覆盖擦除并导出销毁报告',
                            '在资产台账登记销毁结果并保留日志 12 个月'
                        ]
                    }
                },
                attachments: [
                    { name: '资产处置清单.xlsx', size: '2.3MB', url: '#' },
                    { name: '处置方案.pdf', size: '1.6MB', url: '#' }
                ]
            },
            {
                id: 14,
                type: 'processing',
                title: '数据资产开发(形成)',
                description: '申请人：韩十四（项目组）申请数据资产开发项目验收。项目已完成开发工作，需要进行最终验收和资产形成确认。',
                status: 'completed',
                applicant: '韩十四',
                department: '项目组',
                createTime: '2024-01-10 08:00',
                deadline: '2024-01-20 18:00',
                assignee: '项目主管',
                completeTime: '2024-01-19 16:00',
                processSteps: [
                    { name: '项目开发', status: 'completed', time: '2024-01-10 08:00', operator: '韩十四' },
                    { name: '测试验收', status: 'completed', time: '2024-01-18 14:00', operator: '测试部' },
                    { name: '资产形成', status: 'completed', time: '2024-01-19 16:00', operator: '项目主管' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-10 08:00', comment: '任务已创建并分配给项目主管' },
                    { action: '项目完成', operator: '韩十四', time: '2024-01-10 08:00', comment: '数据资产开发项目已完成' },
                    { action: '验收通过', operator: '测试部', time: '2024-01-18 14:00', comment: '测试验收通过' },
                    { action: '资产形成', operator: '项目主管', time: '2024-01-19 16:00', comment: '数据资产已成功形成并入库' }
                ],
                attachments: [
                    { name: '项目验收报告.pdf', size: '4.2MB', url: '#' },
                    { name: '资产清单.xlsx', size: '1.5MB', url: '#' }
                ]
            },
            {
                id: 15,
                type: 'processing',
                title: '资产标签变更',
                description: '申请人：朱十五（标签管理部）申请更新数据资产标签信息。需要为资产添加新的标签维度，优化标签体系，提高资产检索效率。',
                status: 'processing',
                applicant: '朱十五',
                department: '标签管理部',
                createTime: '2024-01-20 13:00',
                deadline: '2024-02-10 18:00',
                assignee: '标签主管',
                completeTime: null,
                processSteps: [
                    { name: '提交申请', status: 'completed', time: '2024-01-20 13:00', operator: '朱十五' },
                    { name: '标签设计', status: 'current', time: '2024-01-21 10:00', operator: '标签主管' },
                    { name: '标签更新', status: 'pending', time: null, operator: '技术部' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-20 13:00', comment: '任务已创建并分配给标签主管' },
                    { action: '申请提交', operator: '朱十五', time: '2024-01-20 13:00', comment: '已提交资产标签变更申请' },
                    { action: '开始设计', operator: '标签主管', time: '2024-01-21 10:00', comment: '正在设计新的标签体系' }
                ],
                customData: {
                    type: 'tag-change',
                    tag: {
                        name: '高价值客户识别',
                        description: '用于标识近12个月贡献毛利前10%的客户群体，支撑精准营销与权益运营。',
                        color: '#14B8A6',
                        enabled: true,
                        parent: '客户标签体系 / 价值标签'
                    },
                    addSubTags: [
                        { name: '高交易频次客户', remark: '月交易次数超过行业基准 2 倍' },
                        { name: '权益活动高参与度客户', remark: '权益活动参与率 > 60%' }
                    ],
                    retireSubTags: [
                        { name: 'VIP_legacy', remark: '旧版 VIP 规则已与新规则整合' }
                    ],
                    governanceChecklist: [
                        '同步更新标签血缘关系与引用清单',
                        '通知模型使用方更新字段配置',
                        '在标签中心发布变更公告并记录审批意见'
                    ]
                },
                attachments: [
                    { name: '标签体系方案.docx', size: '2.7MB', url: '#' }
                ]
            },
            {
                id: 16,
                type: 'processing',
                title: '自定义分级分类更新至资产',
                description: '系统自动：资源详情页字段编辑中修改了字段的自定义分级分类并选择了更新至资产，需要审批确认后同步更新资产信息。',
                status: 'pending',
                applicant: '系统自动',
                department: '数据管理部',
                createTime: '2024-01-23 14:30',
                deadline: '2024-01-25 18:00',
                assignee: '数据主管',
                completeTime: null,
                processSteps: [
                    { name: '提交申请', status: 'completed', time: '2024-01-23 14:30', operator: '系统自动' },
                    { name: '资源审核', status: 'current', time: null, operator: '数据主管' },
                    { name: '资产同步', status: 'pending', time: null, operator: '技术部' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-23 14:30', comment: '资源字段变更触发资产同步流程' },
                    { action: '申请提交', operator: '系统自动', time: '2024-01-23 14:30', comment: '已提交自定义分级分类更新至资产申请' }
                ],
                customData: {
                    type: 'custom-classification-update',
                    asset: {
                        code: 'ASSET-2024-002',
                        name: '客户画像数据集',
                        type: '结构化数据',
                        size: '1.8GB'
                    },
                    resource: {
                        id: 'RES-2024-001',
                        name: '客户画像数据表'
                    },
                    changes: [
                        { field: '自定义分级', before: '三级', after: '四级', type: '修改' },
                        { field: '自定义分类', before: '客户数据', after: '客户画像数据', type: '修改' }
                    ],
                    source: '资源详情页字段编辑 - 自定义分级分类更新至资产',
                    description: '在资源详情页字段编辑中，修改了字段的自定义分级分类，并选择了更新至资产。系统自动触发资源变更流程，需要审批确认后同步更新资产信息。'
                },
                attachments: []
            },
            {
                id: 17,
                type: 'processing',
                title: '扫描资源更新至资产',
                description: '系统自动：数据资源扫描的扫描报告中触发了更新至资产操作，需要审批确认后同步更新资产信息。',
                status: 'pending',
                applicant: '系统自动',
                department: '数据管理部',
                createTime: '2024-01-24 10:15',
                deadline: '2024-01-26 18:00',
                assignee: '数据主管',
                completeTime: null,
                processSteps: [
                    { name: '提交申请', status: 'completed', time: '2024-01-24 10:15', operator: '系统自动' },
                    { name: '资源审核', status: 'current', time: null, operator: '数据主管' },
                    { name: '资产同步', status: 'pending', time: null, operator: '技术部' }
                ],
                history: [
                    { action: '任务创建', operator: '系统', time: '2024-01-24 10:15', comment: '扫描报告触发资产同步流程' },
                    { action: '申请提交', operator: '系统自动', time: '2024-01-24 10:15', comment: '已提交扫描资源更新至资产申请' }
                ],
                customData: {
                    type: 'scan-resource-update',
                    asset: {
                        code: 'ASSET-2024-003',
                        name: '订单数据表',
                        type: '结构化数据',
                        size: '2.5GB'
                    },
                    resource: {
                        id: 'RES-2024-002',
                        name: '订单主表'
                    },
                    scanReport: {
                        id: 'SCAN-2024-001',
                        name: '数据资源扫描报告-20240124',
                        scanTime: '2024-01-24 09:30'
                    },
                    changes: [
                        { field: '数据大小', before: '2.0GB', after: '2.5GB', type: '修改' },
                        { field: '字段数量', before: '25', after: '28', type: '修改' }
                    ],
                    description: '在数据资源扫描的扫描报告中，检测到资源信息变更，并选择了更新至资产。系统自动触发资源更新流程，需要审批确认后同步更新资产信息。'
                },
                attachments: []
            }
        ];

        // 流程数据
        const processData = [
            {
                id: 1,
                type: 'permission',
                title: '数据资产权限申请',
                description: '申请使用"采购数据专题分析模型"进行业务分析',
                status: 'processing',
                currentStep: 2,
                totalSteps: 4,
                steps: ['提交申请', '部门审批', '安全审查', '最终审批'],
                createTime: '2024-01-15 10:15',
                updateTime: '2024-01-15 14:30',
                assignee: '张三',
                approver: '李经理'
            },
            {
                id: 2,
                type: 'content',
                title: '资产内容变更',
                description: '更新"销售数据分析模型"的数据内容和业务规则',
                status: 'pending',
                currentStep: 1,
                totalSteps: 3,
                steps: ['提交变更', '内容审核', '发布更新'],
                createTime: '2024-01-15 09:45',
                updateTime: '2024-01-15 09:45',
                assignee: '李四',
                approver: '王总'
            },
            {
                id: 3,
                type: 'development-init',
                title: '数据资产开发(立项)',
                description: '立项开发"用户画像分析模型"数据资产项目',
                status: 'processing',
                currentStep: 2,
                totalSteps: 3,
                steps: ['项目申请', '立项审批', '项目启动'],
                createTime: '2024-01-14 14:20',
                updateTime: '2024-01-15 10:20',
                assignee: '王五',
                approver: '赵经理'
            },
            {
                id: 4,
                type: 'attribute',
                title: '数据属性变更',
                description: '修改"客户信息数据表"的属性定义和字段说明',
                status: 'approved',
                currentStep: 2,
                totalSteps: 2,
                steps: ['提交变更', '属性审核'],
                createTime: '2024-01-13 15:30',
                updateTime: '2024-01-14 09:15',
                assignee: '张三',
                approver: '技术总监'
            },
            {
                id: 5,
                type: 'catalog',
                title: '资产目录变更',
                description: '调整"数据分析模型库"的目录结构和组织方式',
                status: 'completed',
                currentStep: 3,
                totalSteps: 3,
                steps: ['提交变更', '目录审核', '更新完成'],
                createTime: '2024-01-11 09:30',
                updateTime: '2024-01-12 16:45',
                assignee: '周八',
                approver: '数据管理部'
            },
            {
                id: 6,
                type: 'development-dev',
                title: '数据资产开发(开发)',
                description: '开发"供应链数据分析模型"的技术实现',
                status: 'processing',
                currentStep: 3,
                totalSteps: 5,
                steps: ['需求分析', '设计评审', '开发实现', '测试验证', '代码审查'],
                createTime: '2024-01-10 08:00',
                updateTime: '2024-01-15 15:20',
                assignee: '吴九',
                approver: '开发经理'
            },
            {
                id: 9,
                type: 'impairment',
                title: '减值变更',
                description: '计提"供应商信用评价与合规性分析数据集"的减值准备',
                status: 'pending',
                currentStep: 1,
                totalSteps: 3,
                steps: ['提交申请', '财务审核', '系统更新'],
                createTime: '2024-01-21 11:00',
                updateTime: '2024-01-21 11:00',
                assignee: '财务主管',
                approver: '财务部'
            },
            {
                id: 10,
                type: 'decline',
                title: '跌价变更',
                description: '计提"供应商信用评价与合规性分析数据集"的跌价准备',
                status: 'pending',
                currentStep: 1,
                totalSteps: 3,
                steps: ['提交申请', '财务审核', '系统更新'],
                createTime: '2024-01-21 11:00',
                updateTime: '2024-01-21 11:00',
                assignee: '财务主管',
                approver: '财务部'
            },
            {
                id: 11,
                type: 'reversal',
                title: '转回变更',
                description: '转回"供应商信用评价与合规性分析数据集"的跌价准备',
                status: 'pending',
                currentStep: 1,
                totalSteps: 3,
                steps: ['提交申请', '财务审核', '系统更新'],
                createTime: '2024-01-21 11:00',
                updateTime: '2024-01-21 11:00',
                assignee: '财务主管',
                approver: '财务部'
            },
            {
                id: 12,
                type: 'disclosure',
                title: '披露变更',
                description: '披露"供应商信用评价与合规性分析数据集"的核算调整信息',
                status: 'pending',
                currentStep: 1,
                totalSteps: 3,
                steps: ['提交申请', '财务审核', '系统更新'],
                createTime: '2024-01-21 11:00',
                updateTime: '2024-01-21 11:00',
                assignee: '财务主管',
                approver: '财务部'
            },
            {
                id: 13,
                type: 'disposal',
                title: '资产处置',
                description: '处置已过期的"历史交易数据备份"资产',
                status: 'processing',
                currentStep: 2,
                totalSteps: 4,
                steps: ['提交申请', '安全评估', '审批确认', '执行处置'],
                createTime: '2024-01-08 10:45',
                updateTime: '2024-01-15 09:00',
                assignee: '钱十一',
                approver: '资产管理部'
            },
            {
                id: 14,
                type: 'development-form',
                title: '数据资产开发(形成)',
                description: '将"客户行为分析报告"正式形成数据资产',
                status: 'pending',
                currentStep: 1,
                totalSteps: 4,
                steps: ['提交申请', '质量评估', '资产登记', '正式发布'],
                createTime: '2024-01-15 13:20',
                updateTime: '2024-01-15 13:20',
                assignee: '孙十二',
                approver: '资产管理员'
            },
            {
                id: 15,
                type: 'tag',
                title: '资产标签变更',
                description: '为"销售预测模型"添加新的业务标签和分类标签',
                status: 'processing',
                currentStep: 2,
                totalSteps: 2,
                steps: ['提交变更', '标签审核'],
                createTime: '2024-01-14 16:00',
                updateTime: '2024-01-15 11:15',
                assignee: '李十三',
                approver: '标签管理员'
            }
        ];

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            loadDataFromStorage();
            initializePage();
            loadMessages();
            loadProcesses();
            setupEventListeners();
        });

        // 从本地存储加载数据
        function loadDataFromStorage() {
            // 加载消息数据
            const savedMessages = localStorage.getItem('personalCenterMessages');
            if (savedMessages) {
                const parsedMessages = JSON.parse(savedMessages);
                // 合并保存的消息和默认消息
                parsedMessages.forEach(savedMsg => {
                    const existingIndex = messageData.findIndex(msg => msg.id === savedMsg.id);
                    if (existingIndex >= 0) {
                        messageData[existingIndex] = { ...messageData[existingIndex], ...savedMsg };
                    } else {
                        messageData.push(savedMsg);
                    }
                });
            }

            // 加载流程数据
            const savedProcesses = localStorage.getItem('personalCenterProcesses');
            if (savedProcesses) {
                const parsedProcesses = JSON.parse(savedProcesses);
                // 合并保存的流程和默认流程
                parsedProcesses.forEach(savedProcess => {
                    const existingIndex = processData.findIndex(process => process.id === savedProcess.id);
                    if (existingIndex >= 0) {
                        processData[existingIndex] = { ...processData[existingIndex], ...savedProcess };
                    } else {
                        processData.push(savedProcess);
                    }
                });
            }
        }

        // 保存数据到本地存储
        function saveDataToStorage() {
            localStorage.setItem('personalCenterMessages', JSON.stringify(messageData));
            localStorage.setItem('personalCenterProcesses', JSON.stringify(processData));
        }

        // 初始化页面
        function initializePage() {
            updateStatistics();
        }

        // 更新统计信息
        function updateStatistics() {
            const unreadCount = messageData.filter(msg => !msg.read).length;
            const completedCount = processData.filter(process => process.status === 'completed').length;
            const processingCount = processData.filter(process => process.status === 'processing').length;
            const pendingCount = processData.filter(process => process.status === 'pending').length;

            document.getElementById('unreadCount').textContent = unreadCount;
            document.getElementById('completedCount').textContent = completedCount;
            document.getElementById('processingCount').textContent = processingCount;
            document.getElementById('pendingCount').textContent = pendingCount;
        }

        // 设置事件监听器
        function setupEventListeners() {
            // 标签页切换
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });

            // 消息筛选
            document.getElementById('messageFilter').addEventListener('change', function() {
                loadMessages();
            });

            // 流程筛选
            document.getElementById('processFilter').addEventListener('change', function() {
                loadProcesses();
            });

            document.getElementById('statusFilter').addEventListener('change', function() {
                loadProcesses();
            });
        }

        // 切换标签页
        function switchTab(tabName) {
            // 更新按钮状态
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active', 'border-blue-500', 'text-blue-600');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            const activeButton = document.querySelector(`[data-tab="${tabName}"]`);
            activeButton.classList.add('active', 'border-blue-500', 'text-blue-600');
            activeButton.classList.remove('border-transparent', 'text-gray-500');

            // 显示对应内容
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
        }

        // 加载消息列表
        function loadMessages() {
            const filter = document.getElementById('messageFilter').value;
            const container = document.getElementById('messageList');
            const totalMessages = document.getElementById('totalMessages');
            
            let filteredMessages = messageData;
            
            if (filter !== 'all') {
                filteredMessages = messageData.filter(msg => {
                    if (filter === 'unread') return !msg.isRead;
                    return msg.type === filter;
                });
            }
            
            totalMessages.textContent = filteredMessages.length;
            
            container.innerHTML = filteredMessages.map(message => `
                <div class="notification-item ${!message.isRead ? 'unread' : ''} bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer" onclick="showMessageDetail(${message.id})">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-2">
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getMessageTypeClass(message.type)}">
                                    ${getMessageTypeText(message.type)}
                                </span>
                                ${!message.isRead ? '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">未读</span>' : ''}
                            </div>
                            <h4 class="text-sm font-medium text-gray-900 mb-1">${message.title}</h4>
                            <p class="text-sm text-gray-600 mb-2">${message.content}</p>
                            <p class="text-xs text-gray-500">${message.time}</p>
                        </div>
                        <div class="ml-4">
                            <i class="fas fa-chevron-right text-gray-400"></i>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // 加载流程列表
        function loadProcesses() {
            const typeFilter = document.getElementById('processFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const container = document.getElementById('processList');
            const totalProcesses = document.getElementById('totalProcesses');
            
            let filteredProcesses = processData;
            
            if (typeFilter !== 'all') {
                filteredProcesses = filteredProcesses.filter(process => process.type === typeFilter);
            }
            
            if (statusFilter !== 'all') {
                filteredProcesses = filteredProcesses.filter(process => process.status === statusFilter);
            }
            
            totalProcesses.textContent = filteredProcesses.length;
            
            container.innerHTML = filteredProcesses.map(process => `
                <div class="bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-2">
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getProcessTypeClass(process.type)}">
                                    ${getProcessTypeText(process.type)}
                                </span>
                                <span class="status-badge ${getStatusClass(process.status)}">
                                    ${getStatusText(process.status)}
                                </span>
                            </div>
                            <h4 class="text-lg font-medium text-gray-900 mb-1">${process.title}</h4>
                            <p class="text-sm text-gray-600 mb-3">${process.description}</p>
                            
                            <!-- 流程步骤 -->
                            <div class="mb-4">
                                <div class="flex items-center space-x-2 mb-2">
                                    <span class="text-sm font-medium text-gray-700">流程进度：</span>
                                    <span class="text-sm text-gray-600">${process.currentStep}/${process.totalSteps}</span>
                                </div>
                                <div class="flex items-center space-x-1">
                                    ${process.steps.map((step, index) => `
                                        <div class="flex items-center">
                                            <div class="w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium ${getStepClass(index + 1, process.currentStep)}">
                                                ${index + 1}
                                            </div>
                                            <span class="ml-2 text-xs text-gray-600 ${getStepTextClass(index + 1, process.currentStep)}">${step}</span>
                                            ${index < process.steps.length - 1 ? '<div class="w-8 h-0.5 bg-gray-300 mx-2"></div>' : ''}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between text-sm text-gray-500">
                                <div>
                                    <span>申请人：${process.assignee}</span>
                                    <span class="mx-2">|</span>
                                    <span>审批人：${process.approver}</span>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <span>创建时间：${process.createTime}</span>
                                <button onclick="showProcessDetail(${process.id})" class="text-blue-600 hover:text-blue-800">
                                    查看详情
                                </button>
                                <button onclick="addNewProcess()" class="px-4 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 ml-4">
                                    添加流程
                                </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // 显示消息详情
        function showMessageDetail(messageId) {
            const message = messageData.find(msg => msg.id === messageId);
            if (!message) return;
            
            // 标记为已读
            message.read = true;
            saveDataToStorage();
            updateMessageStatistics();
            renderMessagesList();
            
            const modal = document.getElementById('messageDetailModal');
            const content = document.getElementById('messageDetailContent');
            
            content.innerHTML = `
                <div class="mb-4">
                    <div class="flex items-center space-x-2 mb-2">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getMessageTypeClass(message.type)}">
                            ${getMessageTypeText(message.type)}
                        </span>
                    </div>
                    <h3 class="text-lg font-medium text-gray-900 mb-2">${message.title}</h3>
                    <p class="text-sm text-gray-500 mb-4">${message.timestamp}</p>
                </div>
                <div class="bg-gray-50 rounded-lg p-4">
                    <p class="text-gray-700">${message.content}</p>
                </div>
            `;
            
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // 显示流程详情
        function showProcessDetail(processId) {
            const process = processData.find(p => p.id === processId);
            if (!process) return;
            
            // 如果是复杂流程，跳转到对应的专门页面
            if (shouldNavigateToDetailPage(process)) {
                const navInfo = getTaskNavigationInfo(process);
                if (navInfo) {
                    // 构建URL参数
                    const params = new URLSearchParams();
                    Object.keys(navInfo.params).forEach(key => {
                        params.append(key, navInfo.params[key]);
                    });
                    // 跳转到审批版页面
                    window.location.href = `${navInfo.page}?${params.toString()}`;
                    return;
                }
            }
            
            // 简单流程：在弹窗中处理
            const modal = document.getElementById('processDetailModal');
            const content = document.getElementById('processDetailContent');
            
            content.innerHTML = `
                <div class="mb-6">
                    <div class="flex items-center space-x-2 mb-4">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getProcessTypeClass(process.type)}">
                            ${getProcessTypeText(process.type)}
                        </span>
                        <span class="status-badge ${getStatusClass(process.status)}">
                            ${getStatusText(process.status)}
                        </span>
                    </div>
                    <h3 class="text-xl font-medium text-gray-900 mb-2">${process.title}</h3>
                    <p class="text-gray-600 mb-4">${process.description}</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <h4 class="text-sm font-medium text-gray-700 mb-2">基本信息</h4>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">申请人：</span>
                                    <span class="text-gray-900">${process.assignee}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">审批人：</span>
                                    <span class="text-gray-900">${process.approver}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">创建时间：</span>
                                    <span class="text-gray-900">${process.createTime}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">更新时间：</span>
                                    <span class="text-gray-900">${process.updateTime}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="text-sm font-medium text-gray-700 mb-2">流程步骤</h4>
                        <div class="space-y-3">
                            ${process.steps.map((step, index) => `
                                <div class="flex items-center">
                                    <div class="w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium ${getStepClass(index + 1, process.currentStep)}">
                                        ${index + 1}
                                    </div>
                                    <div class="ml-3">
                                        <div class="text-sm font-medium ${getStepTextClass(index + 1, process.currentStep)}">${step}</div>
                                        <div class="text-xs text-gray-500">${getStepStatusText(index + 1, process.currentStep)}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // 隐藏消息详情
        function hideMessageDetail() {
            document.getElementById('messageDetailModal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // 隐藏流程详情
        function hideProcessDetail() {
            document.getElementById('processDetailModal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // 全部标记为已读
        function markAllAsRead() {
            messageData.forEach(message => {
                message.isRead = true;
            });
            saveDataToStorage();
            updateStatistics();
            loadMessages();
            alert('所有消息已标记为已读');
        }

        // 添加新消息
        function addNewMessage() {
            const title = prompt('请输入消息标题：');
            if (!title) return;
            
            const content = prompt('请输入消息内容：');
            if (!content) return;
            
            const type = prompt('请选择消息类型（system/process/approval）：');
            if (!['system', 'process', 'approval'].includes(type)) {
                alert('消息类型无效，请选择 system、process 或 approval');
                return;
            }
            
            const newMessage = {
                id: Math.max(...messageData.map(m => m.id)) + 1,
                type: type,
                title: title,
                content: content,
                time: new Date().toLocaleString('zh-CN'),
                isRead: false
            };
            
            messageData.unshift(newMessage);
            saveDataToStorage();
            updateStatistics();
            loadMessages();
            alert('消息添加成功！');
        }

        // 添加新流程
        function addNewProcess() {
            const title = prompt('请输入流程标题：');
            if (!title) return;
            
            const description = prompt('请输入流程描述：');
            if (!description) return;
            
            const type = prompt('请选择流程类型（permission/source/content/resource/ownership/development）：');
            if (!['permission', 'source', 'content', 'resource', 'ownership', 'development'].includes(type)) {
                alert('流程类型无效');
                return;
            }
            
            const newProcess = {
                id: Math.max(...processData.map(p => p.id)) + 1,
                type: type,
                title: title,
                description: description,
                status: 'pending',
                currentStep: 1,
                totalSteps: 3,
                steps: ['提交申请', '审核', '审批'],
                createTime: new Date().toLocaleString('zh-CN'),
                updateTime: new Date().toLocaleString('zh-CN'),
                assignee: '当前用户',
                approver: '待分配'
            };
            
            processData.unshift(newProcess);
            saveDataToStorage();
            updateStatistics();
            loadProcesses();
            alert('流程添加成功！');
        }

        // 获取消息类型样式
        function getMessageTypeClass(type) {
            const classes = {
                'system': 'bg-blue-100 text-blue-800',
                'process': 'bg-green-100 text-green-800',
                'approval': 'bg-yellow-100 text-yellow-800'
            };
            return classes[type] || 'bg-gray-100 text-gray-800';
        }

        // 获取消息类型文本
        function getMessageTypeText(type) {
            const texts = {
                'system': '知会通知',
                'process': '流程通知',
                'approval': '审批通知'
            };
            return texts[type] || '其他';
        }

        // 获取流程类型样式
        function getProcessTypeClass(type) {
            const classes = {
                'permission': 'bg-blue-100 text-blue-800',
                'content': 'bg-yellow-100 text-yellow-800',
                'development-init': 'bg-indigo-100 text-indigo-800',
                'attribute': 'bg-purple-100 text-purple-800',
                'classification': 'bg-pink-100 text-pink-800',
                'category': 'bg-teal-100 text-teal-800',
                'catalog': 'bg-cyan-100 text-cyan-800',
                'development-dev': 'bg-indigo-100 text-indigo-800',
                'accounting': 'bg-green-100 text-green-800',
                'disposal': 'bg-red-100 text-red-800',
                'development-form': 'bg-indigo-100 text-indigo-800',
                'tag': 'bg-orange-100 text-orange-800'
            };
            return classes[type] || 'bg-gray-100 text-gray-800';
        }

        // 获取流程类型文本
        function getProcessTypeText(type) {
            const texts = {
                'permission': '数据资产权限申请',
                'content': '资产内容变更',
                'development-init': '数据资产开发(立项)',
                'attribute': '数据属性变更',
                'catalog': '资产目录变更',
                'development-dev': '数据资产开发(开发)',
                'impairment': '减值变更',
                'decline': '跌价变更',
                'reversal': '转回变更',
                'disclosure': '披露变更',
                'disposal': '资产处置',
                'development-form': '数据资产开发(形成)',
                'tag': '资产标签变更',
                'custom-classification-update': '自定义分级分类更新至资产',
                'scan-resource-update': '扫描资源更新至资产'
            };
            return texts[type] || '其他';
        }

        // 获取状态样式
        function getStatusClass(status) {
            const classes = {
                'pending': 'status-pending',
                'processing': 'status-processing',
                'approved': 'status-approved',
                'rejected': 'status-rejected',
                'completed': 'status-completed'
            };
            return classes[status] || 'status-pending';
        }

        // 获取状态文本
        function getStatusText(status) {
            const texts = {
                'pending': '待处理',
                'processing': '进行中',
                'approved': '已通过',
                'rejected': '已拒绝',
                'completed': '已完成'
            };
            return texts[status] || '未知';
        }

        // 获取步骤样式
        function getStepClass(stepNumber, currentStep) {
            if (stepNumber < currentStep) {
                return 'bg-green-500 text-white';
            } else if (stepNumber === currentStep) {
                return 'bg-blue-500 text-white';
            } else {
                return 'bg-gray-300 text-gray-600';
            }
        }

        // 获取步骤文本样式
        function getStepTextClass(stepNumber, currentStep) {
            if (stepNumber < currentStep) {
                return 'text-green-600';
            } else if (stepNumber === currentStep) {
                return 'text-blue-600 font-medium';
            } else {
                return 'text-gray-500';
            }
        }

        // 获取步骤状态文本
        function getStepStatusText(stepNumber, currentStep) {
            if (stepNumber < currentStep) {
                return '已完成';
            } else if (stepNumber === currentStep) {
                return '进行中';
            } else {
                return '待处理';
            }
        }

        // 点击弹窗外部关闭弹窗
        document.addEventListener('click', function(event) {
            const messageModal = document.getElementById('messageDetailModal');
            const processModal = document.getElementById('processDetailModal');
            
            if (event.target === messageModal) {
                hideMessageDetail();
            }
            if (event.target === processModal) {
                hideProcessDetail();
            }
        });

        // ==================== 任务详情相关函数 ====================
        
        // 判断任务是否需要跳转到专门页面（处理任务模式时，所有任务都跳转）
        function shouldNavigateToDetailPage(task, mode) {
            // 处理任务模式：所有任务都跳转到专门页面
            if (mode === 'process') {
                return true;
            }
            
            // 查看详情模式：只有复杂任务跳转
            const title = task.title || '';
            
            // 数据资产开发相关
            if (title.includes('数据资产开发(立项)')) return true;
            if (title.includes('数据资产开发(开发)')) return true;
            if (title.includes('数据资产开发(形成)')) return true;
            
            // 权限申请
            if (title.includes('数据资产权限申请')) return true;
            
            // 资产内容变更
            if (title.includes('资产内容变更')) return true;
            
            return false;
        }
        
        // 获取任务跳转的目标页面和参数
        function getTaskNavigationInfo(task) {
            const title = task.title || '';
            
            // 数据资产开发(立项) → 项目详情页 - 立项阶段
            if (title.includes('数据资产开发(立项)')) {
                return {
                    page: '项目详情-审批版.html',
                    params: { id: task.id, tab: 'research-phase' }
                };
            }
            
            // 数据资产开发(开发) → 项目详情页 - 开发阶段
            if (title.includes('数据资产开发(开发)')) {
                return {
                    page: '项目详情-审批版.html',
                    params: { id: task.id, tab: 'development-phase' }
                };
            }
            
            // 数据资产开发(形成) → 项目详情页 - 资产阶段
            if (title.includes('数据资产开发(形成)')) {
                return {
                    page: '项目详情-审批版.html',
                    params: { id: task.id, tab: 'asset-phase' }
                };
            }
            
            // 数据资产权限申请 → 申请使用页
            if (title.includes('数据资产权限申请')) {
                return {
                    page: '申请使用-审批版.html',
                    params: { id: task.id }
                };
            }
            
            // 资产内容变更 → 资产内容管理页
            if (title.includes('资产内容变更')) {
                return {
                    page: '资产内容管理-审批版.html',
                    params: { id: task.id }
                };
            }
            
            // 数据属性变更 → 资产属性管理审批版
            if (title.includes('数据属性变更')) {
                return {
                    page: '资产属性管理-审批版.html',
                    params: { id: task.id }
                };
            }
            
            // 资产目录变更 → 资产目录管理审批版
            if (title.includes('资产目录变更')) {
                return {
                    page: '资产目录管理-审批版.html',
                    params: { id: task.id }
                };
            }
            
            // 资产标签变更 → 资产标签管理审批版
            if (title.includes('资产标签变更')) {
                return {
                    page: '资产标签管理-审批版.html',
                    params: { id: task.id }
                };
            }
            
            // 自定义分级分类更新至资产 → 资源变更审批版
            if (title.includes('自定义分级分类更新至资产')) {
                return {
                    page: '资源变更-审批版.html',
                    params: { id: task.id }
                };
            }
            
            // 扫描资源更新至资产 → 扫描资源更新至资产审批版
            if (title.includes('扫描资源更新至资产')) {
                return {
                    page: '扫描资源更新至资产-审批版.html',
                    params: { id: task.id }
                };
            }
            
            // 减值变更 → 减值变更审批版
            if (title.includes('减值变更')) {
                return {
                    page: '减值变更-审批版.html',
                    params: { id: task.id }
                };
            }
            
            // 跌价变更 → 跌价变更审批版
            if (title.includes('跌价变更')) {
                return {
                    page: '跌价变更-审批版.html',
                    params: { id: task.id }
                };
            }
            
            // 转回变更 → 转回变更审批版
            if (title.includes('转回变更')) {
                return {
                    page: '转回变更-审批版.html',
                    params: { id: task.id }
                };
            }
            
            // 披露变更 → 披露变更审批版
            if (title.includes('披露变更')) {
                return {
                    page: '披露变更-审批版.html',
                    params: { id: task.id }
                };
            }
            
            // 资产处置 → 资产处置审批版
            if (title.includes('资产处置')) {
                return {
                    page: '资产处置-审批版.html',
                    params: { id: task.id }
                };
            }
            
            return null;
        }

        // 显示任务详情
        // mode: 'view' 查看详情模式（只查看，不能操作） | 'process' 处理任务模式（可以操作）
        function showTaskDetail(taskId, mode = 'view') {
            // 确保 taskId 是数字类型
            const id = typeof taskId === 'string' ? parseInt(taskId, 10) : taskId;
            const task = taskData.find(t => t.id === id);
            if (!task) {
                alert('任务不存在');
                return;
            }

            // 处理任务模式：所有任务都跳转到对应页面
            if (mode === 'process') {
                const navInfo = getTaskNavigationInfo(task);
                if (navInfo) {
                    // 构建URL参数
                    const params = new URLSearchParams();
                    Object.keys(navInfo.params).forEach(key => {
                        params.append(key, navInfo.params[key]);
                    });
                    // 跳转到审批版页面
                    window.location.href = `${navInfo.page}?${params.toString()}`;
                    return;
                } else {
                    alert('该任务类型暂未配置审批页面');
                    return;
                }
            }

            const customContentContainer = document.getElementById('taskDetailCustomContent');

            // 查看详情模式：如果是复杂任务，跳转到对应的专门页面
            if (shouldNavigateToDetailPage(task, mode)) {
                const navInfo = getTaskNavigationInfo(task);
                if (navInfo) {
                    // 构建URL参数
                    const params = new URLSearchParams();
                    Object.keys(navInfo.params).forEach(key => {
                        params.append(key, navInfo.params[key]);
                    });
                    // 跳转到审批版页面
                    window.location.href = `${navInfo.page}?${params.toString()}`;
                    return;
                }
            }

            // 简单任务：在弹窗中处理
            const modal = document.getElementById('taskDetailModal');
            
            // 设置任务标题和状态
            document.getElementById('taskDetailTitle').textContent = task.title;
            
            // 设置图标和颜色
            const iconDiv = document.getElementById('taskDetailIcon');
            const iconClass = getTaskIconClass(task.type);
            iconDiv.className = `w-10 h-10 rounded-full flex items-center justify-center ${iconClass.bg}`;
            iconDiv.querySelector('i').className = `fas ${iconClass.icon} text-lg ${iconClass.text}`;
            
            // 设置状态标签
            const statusSpan = document.getElementById('taskDetailStatus');
            statusSpan.className = `inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getTaskStatusClass(task.status)}`;
            statusSpan.textContent = getTaskStatusText(task.status);
            
            // 设置基本信息
            document.getElementById('taskDetailType').textContent = getTaskTypeText(task.type);
            document.getElementById('taskDetailApplicant').textContent = task.applicant;
            document.getElementById('taskDetailDepartment').textContent = task.department;
            document.getElementById('taskDetailCreateTime').textContent = task.createTime;
            
            // 设置完成时间（如果已完成）
            const completeTimeContainer = document.getElementById('taskDetailCompleteTimeContainer');
            if (task.completeTime) {
                document.getElementById('taskDetailCompleteTime').textContent = task.completeTime;
                completeTimeContainer.classList.remove('hidden');
            } else {
                completeTimeContainer.classList.add('hidden');
            }
            
            // 设置流程进度（如果有）
            const processContainer = document.getElementById('taskDetailProcessContainer');
            if (task.processSteps && task.processSteps.length > 0) {
                const processStepsDiv = document.getElementById('taskDetailProcessSteps');
                processStepsDiv.innerHTML = task.processSteps.map((step, index) => {
                    const stepClass = getTaskStepClass(step.status);
                    return `
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium ${stepClass.circle}">
                                    ${step.status === 'completed' ? '<i class="fas fa-check text-xs"></i>' : index + 1}
                                </div>
                            </div>
                            <div class="ml-3 flex-1">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-sm font-medium ${stepClass.text}">${step.name}</p>
                                        <p class="text-xs text-gray-500 mt-1">负责人：${step.operator}</p>
                                        ${step.time ? `<p class="text-xs text-gray-400 mt-1">${step.time}</p>` : ''}
                                    </div>
                                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${stepClass.badge}">
                                        ${getTaskStepStatusText(step.status)}
                                    </span>
                                </div>
                                ${index < task.processSteps.length - 1 ? '<div class="h-4 w-0.5 bg-gray-200 ml-4 mt-2"></div>' : ''}
                            </div>
                        </div>
                    `;
                }).join('');
                processContainer.classList.remove('hidden');
            } else {
                processContainer.classList.add('hidden');
            }
            
            // 操作历史已隐藏，不再设置
            
            // 设置附件列表
            // 设置任务专用内容模板
            if (customContentContainer) {
                const customTemplate = getTaskCustomTemplate(task, mode);
                if (customTemplate) {
                    customContentContainer.innerHTML = customTemplate;
                    customContentContainer.classList.remove('hidden');
                    if (task.customData && task.customData.type === 'accounting-change') {
                        initializeAccountingChangeTabs(customContentContainer);
                    }
                } else {
                    customContentContainer.innerHTML = '';
                    customContentContainer.classList.add('hidden');
                }
            }
            
            // 根据模式设置操作按钮
            const actionsDiv = document.getElementById('taskDetailActions');
            const opinionInput = document.getElementById('taskDetailOpinion');
            if (opinionInput) {
                opinionInput.value = '';
                if (mode === 'process') {
                    opinionInput.removeAttribute('readonly');
                    opinionInput.classList.remove('bg-gray-100', 'cursor-not-allowed');
                    opinionInput.placeholder = '在此填写审批意见...';
                } else {
                    opinionInput.value = '';
                    opinionInput.setAttribute('readonly', 'true');
                    opinionInput.classList.add('bg-gray-100', 'cursor-not-allowed');
                    opinionInput.placeholder = '当前为查看模式，无法填写审批意见';
                }
            }
            
            if (mode === 'process') {
                // 处理任务模式：显示操作按钮
                actionsDiv.innerHTML = getTaskActionButtons(task);
            } else {
                // 查看详情模式：只显示关闭按钮
                actionsDiv.innerHTML = `
                    <button onclick="hideTaskDetail()" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors">
                        关闭
                    </button>
                `;
            }
            
            // 显示弹窗
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }
        
        // 隐藏任务详情
        function hideTaskDetail() {
            document.getElementById('taskDetailModal').classList.add('hidden');
            document.body.style.overflow = 'auto';
            const opinionInput = document.getElementById('taskDetailOpinion');
            if (opinionInput) {
                opinionInput.value = '';
            }
        }
        
        // 获取任务图标样式
        function getTaskIconClass(type) {
            const icons = {
                'approval': { icon: 'fa-check-circle', bg: 'bg-blue-100', text: 'text-blue-600' },
                'review': { icon: 'fa-eye', bg: 'bg-green-100', text: 'text-green-600' },
                'processing': { icon: 'fa-cog', bg: 'bg-purple-100', text: 'text-purple-600' },
                'notification': { icon: 'fa-bell', bg: 'bg-red-100', text: 'text-red-600' }
            };
            return icons[type] || { icon: 'fa-tasks', bg: 'bg-gray-100', text: 'text-gray-600' };
        }
        
        // 获取任务类型文本
        function getTaskTypeText(type) {
            const texts = {
                'approval': '审批任务',
                'review': '审核任务',
                'processing': '处理任务',
                'notification': '通知任务'
            };
            return texts[type] || '其他任务';
        }
        
        // 获取任务状态样式
        function getTaskStatusClass(status) {
            const classes = {
                'pending': 'bg-blue-100 text-blue-800',
                'processing': 'bg-yellow-100 text-yellow-800',
                'approved': 'bg-green-100 text-green-800',
                'rejected': 'bg-red-100 text-red-800',
                'completed': 'bg-green-100 text-green-800'
            };
            return classes[status] || 'bg-gray-100 text-gray-800';
        }
        
        // 获取任务状态文本
        function getTaskStatusText(status) {
            const texts = {
                'pending': '待处理',
                'processing': '进行中',
                'approved': '已通过',
                'rejected': '已拒绝',
                'completed': '已完成'
            };
            return texts[status] || '未知';
        }
        
        // 获取任务步骤样式
        function getTaskStepClass(status) {
            const classes = {
                'completed': {
                    circle: 'bg-green-500 text-white',
                    text: 'text-green-600',
                    badge: 'bg-green-100 text-green-800'
                },
                'current': {
                    circle: 'bg-blue-500 text-white',
                    text: 'text-blue-600',
                    badge: 'bg-blue-100 text-blue-800'
                },
                'pending': {
                    circle: 'bg-gray-300 text-gray-600',
                    text: 'text-gray-500',
                    badge: 'bg-gray-100 text-gray-800'
                }
            };
            return classes[status] || classes.pending;
        }
        
        // 获取任务步骤状态文本
        function getTaskStepStatusText(status) {
            const texts = {
                'completed': '已完成',
                'current': '进行中',
                'pending': '待处理'
            };
            return texts[status] || '待处理';
        }
        
        // 获取任务操作按钮
        function getTaskActionButtons(task) {
            return `
                <button onclick="handleTask('approve', ${task.id})" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors">
                    <i class="fas fa-check mr-2"></i>同意
                </button>
                <button onclick="handleTask('return', ${task.id})" class="px-4 py-2 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 transition-colors">
                    <i class="fas fa-undo mr-2"></i>退回
                </button>
                <button onclick="handleTask('reject', ${task.id})" class="px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors">
                    <i class="fas fa-times mr-2"></i>拒绝
                </button>
                <button onclick="hideTaskDetail()" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors">
                    关闭
                </button>
            `;
        }
        
        // 处理任务操作
        function handleTask(action, taskId) {
            const task = taskData.find(t => t.id === taskId);
            if (!task) return;
            const opinionInput = document.getElementById('taskDetailOpinion');
            const opinion = opinionInput ? opinionInput.value.trim() : '';
            
            switch(action) {
                case 'approve':
                    if (confirm('确定要同意该任务吗？')) {
                        const approveMessage = opinion ? `任务已同意，审批意见：${opinion}` : '任务已同意，流程将继续进行';
                        alert(approveMessage);
                        if (opinionInput) opinionInput.value = '';
                        hideTaskDetail();
                    }
                    break;
                case 'return':
                    if (!opinion) {
                        alert('请输入审批意见后再退回任务');
                        return;
                    }
                    alert('任务已退回：' + opinion);
                    if (opinionInput) opinionInput.value = '';
                    hideTaskDetail();
                    break;
                case 'reject':
                    if (!opinion) {
                        alert('请输入审批意见后再拒绝任务');
                        return;
                    }
                    alert('任务已拒绝：' + opinion);
                    if (opinionInput) opinionInput.value = '';
                    hideTaskDetail();
                    break;
                case 'process':
                case 'continue':
                    alert('正在跳转到任务处理页面...');
                    // 这里可以跳转到实际的处理页面
                    hideTaskDetail();
                    break;
                case 'submit':
                    if (confirm('确定要提交审核吗？')) {
                        const submitMessage = opinion ? `任务已提交审核，审批意见：${opinion}` : '任务已提交审核';
                        alert(submitMessage);
                        if (opinionInput) opinionInput.value = '';
                        hideTaskDetail();
                    }
                    break;
                case 'view':
                    alert(opinion ? `正在查看任务结果，当前审批意见：${opinion}` : '正在查看任务结果...');
                    // 这里可以跳转到结果页面
                    break;
            }
        }
        
        // 点击弹窗外部关闭弹窗
        document.addEventListener('click', function(event) {
            const taskModal = document.getElementById('taskDetailModal');
            if (event.target === taskModal) {
                hideTaskDetail();
            }
        });
        
        // ==================== 任务自定义模板渲染 ====================
        function safeValue(value, fallback = '-') {
            if (Array.isArray(value)) {
                return value.length ? value.join('；') : fallback;
            }
            return value !== undefined && value !== null && value !== '' ? value : fallback;
        }

        function renderAttachmentsList(attachments) {
            if (!attachments || !attachments.length) {
                return '<li class="text-sm text-gray-500">暂无附件</li>';
            }
            return attachments.map(file => `
                <li class="flex items-center gap-2 text-sm text-gray-700">
                    <i class="fas fa-file-alt text-blue-500"></i>
                    <span>${safeValue(file.name)} ${file.size ? `<span class="text-xs text-gray-400">(${safeValue(file.size)})</span>` : ''}</span>
                </li>
            `).join('');
        }

        function getTaskCustomTemplate(task, mode) {
            if (!task || !task.customData) return '';
            const data = task.customData;
            switch (data.type) {
                case 'attribute-change':
                    return renderAttributeChangeTemplate(data, task);
                case 'catalog-change':
                    return renderCatalogChangeTemplate(data, task);
                case 'tag-change':
                    return renderTagChangeTemplate(data, task);
                case 'impairment-change':
                    return renderImpairmentChangeTemplate(data, task);
                case 'decline-change':
                    return renderDeclineChangeTemplate(data, task);
                case 'reversal-change':
                    return renderReversalChangeTemplate(data, task);
                case 'disclosure-change':
                    return renderDisclosureChangeTemplate(data, task);
                case 'asset-disposal':
                    return renderAssetDisposalTemplate(data, task);
                case 'custom-classification-update':
                    return renderResourceChangeTemplate(data, task);
                case 'scan-resource-update':
                    return renderScanResourceUpdateTemplate(data, task);
                default:
                    return '';
            }
        }

        function renderAttributeChangeTemplate(data) {
            const attr = data.attribute || {};
            return `
                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm">
                    <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                        <h4 class="text-sm font-semibold text-gray-800">属性信息</h4>
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-50 text-blue-600">资产属性管理</span>
                    </div>
                    <div class="p-4 space-y-5">
                        <div>
                            <label class="block text-xs font-medium text-gray-500 mb-1">属性名称</label>
                            <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(attr.name)}" readonly>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 mb-1">属性描述</label>
                            <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(attr.description)}</textarea>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">是否启用</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${attr.enabled ? '是' : '否'}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">父节点</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(attr.parent)}" readonly>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderLevelChangeTemplate(data) {
            const level = data.level || {};
            const enabledText = level.enabled === undefined ? '-' : (level.enabled ? '是' : '否');
            return `
                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm">
                    <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                        <h4 class="text-sm font-semibold text-gray-800">分级信息</h4>
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-50 text-purple-600">数据分级管理</span>
                    </div>
                    <div class="p-4 space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">分级名称</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(level.name)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">父节点</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(level.parent)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">是否启用</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${enabledText}" readonly>
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 mb-1">分级描述</label>
                            <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(level.description)}</textarea>
                        </div>
                        ${level.attachment ? `
                        <div class="bg-blue-50 border border-blue-100 rounded-lg p-3 text-xs text-blue-800">
                            <span class="font-semibold mr-2">附件</span>${safeValue(level.attachment)}
                        </div>` : ''}
                    </div>
                </div>
            `;
        }

        function renderCategoryChangeTemplate(data) {
            const category = data.category || {};
            const enabledText = category.enabled === undefined ? '-' : (category.enabled ? '是' : '否');
            return `
                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm">
                    <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                        <h4 class="text-sm font-semibold text-gray-800">分类信息</h4>
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-amber-50 text-amber-600">数据分类管理</span>
                    </div>
                    <div class="p-4 space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">分类名称</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(category.name)}" readonly>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-xs font-medium text-gray-500 mb-1">分类描述</label>
                                <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(category.description)}</textarea>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">分级</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(category.level)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">是否启用</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${enabledText}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">父节点</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(category.parent)}" readonly>
                            </div>
                        </div>
                        ${category.attachment ? `
                        <div class="bg-blue-50 border border-blue-100 rounded-lg p-3 text-xs text-blue-800">
                            <span class="font-semibold mr-2">附件</span>${safeValue(category.attachment)}
                        </div>` : ''}
                    </div>
                </div>
            `;
        }

        function renderCatalogChangeTemplate(data) {
            const catalog = data.catalog || {};
            const enabledText = catalog.enabled === undefined ? '-' : (catalog.enabled ? '是' : '否');
            return `
                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm">
                    <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                        <h4 class="text-sm font-semibold text-gray-800">目录信息</h4>
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-cyan-50 text-cyan-600">资产目录管理</span>
                    </div>
                    <div class="p-4 space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">目录名称</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(catalog.name)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">父节点</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(catalog.parent)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">是否启用</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${enabledText}" readonly>
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 mb-1">目录描述</label>
                            <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(catalog.description)}</textarea>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderTagChangeTemplate(data) {
            const tag = data.tag || {};
            const colorValue = tag.color || '#14B8A6';
            const colorText = tag.color || '-';
            const enabledText = tag.enabled === undefined ? '-' : (tag.enabled ? '是' : '否');
            return `
                <div class="modal-scroll-content space-y-4">
                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm">
                        <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-800">标签信息</h4>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-teal-50 text-teal-600">资产标签管理</span>
                        </div>
                        <div class="p-4 space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">标签名称</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(tag.name)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">父节点</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(tag.parent)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">标签颜色</label>
                                    <div class="flex items-center gap-3">
                                        <span class="w-8 h-8 rounded-full border border-gray-200 shadow-inner" style="background-color: ${colorValue};"></span>
                                        <input type="text" class="flex-1 px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm font-mono uppercase tracking-wide" value="${colorText}" readonly>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">是否启用</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${enabledText}" readonly>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">标签描述</label>
                                <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(tag.description)}</textarea>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderAccountingChangeTemplate(data) {
            const asset = data.asset || {};
            const impairment = data.impairment || {};
            const decline = data.priceDecline || {};
            const reversalHistory = (data.priceReversal?.history || []).map(row => `
                <tr class="border-b last:border-b-0">
                    <td class="px-4 py-2 text-sm text-gray-500">${safeValue(row.date)}</td>
                    <td class="px-4 py-2 text-sm text-gray-900">${safeValue(row.amount)}</td>
                    <td class="px-4 py-2 text-sm text-gray-900">${safeValue(row.reversed)}</td>
                    <td class="px-4 py-2 text-sm text-gray-900">${safeValue(row.reversible)}</td>
                    <td class="px-4 py-2 text-sm text-gray-500">${safeValue(row.remark)}</td>
                </tr>
            `).join('');
            const disclosureAttachments = (data.disclosure?.attachments || []).map(file => `
                <li class="flex items-center gap-2 text-sm text-gray-700">
                    <i class="fas fa-file-alt text-blue-500"></i>
                    <span>${safeValue(file.name)} <span class="text-xs text-gray-400">(${safeValue(file.size)})</span></span>
                </li>
            `).join('');
            return `
                <div class="space-y-4">
                    <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                        <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-800">资产台账概览</h4>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-50 text-orange-600">会计核算</span>
                        </div>
                        <div class="p-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产编号</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm font-mono" value="${safeValue(asset.code)}" readonly>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产名称</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.name)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产类别</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.category)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">账面价值</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.bookValue)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">披露状态</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.disclosureStatus)}" readonly>
                            </div>
                        </div>
                    </div>
                    <div class="modal-tabs" data-accounting-tabs>
                        <div class="modal-tab-buttons">
                            <button class="modal-tab-button active" data-tab-target="impairment">减值</button>
                            <button class="modal-tab-button" data-tab-target="decline">跌价</button>
                            <button class="modal-tab-button" data-tab-target="reversal">转回</button>
                            <button class="modal-tab-button" data-tab-target="disclosure">披露</button>
                        </div>
                        <div class="modal-tab-panels">
                            <div class="modal-tab-panel active" data-tab-panel="impairment">
                                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                                    <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                                        <h4 class="text-sm font-semibold text-gray-800">减值管理</h4>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-700">减值</span>
                                    </div>
                                    <div class="p-4 space-y-3">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">原值</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(impairment.originalValue)}" readonly>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">累计摊销</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(impairment.accumulatedAmortization)}" readonly>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">现有账面价值</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(impairment.recoverableAmount)}" readonly>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">拟计提减值金额</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm font-semibold text-orange-600" value="${safeValue(impairment.proposedImpairment)}" readonly>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">评估日期</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(impairment.evaluationDate)}" readonly>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-semibold text-gray-700 mb-2">减值原因</label>
                                            <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="2" readonly>${safeValue(impairment.reason)}</textarea>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-semibold text-gray-700 mb-2">减值说明</label>
                                            <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(impairment.description)}</textarea>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-semibold text-gray-700 mb-2">附件清单</label>
                                            <ul class="space-y-1">
                                                ${renderAttachmentsList(impairment.attachments)}
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-tab-panel" data-tab-panel="decline">
                                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                                    <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                                        <h4 class="text-sm font-semibold text-gray-800">存货跌价准备</h4>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-700">跌价</span>
                                    </div>
                                    <div class="p-4 space-y-3">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">账面余额</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(decline.bookBalance)}" readonly>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">已计提跌价准备</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(decline.existingProvision)}" readonly>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">拟计提金额</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm font-semibold text-blue-600" value="${safeValue(decline.proposedProvision)}" readonly>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-semibold text-gray-700 mb-2">跌价说明</label>
                                            <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(decline.description)}</textarea>
                                        </div>
                                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-3">
                                            <span class="text-xs font-semibold text-gray-600">附件要求</span>
                                            <p class="text-sm text-gray-700 mt-1">${safeValue(decline.attachmentTips)}</p>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-semibold text-gray-700 mb-2">附件清单</label>
                                            <ul class="space-y-1">
                                                ${renderAttachmentsList(decline.attachments)}
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-tab-panel" data-tab-panel="reversal">
                                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                                    <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                                        <h4 class="text-sm font-semibold text-gray-800">跌价准备转回</h4>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700">转回</span>
                                    </div>
                                    <div class="p-4 space-y-4">
                                        <div class="border border-gray-200 rounded-lg overflow-hidden">
                                            <table class="min-w-full divide-y divide-gray-200">
                                                <thead class="bg-gray-50">
                                                    <tr>
                                                        <th class="px-4 py-2 text-left text-xs font-semibold text-gray-500">计提日期</th>
                                                        <th class="px-4 py-2 text-left text-xs font-semibold text-gray-500">计提金额</th>
                                                        <th class="px-4 py-2 text-left text-xs font-semibold text-gray-500">已转回</th>
                                                        <th class="px-4 py-2 text-left text-xs font-semibold text-gray-500">可转回</th>
                                                        <th class="px-4 py-2 text-left text-xs font-semibold text-gray-500">说明</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-white">
                                                    ${reversalHistory || '<tr><td colspan="5" class="px-4 py-3 text-sm text-gray-500 text-center">暂无历史记录</td></tr>'}
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">拟转回金额</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm font-semibold text-emerald-600" value="${safeValue(data.priceReversal?.plan?.selectedAmount)}" readonly>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">附件说明</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(data.priceReversal?.plan?.attachmentsHint)}" readonly>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-semibold text-gray-700 mb-2">转回原因</label>
                                            <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(data.priceReversal?.plan?.reason)}</textarea>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-semibold text-gray-700 mb-2">附件清单</label>
                                            <ul class="space-y-1">
                                                ${renderAttachmentsList(data.priceReversal?.attachments)}
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-tab-panel" data-tab-panel="disclosure">
                                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                                    <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                                        <h4 class="text-sm font-semibold text-gray-800">披露方案</h4>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700">披露</span>
                                    </div>
                                    <div class="p-4 space-y-3">
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">披露类型</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(data.disclosure?.type)}" readonly>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">披露日期</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(data.disclosure?.date)}" readonly>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-gray-500 mb-1">披露范围</label>
                                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(data.disclosure?.scope)}" readonly>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-semibold text-gray-700 mb-2">披露标题</label>
                                            <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(data.disclosure?.title)}" readonly>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-semibold text-gray-700 mb-2">披露内容摘要</label>
                                            <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(data.disclosure?.content)}</textarea>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-semibold text-gray-700 mb-2">附件清单</label>
                                            <ul class="space-y-1">
                                                ${disclosureAttachments || '<li class="text-sm text-gray-500">暂无附件</li>'}
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderImpairmentChangeTemplate(data, task) {
            const asset = data.asset || {};
            const impairment = data.impairment || {};
            return `
                <div class="space-y-4">
                    <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                        <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-800">资产台账概览</h4>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-50 text-orange-600">减值变更</span>
                        </div>
                        <div class="p-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产编号</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm font-mono" value="${safeValue(asset.code)}" readonly>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产名称</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.name)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产类别</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.category)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">账面价值</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.bookValue)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">披露状态</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.disclosureStatus)}" readonly>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                        <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-800">减值管理</h4>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-700">减值</span>
                        </div>
                        <div class="p-4 space-y-3">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">原值</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(impairment.originalValue)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">累计摊销</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(impairment.accumulatedAmortization)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">现有账面价值</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(impairment.recoverableAmount)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">拟计提减值金额</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm font-semibold text-orange-600" value="${safeValue(impairment.proposedImpairment)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">评估日期</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(impairment.evaluationDate)}" readonly>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">减值原因</label>
                                <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="2" readonly>${safeValue(impairment.reason)}</textarea>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">减值说明</label>
                                <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(impairment.description)}</textarea>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">附件清单</label>
                                <ul class="space-y-1">
                                    ${renderAttachmentsList(impairment.attachments)}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderDeclineChangeTemplate(data, task) {
            const asset = data.asset || {};
            const decline = data.priceDecline || {};
            return `
                <div class="space-y-4">
                    <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                        <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-800">资产台账概览</h4>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-50 text-blue-600">跌价变更</span>
                        </div>
                        <div class="p-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产编号</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm font-mono" value="${safeValue(asset.code)}" readonly>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产名称</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.name)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产类别</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.category)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">账面价值</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.bookValue)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">披露状态</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.disclosureStatus)}" readonly>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                        <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-800">存货跌价准备</h4>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-700">跌价</span>
                        </div>
                        <div class="p-4 space-y-3">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">账面余额</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(decline.bookBalance)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">已计提跌价准备</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(decline.existingProvision)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">拟计提金额</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm font-semibold text-blue-600" value="${safeValue(decline.proposedProvision)}" readonly>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">跌价说明</label>
                                <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(decline.description)}</textarea>
                            </div>
                            <div class="bg-gray-50 border border-gray-200 rounded-lg p-3">
                                <span class="text-xs font-semibold text-gray-600">附件要求</span>
                                <p class="text-sm text-gray-700 mt-1">${safeValue(decline.attachmentTips)}</p>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">附件清单</label>
                                <ul class="space-y-1">
                                    ${renderAttachmentsList(decline.attachments)}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderReversalChangeTemplate(data, task) {
            const asset = data.asset || {};
            const reversalHistory = (data.priceReversal?.history || []).map(row => `
                <tr class="border-b last:border-b-0">
                    <td class="px-4 py-2 text-sm text-gray-500">${safeValue(row.date)}</td>
                    <td class="px-4 py-2 text-sm text-gray-900">${safeValue(row.amount)}</td>
                    <td class="px-4 py-2 text-sm text-gray-900">${safeValue(row.reversed)}</td>
                    <td class="px-4 py-2 text-sm text-gray-900">${safeValue(row.reversible)}</td>
                    <td class="px-4 py-2 text-sm text-gray-500">${safeValue(row.remark)}</td>
                </tr>
            `).join('');
            return `
                <div class="space-y-4">
                    <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                        <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-800">资产台账概览</h4>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-50 text-emerald-600">转回变更</span>
                        </div>
                        <div class="p-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产编号</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm font-mono" value="${safeValue(asset.code)}" readonly>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产名称</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.name)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产类别</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.category)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">账面价值</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.bookValue)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">披露状态</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.disclosureStatus)}" readonly>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                        <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-800">跌价准备转回</h4>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700">转回</span>
                        </div>
                        <div class="p-4 space-y-4">
                            <div class="border border-gray-200 rounded-lg overflow-hidden">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-2 text-left text-xs font-semibold text-gray-500">计提日期</th>
                                            <th class="px-4 py-2 text-left text-xs font-semibold text-gray-500">计提金额</th>
                                            <th class="px-4 py-2 text-left text-xs font-semibold text-gray-500">已转回</th>
                                            <th class="px-4 py-2 text-left text-xs font-semibold text-gray-500">可转回</th>
                                            <th class="px-4 py-2 text-left text-xs font-semibold text-gray-500">说明</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white">
                                        ${reversalHistory || '<tr><td colspan="5" class="px-4 py-3 text-sm text-gray-500 text-center">暂无历史记录</td></tr>'}
                                    </tbody>
                                </table>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">拟转回金额</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm font-semibold text-emerald-600" value="${safeValue(data.priceReversal?.plan?.selectedAmount)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">附件说明</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(data.priceReversal?.plan?.attachmentsHint)}" readonly>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">转回原因</label>
                                <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(data.priceReversal?.plan?.reason)}</textarea>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">附件清单</label>
                                <ul class="space-y-1">
                                    ${renderAttachmentsList(data.priceReversal?.plan?.attachments)}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderDisclosureChangeTemplate(data, task) {
            const asset = data.asset || {};
            const disclosureAttachments = (data.disclosure?.attachments || []).map(file => `
                <li class="flex items-center gap-2 text-sm text-gray-700">
                    <i class="fas fa-file-alt text-blue-500"></i>
                    <span>${safeValue(file.name)} <span class="text-xs text-gray-400">(${safeValue(file.size)})</span></span>
                </li>
            `).join('');
            return `
                <div class="space-y-4">
                    <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                        <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-800">资产台账概览</h4>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-50 text-purple-600">披露变更</span>
                        </div>
                        <div class="p-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产编号</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm font-mono" value="${safeValue(asset.code)}" readonly>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产名称</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.name)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">资产类别</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.category)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">账面价值</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.bookValue)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500 mb-1">披露状态</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.disclosureStatus)}" readonly>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                        <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-800">披露方案</h4>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700">披露</span>
                        </div>
                        <div class="p-4 space-y-3">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">披露类型</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(data.disclosure?.type)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">披露日期</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(data.disclosure?.date)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">披露范围</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(data.disclosure?.scope)}" readonly>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">披露标题</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(data.disclosure?.title)}" readonly>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">披露内容摘要</label>
                                <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(data.disclosure?.content)}</textarea>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">附件清单</label>
                                <ul class="space-y-1">
                                    ${disclosureAttachments || '<li class="text-sm text-gray-500">暂无附件</li>'}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderAssetDisposalTemplate(data, task) {
            const asset = data.asset || {};
            const plan = data.plan || {};
            const disposalDate = plan.targetDate ? plan.targetDate.replace(/-/g, '/') : '';
            const steps = Array.isArray(plan.steps) ? plan.steps : [];
            const attachments = (task && Array.isArray(task.attachments)) ? task.attachments : (Array.isArray(data.attachments) ? data.attachments : []);
            return `
                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm">
                    <div class="px-5 py-4 border-b bg-gray-50">
                        <h4 class="text-sm font-semibold text-gray-800">资产处置信息</h4>
                    </div>
                    <div class="p-6 space-y-6">
                        <div class="bg-gray-50 border border-gray-200 rounded-lg px-4 py-3">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-sm text-gray-700">
                                <div class="flex items-center gap-2">
                                    <span class="text-xs font-medium text-gray-500 tracking-wide">资产编号：</span>
                                    <span class="text-gray-900 font-medium">${safeValue(asset.code)}</span>
                                </div>
                                <div class="flex items-center gap-2 md:col-span-2">
                                    <span class="text-xs font-medium text-gray-500 tracking-wide whitespace-nowrap">资产名称：</span>
                                    <span class="text-gray-900 font-medium truncate" title="${safeValue(asset.name)}">${safeValue(asset.name)}</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-xs font-medium text-gray-500 tracking-wide">资产类型：</span>
                                    <span class="text-gray-900 font-medium">${safeValue(asset.category)}</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-xs font-medium text-gray-500 tracking-wide">项目编码：</span>
                                    <span class="text-gray-900 font-medium">${safeValue(asset.projectCode)}</span>
                                </div>
                                <div class="flex items-center gap-2 md:col-span-2">
                                    <span class="text-xs font-medium text-gray-500 tracking-wide">数据大小：</span>
                                    <span class="text-gray-900 font-medium">${safeValue(asset.size)}</span>
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                            <div class="bg-white border border-gray-200 rounded-lg px-4 py-3">
                                <p class="text-xs font-medium text-gray-500 mb-1">处置方式</p>
                                <p class="text-sm text-gray-900">${safeValue(plan.type)}</p>
                            </div>
                            <div class="bg-white border border-gray-200 rounded-lg px-4 py-3">
                                <p class="text-xs font-medium text-gray-500 mb-1">处置原因</p>
                                <p class="text-sm text-gray-900">${safeValue(plan.reason)}</p>
                            </div>
                            <div class="bg-white border border-gray-200 rounded-lg px-4 py-3">
                                <p class="text-xs font-medium text-gray-500 mb-1">预计处置日期</p>
                                <p class="text-sm text-gray-900">${safeValue(disposalDate)}</p>
                            </div>
                            <div class="bg-white border border-gray-200 rounded-lg px-4 py-3">
                                <p class="text-xs font-medium text-gray-500 mb-1">处置负责人</p>
                                <p class="text-sm text-gray-900">${safeValue(plan.responsibleTeam)}</p>
                            </div>
                        </div>

                        <div class="bg-white border border-gray-200 rounded-lg px-4 py-3">
                            <p class="text-xs font-medium text-gray-500 mb-2">处置说明</p>
                            <p class="text-sm text-gray-900 leading-6 whitespace-pre-line">${safeValue(plan.reason)}</p>
                        </div>

                        <div class="bg-white border border-gray-200 rounded-lg px-4 py-4">
                            <p class="text-xs font-medium text-gray-500 mb-2 flex items-center gap-2">
                                <i class="fas fa-paperclip text-gray-400"></i>
                                附件
                            </p>
                            ${attachments.length ? `
                                <ul class="space-y-2 text-sm text-gray-700">
                                    ${attachments.map(file => `
                                        <li class="flex items-center gap-2">
                                            <i class="fas fa-file-alt text-blue-500 text-sm"></i>
                                            <span>${safeValue(file.name)}${file.size ? `<span class="text-xs text-gray-400 ml-2">(${safeValue(file.size)})</span>` : ''}</span>
                                        </li>
                                    `).join('')}
                                </ul>
                            ` : `<p class="text-sm text-gray-500">暂无附件</p>`}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderResourceChangeTemplate(data, task) {
            const asset = data.asset || {};
            return `
                <div class="space-y-4">
                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm">
                        <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-800">资产基本信息</h4>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-50 text-indigo-600">自定义分级分类更新至资产</span>
                        </div>
                        <div class="p-4 space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">资产编号</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.code)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">资产名称</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.name)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">资产类型</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.type)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">${asset.type === '无形资产' ? '持有目的' : '数据大小'}</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${asset.type === '无形资产' ? safeValue(asset.purpose || '用于支撑业务运营和决策分析') : safeValue(asset.size)}" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm">
                        <div class="px-4 py-3 border-b bg-gray-50">
                            <h4 class="text-sm font-semibold text-gray-800">资源变动信息</h4>
                        </div>
                        <div class="p-4 space-y-4">
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">字段变更明细</label>
                                <div class="border border-gray-200 rounded-lg overflow-hidden overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <thead class="bg-gray-50">
                                            <tr>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">字段名</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">字段描述(字段英文名)</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">字段类型</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">字段长度</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">顺序</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">是否是主键</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">是否非空</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">原系统分类</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">原系统分级</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">自定义分类</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">自定义分级</th>
                                            </tr>
                                        </thead>
                                        <tbody class="bg-white divide-y divide-gray-200">
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">user_id</td>
                                                <td class="px-6 py-4 text-sm text-gray-500">用户唯一标识</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">VARCHAR</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">32</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">是</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">是</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">标识符</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-red-100 text-red-800 text-xs px-2 py-1 rounded">核心</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <button class="text-xs text-blue-600 hover:text-blue-800 border border-blue-300 rounded px-2 py-1 hover:bg-blue-50">+ 添加分类</button>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded">自定义分级</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">username</td>
                                                <td class="px-6 py-4 text-sm text-gray-500">用户名 (usern</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">VARCHAR</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">否</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">是</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">标识符</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-red-100 text-red-800 text-xs px-2 py-1 rounded">核心</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <button class="text-xs text-blue-600 hover:text-blue-800 border border-blue-300 rounded px-2 py-1 hover:bg-blue-50">+ 添加分类</button>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded">自定义分级</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">real_name</td>
                                                <td class="px-6 py-4 text-sm text-gray-500">真实姓名 (real</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">VARCHAR</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">100</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">3</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">否</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">否</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-green-100 text-green-800 text-xs px-2 py-1 rounded">个人信息</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded">重要</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <button class="text-xs text-blue-600 hover:text-blue-800 border border-blue-300 rounded px-2 py-1 hover:bg-blue-50">+ 添加分类</button>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded">自定义分级</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">email</td>
                                                <td class="px-6 py-4 text-sm text-gray-500">邮箱地址 (em</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">VARCHAR</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">100</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">4</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">否</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">否</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-blue-50 text-blue-600 text-xs px-2 py-1 rounded">-</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-blue-50 text-blue-600 text-xs px-2 py-1 rounded">一般</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <button class="text-xs text-blue-600 hover:text-blue-800 border border-blue-300 rounded px-2 py-1 hover:bg-blue-50">+ 添加分类</button>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded">自定义分级</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">phone</td>
                                                <td class="px-6 py-4 text-sm text-gray-500">手机号码 (phc</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">VARCHAR</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">20</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">5</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">否</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">否</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded">联系方式</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-blue-50 text-blue-600 text-xs px-2 py-1 rounded">一般</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-green-100 text-green-800 text-xs px-2 py-1 rounded">个人信息</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-blue-50 text-blue-600 text-xs px-2 py-1 rounded">一般</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">status</td>
                                                <td class="px-6 py-4 text-sm text-gray-500">用户状态 (1:启</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">TINYINT</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">6</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">否</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">是</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded">状态信息</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded">重要</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <button class="text-xs text-blue-600 hover:text-blue-800 border border-blue-300 rounded px-2 py-1 hover:bg-blue-50">+ 添加分类</button>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded">自定义分级</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">create_time</td>
                                                <td class="px-6 py-4 text-sm text-gray-500">创建时间 (crea</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">DATETIME</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">7</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">否</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">是</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-blue-50 text-blue-600 text-xs px-2 py-1 rounded">-</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-blue-50 text-blue-600 text-xs px-2 py-1 rounded">一般</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <button class="text-xs text-blue-600 hover:text-blue-800 border border-blue-300 rounded px-2 py-1 hover:bg-blue-50">+ 添加分类</button>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded">自定义分级</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">update_time</td>
                                                <td class="px-6 py-4 text-sm text-gray-500">更新时间 (upc</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">DATETIME</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">8</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">否</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">是</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-blue-50 text-blue-600 text-xs px-2 py-1 rounded">时间信息</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-blue-50 text-blue-600 text-xs px-2 py-1 rounded">一般</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <button class="text-xs text-blue-600 hover:text-blue-800 border border-blue-300 rounded px-2 py-1 hover:bg-blue-50">+ 添加分类</button>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded">自定义分级</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">变更说明</label>
                                <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(data.description)}</textarea>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderScanResourceUpdateTemplate(data, task) {
            const asset = data.asset || {};
            const scanReport = data.scanReport || {};
            return `
                <div class="space-y-4">
                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm">
                        <div class="px-4 py-3 border-b bg-gray-50 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-800">资产基本信息</h4>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-50 text-purple-600">扫描资源更新至资产</span>
                        </div>
                        <div class="p-4 space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">资产编号</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.code)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">资产名称</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.name)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">资产类型</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(asset.type)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">${asset.type === '无形资产' ? '持有目的' : '数据大小'}</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${asset.type === '无形资产' ? safeValue(asset.purpose || '用于支撑业务运营和决策分析') : safeValue(asset.size)}" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm">
                        <div class="px-4 py-3 border-b bg-gray-50">
                            <h4 class="text-sm font-semibold text-gray-800">扫描报告信息</h4>
                        </div>
                        <div class="p-4 space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">扫描报告ID</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(scanReport.id)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">扫描报告名称</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(scanReport.name)}" readonly>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">扫描时间</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm" value="${safeValue(scanReport.scanTime)}" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm">
                        <div class="px-4 py-3 border-b bg-gray-50">
                            <h4 class="text-sm font-semibold text-gray-800">资源变动信息</h4>
                        </div>
                        <div class="p-4 space-y-4">
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">字段变更明细</label>
                                <div class="border border-gray-200 rounded-lg overflow-hidden overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <thead class="bg-gray-50">
                                            <tr>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">字段名</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">字段描述(字段英文名)</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">字段类型</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">字段长度</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">顺序</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">是否是主键</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">是否非空</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">原系统分类</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">原系统分级</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">自定义分类</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">自定义分级</th>
                                            </tr>
                                        </thead>
                                        <tbody class="bg-white divide-y divide-gray-200">
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">order_id</td>
                                                <td class="px-6 py-4 text-sm text-gray-500">订单编号</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">VARCHAR</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">64</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">是</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">是</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">标识符</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-red-100 text-red-800 text-xs px-2 py-1 rounded">核心</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <button class="text-xs text-blue-600 hover:text-blue-800 border border-blue-300 rounded px-2 py-1 hover:bg-blue-50">+ 添加分类</button>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                    <span class="inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded">自定义分级</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-gray-700 mb-2">变更说明</label>
                                <textarea class="w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-sm leading-6" rows="3" readonly>${safeValue(data.description)}</textarea>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 为所有"查看详情"按钮绑定事件（在页面加载后）
        document.addEventListener('DOMContentLoaded', function() {
            // 为静态HTML中的查看详情按钮绑定事件
            const detailButtons = document.querySelectorAll('button');
            detailButtons.forEach(button => {
                if (button.textContent.includes('查看详情')) {
                    // 从onclick属性中提取任务ID
                    const onclickAttr = button.getAttribute('onclick');
                    if (onclickAttr) {
                        const match = onclickAttr.match(/showTaskDetail\((\d+)/);
                        if (match) {
                            const taskId = parseInt(match[1]);
                            button.setAttribute('onclick', `showTaskDetail(${taskId}, 'view')`);
                        }
                    }
                } else if (button.textContent.includes('处理任务')) {
                    // 从onclick属性中提取任务ID
                    const onclickAttr = button.getAttribute('onclick');
                    if (onclickAttr) {
                        const match = onclickAttr.match(/showTaskDetail\((\d+)/);
                        if (match) {
                            const taskId = parseInt(match[1]);
                            const task = taskData.find(t => t.id === taskId);
                            if (task) {
                                // 只有待处理状态的任务才显示"处理任务"按钮
                                if (task.status === 'pending') {
                                    button.setAttribute('onclick', `showTaskDetail(${taskId}, 'process')`);
                                } else {
                                    // 隐藏"处理任务"按钮
                                    button.style.display = 'none';
                                }
                            }
                        }
                    }
                }
            });
        });

        // 页面加载时默认显示我的任务页面
        window.addEventListener('DOMContentLoaded', function() {
            // 确保个人中心页面（我的任务）显示，其他隐藏
            document.getElementById('personal-center-page').classList.remove('hidden');
            document.getElementById('messages-center-page').classList.add('hidden');
            const myTasksPage = document.getElementById('my-tasks-page');
            if (myTasksPage) {
                myTasksPage.classList.add('hidden');
            }
            
            // 设置我的任务导航为激活状态
            updateNavigationState('personal');
        });

        function initializeAccountingChangeTabs(container) {
            const tabsRoot = container.querySelector('[data-accounting-tabs]');
            if (!tabsRoot) {
                return;
            }
            const buttons = tabsRoot.querySelectorAll('.modal-tab-button');
            const panels = tabsRoot.querySelectorAll('.modal-tab-panel');
            buttons.forEach(button => {
                button.addEventListener('click', () => {
                    const target = button.getAttribute('data-tab-target');
                    buttons.forEach(btn => btn.classList.remove('active'));
                    panels.forEach(panel => {
                        panel.classList.toggle('active', panel.getAttribute('data-tab-panel') === target);
                    });
                    button.classList.add('active');
                });
            });
        }
    </script>
</body>
</html>

