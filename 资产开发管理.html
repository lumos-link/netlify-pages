<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>资产开发管理 - 数据资产管理系统</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { 
      background: #ffffff;
      min-height: 100vh;
      position: relative;
    }
    .content-card { 
      background: rgba(255, 255, 255, 0.95); 
      backdrop-filter: blur(10px);
      border-radius: 1rem; 
      box-shadow: 0 4px 20px rgba(37, 99, 235, 0.15);
    }
    
    /* 响应式布局优化 */
    @media (max-width: 1024px) {
      .main-content {
        flex-direction: column;
      }
      .sidebar-left {
        width: 100%;
        margin-bottom: 1rem;
      }
      .content-right {
        width: 100%;
      }
    }
    
    @media (max-width: 768px) {
      .grid-cols-5 {
        grid-template-columns: repeat(2, 1fr);
      }
      .grid-cols-4 {
        grid-template-columns: repeat(2, 1fr);
      }
      .sticky {
        position: static;
      }
      .w-80 {
        width: 100%;
      }
    }
    
    /* 确保表格内容不会溢出 */
    .table-auto {
      table-layout: auto;
    }
    
    /* 优化滚动条样式 */
    .overflow-x-auto::-webkit-scrollbar {
      height: 8px;
    }
    
    .overflow-x-auto::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 4px;
    }
    
    .overflow-x-auto::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 4px;
    }
    
    .overflow-x-auto::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }
    .btn-primary {
      background: #2563eb;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-weight: 600;
      transition: all 0.2s;
    }
    .btn-primary:hover {
      background: #1d4ed8;
    }
    .btn-secondary {
      background: white;
      color: #2563eb;
      border: 1px solid #2563eb;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-weight: 600;
      transition: all 0.2s;
    }
    .btn-secondary:hover {
      background: #2563eb;
      color: white;
    }
    .tab-item {
      cursor: pointer;
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      transition: all 0.2s;
    }
    .tab-item:hover {
      background: rgba(37, 99, 235, 0.1);
    }
    .tab-item.active {
      background: #2563eb;
      color: white;
    }

    .submenu {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }
    .submenu.open {
      max-height: 500px;
    }
    .sidebar-collapsed {
      transform: translateX(-100%);
    }
    .sidebar-expanded {
      transform: translateX(0);
    }
    .main-content {
      transition: margin-left 0.3s ease;
    }
    .main-content.sidebar-collapsed {
      margin-left: 0;
    }
    .main-content.sidebar-expanded {
      margin-left: 15rem;
    }
    .status-active { @apply bg-green-100 text-green-800; }
    .status-pending { @apply bg-yellow-100 text-yellow-800; }
    .status-completed { @apply bg-blue-100 text-blue-800; }
    .status-failed { @apply bg-red-100 text-red-800; }
    .priority-high { @apply bg-red-100 text-red-800; }
    .priority-medium { @apply bg-yellow-100 text-yellow-800; }
    .priority-low { @apply bg-green-100 text-green-800; }
    
    /* 项目流程样式 */
    .flow-stage {
      transition: all 0.3s ease;
    }
    
    .flow-stage.active {
      background: #3b82f6;
      color: white;
      transform: scale(1.1);
    }
    
    .flow-stage.completed {
      background: #10b981;
      color: white;
    }
    
    .flow-stage.pending {
      background: #d1d5db;
      color: #6b7280;
    }
    
    .flow-connector {
      transition: all 0.3s ease;
    }
    
    .flow-connector.active {
      background: #3b82f6;
    }
    
    .flow-connector.completed {
      background: #10b981;
    }
    
    /* 模态框动画 */
    .modal-enter {
      animation: modalEnter 0.3s ease-out;
    }
    
    @keyframes modalEnter {
      from {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
      }
      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }
    
    /* 状态标签样式 */
    .status-research {
      @apply bg-purple-100 text-purple-800;
    }
    
    .status-approval {
      @apply bg-yellow-100 text-yellow-800;
    }
    
    .status-development {
      @apply bg-blue-100 text-blue-800;
    }
    
    .status-testing {
      @apply bg-indigo-100 text-indigo-800;
    }
    
    .status-production {
      @apply bg-green-100 text-green-800;
    }

    /* 新增状态标签样式 */
    .status-completed {
      @apply bg-green-100 text-green-800;
    }
    
    .status-approved {
      @apply bg-green-100 text-green-800;
    }
    
    .status-rejected {
      @apply bg-red-100 text-red-800;
    }
    
    /* 优先级标签样式 */
    .priority-high {
      @apply bg-red-100 text-red-800;
    }
    
    .priority-medium {
      @apply bg-yellow-100 text-yellow-800;
    }
    
    .priority-low {
      @apply bg-green-100 text-green-800;
    }
    
    /* 表格行高亮样式 */
    .bg-yellow-50 {
      background-color: #fefce8;
    }
    
    /* 进度条样式 */
    .progress-bar {
      transition: width 0.3s ease;
    }
    
    /* 模态框内容样式 */
    .modal-content {
      max-height: 80vh;
      overflow-y: auto;
    }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <!-- 顶部主导航栏 -->
  <header class="bg-gradient-to-r from-red-900 via-red-800 to-red-900 shadow flex items-center justify-between px-10 h-16 sticky top-0 z-20">
    <div class="flex items-center space-x-4">
      <img src="https://img1.imgtp.com/2023/07/21/0Qw6Qk4n.png" alt="LOGO" class="h-10 w-10 rounded-full border-2 border-red-400 shadow bg-white object-contain">
      <span class="text-xl font-bold text-white tracking-wide whitespace-nowrap">数据资产管理系统</span>
    </div>
    <nav class="flex-1 flex items-center justify-center space-x-8">
    </nav>
    <div class="flex items-center space-x-4">
      <a href="首页.html" class="text-red-100 hover:text-red-400 font-medium px-3 py-1 rounded border border-red-400 hover:bg-red-700 transition">
        <i class="fas fa-home mr-2"></i>返回首页
      </a>
      <div class="relative" id="user-dropdown">
        <div class="flex items-center space-x-2 cursor-pointer hover:bg-red-700 px-2 py-1 rounded-lg transition" onclick="toggleUserDropdown()">
          <img src="https://i.pravatar.cc/32?img=3" class="rounded-full w-8 h-8 border-2 border-red-200" alt="用户头像">
          <span class="text-red-100 text-sm">张三</span>
          <i class="fas fa-chevron-down text-xs text-red-300 transition-transform" id="dropdown-arrow"></i>
        </div>
        <div id="user-dropdown-menu" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-200 py-2 hidden z-50">
          <a href="个人中心.html" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 transition">
            <i class="fas fa-user-circle mr-3 text-red-500"></i>
            个人中心
          </a>
          <a href="#" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 transition">
            <i class="fas fa-cog mr-3 text-red-500"></i>
            系统管理
          </a>
          <div class="border-t border-gray-200 my-1"></div>
          <a href="#" class="flex items-center px-4 py-2 text-red-600 hover:bg-red-50 transition">
            <i class="fas fa-sign-out-alt mr-3"></i>
            退出
          </a>
        </div>
      </div>
    </div>
  </header>
  
  <!-- 可收起平台导航栏 -->
  <aside id="sidebar" class="fixed top-16 left-0 min-h-[calc(100vh-4rem)] w-60 bg-gradient-to-b from-red-900 to-red-800 border-r border-red-700 shadow-xl z-30 transition-transform duration-300">
    <div class="flex items-center justify-between px-4 py-3 border-b border-white border-opacity-20">
      <span class="text-lg font-bold text-red-100">平台导航</span>
    </div>
    <ul class="mt-4 space-y-2 px-4">
      <!-- 资源盘点登记 -->
      <li>
        <div class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 cursor-pointer" onclick="toggleSubMenu('inventory')">
          <div class="flex items-center gap-3">
            <i class="fas fa-clipboard-list"></i>
            <span>资源盘点登记</span>
          </div>
          <i class="fas fa-chevron-down text-xs transition-transform" id="inventory-arrow"></i>
        </div>
        <ul id="inventory-submenu" class="ml-6 mt-2 space-y-1 hidden">
          <li><a href="数据来源管理.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-database"></i> 数据来源管理</a></li>
          <li><a href="数据资源扫描.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-database"></i> 数据资源扫描</a></li>
          <li><a href="数据资源.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-database"></i> 数据资源盘点</a></li>
          <li><a href="资产属性管理.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-cogs"></i> 资产属性管理</a></li>
          <li><a href="资产标签管理.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-tag"></i> 资产标签管理</a></li>
          <li><a href="资产目录管理.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-sitemap"></i> 资产目录管理</a></li>
          <li><a href="数据分类管理.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-database"></i> 数据分类管理</a></li>
          <li><a href="数据分级管理.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-layer-group"></i> 数据分级管理</a></li>
        </ul>
      </li>
      
      <!-- 资产确权与管理 -->
      <li>
        <div class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 cursor-pointer" onclick="toggleSubMenu('rights')">
          <div class="flex items-center gap-3">
            <i class="fas fa-gavel"></i>
            <span>资产确权与管理</span>
          </div>
          <i class="fas fa-chevron-down text-xs transition-transform" id="rights-arrow"></i>
        </div>
        <ul id="rights-submenu" class="ml-6 mt-2 space-y-1 hidden">
          <li><a href="内部申请记录.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-user-shield"></i> 内部申请记录</a></li>
          <li><a href="授权链路记录.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-link"></i> 授权链路记录</a></li>
          <li><a href="权属转移记录.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-exchange-alt"></i> 权属转移记录</a></li>
          <li><a href="权属证明记录.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-certificate"></i> 权属证明记录</a></li>
        </ul>
      </li>
      
      <!-- 资产开发管理 -->
      <li>
        <div class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 cursor-pointer bg-red-700" onclick="toggleSubMenu('development')">
          <div class="flex items-center gap-3">
            <i class="fas fa-code"></i>
            <span>资产开发管理</span>
          </div>
          <i class="fas fa-chevron-down text-xs transition-transform" id="development-arrow" style="transform: rotate(180deg);"></i>
        </div>
        <ul id="development-submenu" class="ml-6 mt-2 space-y-1">
          <li><a href="资产开发管理.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm bg-red-700"><i class="fas fa-cogs"></i> 资产开发管理</a></li>
          <li><a href="资产内容管理.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100 text-sm"><i class="fas fa-cogs"></i> 资产内容管理</a></li>
        </ul>
      </li>
      
      <!-- 资产会计核算 -->
            <li>
                <a href="资产会计核算.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100">
                    <i class="fas fa-calculator"></i>
                    <span>资产会计核算</span>
                </a>
            </li>
      
      <!-- API管理 -->
      <li>
        <a href="API管理页面.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-700 text-red-100">
          <i class="fas fa-plug"></i>
          <span>API管理</span>
        </a>
      </li>
    </ul>
  </aside>
  
  <!-- 展开按钮 -->
  <button id="sidebar-toggle" onclick="toggleSidebar()" class="fixed top-20 left-64 z-40 bg-black bg-opacity-50 backdrop-blur-sm text-white rounded-full p-2 shadow-lg hover:bg-black hover:bg-opacity-70 focus:outline-none transition"><i class="fas fa-chevron-left"></i></button>
  
  <!-- 主体内容区 -->
  <main class="flex-1 w-full max-w-7xl mx-auto py-8 px-4 ml-60">

    <!-- 项目流程展示 -->
    <div class="content-card p-6 mb-6">
      <h3 class="text-lg font-bold text-gray-800 mb-6">项目开发流程</h3>
      
      <div class="overflow-x-auto pb-4">
        <div class="flex items-start justify-start space-x-6 min-w-max px-4">
          <!-- 研究环节（大环节） -->
          <div class="flex flex-col items-center">
            <!-- 大环节标题 -->
            <div class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md mb-4 text-sm font-bold whitespace-nowrap">
              <i class="fas fa-clipboard-check mr-2"></i>研究环节
            </div>
            <!-- 小环节容器 -->
            <div class="bg-blue-50 border-2 border-blue-200 rounded-lg p-5 min-w-max">
              <div class="flex items-center space-x-6">
                <div class="flex flex-col items-center">
                  <div id="stage-feasibility" class="w-16 h-16 bg-white border-2 border-blue-400 rounded-full flex items-center justify-center text-blue-600 font-bold text-xs cursor-pointer hover:shadow-lg transition-all" onclick="showStageInfo('可行性研究')">
                    <i class="fas fa-search text-xl"></i>
                  </div>
                  <div class="text-xs text-gray-700 mt-3 text-center whitespace-nowrap font-medium">可行性研究</div>
                </div>
                <div class="w-10 h-0.5 bg-blue-300"></div>
                <div class="flex flex-col items-center">
                  <div id="stage-approval" class="w-16 h-16 bg-white border-2 border-blue-400 rounded-full flex items-center justify-center text-blue-600 font-bold text-xs cursor-pointer hover:shadow-lg transition-all" onclick="showStageInfo('立项')">
                    <i class="fas fa-flag text-xl"></i>
                  </div>
                  <div class="text-xs text-gray-700 mt-3 text-center whitespace-nowrap font-medium">立项</div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 连接箭头 -->
          <div class="flex items-center mt-20">
            <i class="fas fa-arrow-right text-3xl text-blue-500 mx-2"></i>
          </div>
          
          <!-- 开发环节（大环节） -->
          <div class="flex flex-col items-center">
            <!-- 大环节标题 -->
            <div class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md mb-4 text-sm font-bold whitespace-nowrap">
              <i class="fas fa-code mr-2"></i>开发环节
            </div>
            <!-- 小环节容器 -->
            <div class="bg-blue-50 border-2 border-blue-200 rounded-lg p-5 min-w-max">
              <div class="flex items-center space-x-5">
                <div class="flex flex-col items-center">
                  <div id="stage-requirement" class="w-16 h-16 bg-white border-2 border-blue-400 rounded-full flex items-center justify-center text-blue-600 font-bold text-xs cursor-pointer hover:shadow-lg transition-all" onclick="showStageInfo('需求确认')">
                    <i class="fas fa-tasks text-xl"></i>
                  </div>
                  <div class="text-xs text-gray-700 mt-3 text-center whitespace-nowrap font-medium">需求确认</div>
                </div>
                <div class="w-8 h-0.5 bg-blue-300"></div>
                <div class="flex flex-col items-center">
                  <div id="stage-design" class="w-16 h-16 bg-white border-2 border-blue-400 rounded-full flex items-center justify-center text-blue-600 font-bold text-xs cursor-pointer hover:shadow-lg transition-all" onclick="showStageInfo('详细设计')">
                    <i class="fas fa-drafting-compass text-xl"></i>
                  </div>
                  <div class="text-xs text-gray-700 mt-3 text-center whitespace-nowrap font-medium">详细设计</div>
                </div>
                <div class="w-8 h-0.5 bg-blue-300"></div>
                <div class="flex flex-col items-center">
                  <div id="stage-development" class="w-16 h-16 bg-white border-2 border-blue-400 rounded-full flex items-center justify-center text-blue-600 font-bold text-xs cursor-pointer hover:shadow-lg transition-all" onclick="showStageInfo('开发')">
                    <i class="fas fa-laptop-code text-xl"></i>
                  </div>
                  <div class="text-xs text-gray-700 mt-3 text-center whitespace-nowrap font-medium">开发</div>
                </div>
                <div class="w-8 h-0.5 bg-blue-300"></div>
                <div class="flex flex-col items-center">
                  <div id="stage-acceptance" class="w-16 h-16 bg-white border-2 border-blue-400 rounded-full flex items-center justify-center text-blue-600 font-bold text-xs cursor-pointer hover:shadow-lg transition-all" onclick="showStageInfo('验收')">
                    <i class="fas fa-check-circle text-xl"></i>
                  </div>
                  <div class="text-xs text-gray-700 mt-3 text-center whitespace-nowrap font-medium">验收</div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 连接箭头 -->
          <div class="flex items-center mt-20">
            <i class="fas fa-arrow-right text-3xl text-blue-500 mx-2"></i>
          </div>
          
          <!-- 资产形成环节（大环节） -->
          <div class="flex flex-col items-center">
            <!-- 大环节标题 -->
            <div class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md mb-4 text-sm font-bold whitespace-nowrap">
              <i class="fas fa-boxes mr-2"></i>资产形成环节
            </div>
            <!-- 小环节容器 -->
            <div class="bg-blue-50 border-2 border-blue-200 rounded-lg p-5 min-w-max">
              <div class="flex flex-col items-center">
                <div id="stage-asset" class="w-16 h-16 bg-white border-2 border-blue-400 rounded-full flex items-center justify-center text-blue-600 font-bold text-xs cursor-pointer hover:shadow-lg transition-all" onclick="showStageInfo('资产形成')">
                  <i class="fas fa-database text-xl"></i>
                </div>
                <div class="text-xs text-gray-700 mt-3 text-center whitespace-nowrap font-medium">资产形成</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>



    <!-- 功能模块标签页 -->
    <div class="content-card">
      <div class="border-b border-gray-200">
        <nav class="flex space-x-8 px-6" aria-label="Tabs">
          <button onclick="switchTab('initiator')" id="tab-initiator" class="tab-button active py-4 px-1 border-b-2 border-blue-500 font-medium text-sm text-blue-600">
            <i class="fas fa-user-plus mr-2"></i>项目发起人视角
          </button>

          <button onclick="switchTab('approver')" id="tab-approver" class="tab-button py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700">
            <i class="fas fa-gavel mr-2"></i>审批人员视角
          </button>
        </nav>
      </div>

      <!-- 项目发起人视角 -->
      <div id="initiator-content" class="tab-content p-6">
        <div class="mb-6 flex justify-between items-center">
          <h3 class="text-lg font-medium text-gray-900">项目发起管理</h3>
          <button onclick="showNewProjectModal()" class="btn-primary">
            <i class="fas fa-plus mr-2"></i>新建项目
          </button>
        </div>

        <!-- 我的项目列表 -->
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">项目名称</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">负责人</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">创建时间</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">当前环节</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <tr data-project-id="project1">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">数据质量管理系统</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">张三</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-15</td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">资产形成环节</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">已完成</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                  <button onclick="viewProject('project1')" class="text-blue-600 hover:text-blue-900">查看详情</button>
                </td>
              </tr>
              <tr data-project-id="project2">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">移动端数据展示</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">李四</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-10</td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800">可行性研究环节</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">待审批</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                  <button onclick="viewProject('project2')" class="text-blue-600 hover:text-blue-900">查看详情</button>
                </td>
              </tr>
              <tr data-project-id="project3">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">数据安全防护系统</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">王五</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-12</td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">开发环节</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800">草稿</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                  <button onclick="editProject('project3')" class="text-green-600 hover:text-green-900">编辑内容</button>
                </td>
              </tr>
              <tr data-project-id="project4">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">智能数据分析平台</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">赵六</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-08</td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">研究环节</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">已驳回</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                  <button onclick="editProject('project4')" class="text-green-600 hover:text-green-900">编辑内容</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>






            <tbody class="bg-white divide-y divide-gray-200">

              

            </tbody>
          </table>
        </div>
      </div>

      <!-- 审批人员视角 -->
      <div id="approver-content" class="tab-content hidden p-6">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-lg font-medium text-gray-900">审批任务管理</h3>
        </div>

        <!-- 审批任务列表 -->
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">项目名称</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">负责人</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">创建时间</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">当前环节</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <tr class="bg-yellow-50">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">移动端数据展示</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">李四</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-20</td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="status-pending px-2 py-1 text-xs font-semibold rounded-full">可行性研究环节</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">待审批</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                  <button onclick="reviewProject('project2')" class="text-blue-600 hover:text-blue-900">审核</button>
                </td>
              </tr>
              <tr>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">数据质量管理系统</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">张三</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-22</td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="status-pending px-2 py-1 text-xs font-semibold rounded-full">开发环节</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">已通过</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                  <button onclick="viewDetails('project1')" class="text-green-600 hover:text-green-900">查看详情</button>
                </td>
              </tr>
              <tr>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">客户关系管理系统</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">王五</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-18</td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="status-pending px-2 py-1 text-xs font-semibold rounded-full">资产形成环节</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">已驳回</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                  <button onclick="viewDetails('project3')" class="text-green-600 hover:text-green-900">查看详情</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <!-- 项目详情模态框 -->
    <div id="projectViewModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
      <div class="relative top-20 mx-auto p-5 border w-11/12 max-w-4xl shadow-lg rounded-md bg-white">
        <div class="mt-3">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-medium text-gray-900">项目详情</h3>
            <button onclick="closeProjectViewModal()" class="text-gray-400 hover:text-gray-600">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          
          <!-- 页签导航 -->
          <div class="border-b border-gray-200">
            <nav class="-mb-px flex space-x-6 overflow-x-auto" aria-label="Tabs">
              <button onclick="showTab('basic')" class="tab-button border-b-2 border-blue-500 py-2 px-1 text-sm font-medium text-blue-600 whitespace-nowrap" data-tab="basic">
                项目基本信息
              </button>
              <button onclick="showTab('research')" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="research">
                预研环节
              </button>
              <button onclick="showTab('approval')" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="approval">
                立项环节
              </button>
              <button onclick="showTab('decision')" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="decision">
                决策环节
              </button>
              <button onclick="showTab('requirement')" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="requirement">
                需求确认环节
              </button>
              <button onclick="showTab('design')" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="design">
                详细设计环节
              </button>
              <button onclick="showTab('development')" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="development">
                开发环节
              </button>
              <button onclick="showTab('testing')" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="testing">
                测试环节
              </button>
              <button onclick="showTab('deployment')" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="deployment">
                上线环节
              </button>
              <button onclick="showAcceptanceTab()" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="acceptance">
                验收环节
              </button>
              <button onclick="showTab('asset-formation')" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="asset-formation">
                资产形成
              </button>

            </nav>
          </div>
          
          <!-- 页签内容 -->
          <div class="mt-6">
            <!-- 项目基本信息页签 -->
            <div id="basic-tab" class="tab-content">
              <div class="grid grid-cols-2 gap-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">项目名称</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md" id="viewProjectName"></div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">负责人</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md" id="viewProjectManager"></div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">项目类型</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md" id="viewProjectType">信息类</div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">立项类型</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md" id="viewEstablishmentType">二开自研</div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">资产类型</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md" id="viewAssetType">数据资产</div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">创建时间</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md" id="viewProjectCreateTime"></div>
                </div>
                <div class="col-span-2">
                  <label class="block text-sm font-medium text-gray-700 mb-2">资产描述</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[80px]" id="viewAssetDescription"></div>
                </div>
              </div>
              
              <!-- 财务汇总按钮 -->
              <div class="col-span-2 mt-6 pt-6 border-t border-gray-200">
                <div class="flex justify-center">
                  <button onclick="showFinancialSummary()" class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-medium rounded-lg shadow-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-200 transform hover:scale-105">
                    <i class="fas fa-chart-pie mr-2"></i>
                    每季度财务汇总
                  </button>
                </div>
                <div class="text-center mt-2">
                  <p class="text-xs text-gray-500">点击查看项目的季度财务汇总报告</p>
                </div>
              </div>
            </div>
            
            <!-- 预研环节页签 -->
            <div id="research-tab" class="tab-content hidden">
              <div class="space-y-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">预研结论</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[100px]" id="viewResearchConclusion">
                    项目技术可行，建议立项开发。通过预研分析，确认了技术架构的合理性，预计开发周期6个月。
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">预研附件</label>
                  <div class="space-y-2">
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>技术可行性分析报告.pdf</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>市场调研报告.docx</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>成本估算表.xlsx</span>
                    </div>
                  </div>
                </div>
                
                <!-- 审批历史 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">审批历史</label>
                  <div class="space-y-3" id="viewApprovalHistory">
                    <!-- 审批历史内容将通过JavaScript动态加载 -->
                    <div class="text-sm text-gray-500 text-center py-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                      <i class="fas fa-info-circle text-yellow-600 mr-2"></i>
                      正在加载审批历史...
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- 立项环节页签 -->
            <div id="approval-tab" class="tab-content hidden">
              <div class="space-y-6">
                <!-- 资产基本信息 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">资产基本信息</label>
                  <div class="space-y-4">
                    <div class="text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded-md">
                      说明：请填写数据资产的基本信息，包括名称、持有目的、所属部门、业务归属、所属行业和详细描述。
                    </div>
                    
                    <!-- 基本信息表单 -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <!-- 资产名称 -->
                      <div class="col-span-2">
                        <label for="asset-name" class="block text-sm font-medium text-gray-700 mb-1">资产名称 *</label>
                        <input type="text" id="asset-name" name="asset-name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="请输入数据资产名称" required>
                      </div>
                      
                      <!-- 持有目的 -->
                      <div>
                        <label for="holding-purpose" class="block text-sm font-medium text-gray-700 mb-1">持有目的 *</label>
                        <select id="holding-purpose" name="holding-purpose" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                          <option value="">请选择持有目的</option>
                          <option value="业务运营">业务运营</option>
                          <option value="决策支持">决策支持</option>
                          <option value="风险管控">风险管控</option>
                          <option value="客户服务">客户服务</option>
                          <option value="产品开发">产品开发</option>
                          <option value="合规监管">合规监管</option>
                          <option value="其他">其他</option>
                        </select>
                      </div>
                      
                      <!-- 所属部门 -->
                      <div>
                        <label for="department" class="block text-sm font-medium text-gray-700 mb-1">所属部门 *</label>
                        <select id="department" name="department" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                          <option value="">请选择所属部门</option>
                          <option value="信息技术部">信息技术部</option>
                          <option value="数据管理部">数据管理部</option>
                          <option value="业务发展部">业务发展部</option>
                          <option value="风险管理部">风险管理部</option>
                          <option value="客户服务部">客户服务部</option>
                          <option value="产品研发部">产品研发部</option>
                          <option value="合规管理部">合规管理部</option>
                          <option value="其他">其他</option>
                        </select>
                      </div>
                      
                      <!-- 业务归属 -->
                      <div>
                        <label for="business-ownership" class="block text-sm font-medium text-gray-700 mb-1">业务归属 *</label>
                        <select id="business-ownership" name="business-ownership" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                          <option value="">请选择业务归属</option>
                          <option value="零售业务">零售业务</option>
                          <option value="公司业务">公司业务</option>
                          <option value="投资银行业务">投资银行业务</option>
                          <option value="资产管理业务">资产管理业务</option>
                          <option value="金融市场业务">金融市场业务</option>
                          <option value="风险管理">风险管理</option>
                          <option value="运营管理">运营管理</option>
                          <option value="其他">其他</option>
                        </select>
                      </div>
                      
                      <!-- 所属行业 -->
                      <div>
                        <label for="industry" class="block text-sm font-medium text-gray-700 mb-1">所属行业 *</label>
                        <select id="industry" name="industry" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                          <option value="">请选择所属行业</option>
                          <option value="银行业">银行业</option>
                          <option value="保险业">保险业</option>
                          <option value="证券业">证券业</option>
                          <option value="基金业">基金业</option>
                          <option value="信托业">信托业</option>
                          <option value="租赁业">租赁业</option>
                          <option value="金融科技">金融科技</option>
                          <option value="其他">其他</option>
                        </select>
                      </div>
                      
                      <!-- 详细描述 -->
                      <div class="col-span-2">
                        <label for="description" class="block text-sm font-medium text-gray-700 mb-1">详细描述 *</label>
                        <textarea id="description" name="description" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="请详细描述数据资产的内容、用途、价值等信息" required></textarea>
                        <p class="text-xs text-gray-500 mt-1">请详细描述数据资产的内容、用途、价值、数据来源、更新频率等信息</p>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- 数据资源权属证明文件审批 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">数据资源权属证明文件审批</label>
                  <div class="space-y-3">
                    <div class="text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded-md">
                      说明：数据资源内容的权属证明文件需要在此提及审批，确保数据资源的使用权属清晰明确。
                    </div>
                    
                    <!-- 文件上传区域 -->
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                      <div class="space-y-4">
                        <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                          <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        <div class="text-sm text-gray-600">
                          <label for="file-upload" class="relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500">
                            <span>上传权属证明文件</span>
                            <input id="file-upload" name="file-upload" type="file" class="sr-only" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" multiple>
                          </label>
                          <p class="pl-1">或拖拽文件到此处</p>
                        </div>
                        <p class="text-xs text-gray-500">支持 PDF, DOC, DOCX, JPG, PNG 格式，最大 10MB</p>
                      </div>
                    </div>
                    
                    <!-- 已上传文件列表 -->
                    <div class="space-y-2">
                      <h4 class="text-sm font-medium text-gray-700">已上传文件</h4>
                      <div class="space-y-2">
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-md">
                          <div class="flex items-center space-x-3">
                            <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span class="text-sm text-gray-700">数据资源权属证明书.pdf</span>
                          </div>
                          <button class="text-red-500 hover:text-red-700">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- 预算信息填写 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">预算信息填写</label>
                  <div class="space-y-3">
                    <div class="text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded-md">
                      说明：业务人员需要填写详细的预算信息，包括直接费、间接费等各项费用明细。
                    </div>
                    
                    <!-- 预算表格 -->
                    <div class="overflow-x-auto border border-gray-200 rounded-lg">
                      <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                          <tr>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">序号</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">费用名称</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">取费说明</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">预算费用(单位:元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">备注</th>
                          </tr>
                          <tr>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"></th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"></th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"></th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                              <div class="grid grid-cols-3 gap-1">
                                <span class="text-xs">2024年</span>
                                <span class="text-xs">2025年</span>
                                <span class="text-xs">合计</span>
                              </div>
                            </th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"></th>
                          </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                          <!-- 直接费 -->
                          <tr class="bg-orange-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">I</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">直接费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 人员费 -->
                          <tr class="bg-orange-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">1</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">人员费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 项目在职研发人员费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(1)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">项目在职研发人员费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 劳务费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(2)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">劳务费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 材料费 -->
                          <tr class="bg-orange-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">2</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">材料费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 原材料 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(1)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">原材料</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 辅助材料 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(2)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">辅助材料</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 低值易耗品 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(3)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">低值易耗品</td>
                            <td class="px-3 py-2 text-sm text-gray-500">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-green-300 rounded bg-green-50" placeholder="请输入取费说明">
                            </td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 其他材料费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(4)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">其他材料费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 设备费 -->
                          <tr class="bg-orange-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">3</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">设备费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 仪器、设备购置费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(1)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">仪器、设备购置费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 试制仪器、设备费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(2)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">试制仪器、设备费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 仪器、设备升级改造费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(3)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">仪器、设备升级改造费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 仪器、设备租赁费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(4)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">仪器、设备租赁费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 测试化验加工费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">4</td>
                            <td class="px-3 py-2 text-sm text-gray-700">测试化验加工费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 燃料动力费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">5</td>
                            <td class="px-3 py-2 text-sm text-gray-700">燃料动力费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 新产品设计费、新工艺规程指定费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">6</td>
                            <td class="px-3 py-2 text-sm text-gray-700">新产品设计费、新工艺规程指定费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 现场实施费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">7</td>
                            <td class="px-3 py-2 text-sm text-gray-700">现场实施费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 建设工程费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(1)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">建设工程费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 维修改造工程费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(2)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">维修改造工程费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 差旅费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">8</td>
                            <td class="px-3 py-2 text-sm text-gray-700">差旅费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 专家咨询费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">9</td>
                            <td class="px-3 py-2 text-sm text-gray-700">专家咨询费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 会议费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">10</td>
                            <td class="px-3 py-2 text-sm text-gray-700">会议费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 国际合作与交流费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">11</td>
                            <td class="px-3 py-2 text-sm text-gray-700">国际合作与交流费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 出版/文献/信息传播/知识产权事务费等 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">12</td>
                            <td class="px-3 py-2 text-sm text-gray-700">出版/文献/信息传播/知识产权事务费等</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 出版费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(1)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">出版费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 资料费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(2)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">资料费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 专用软件或数据购买费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(3)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">专用软件或数据购买费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 文献检索费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(4)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">文献检索费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 专业通讯费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(5)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">专业通讯费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 专利申请及知识产权事务费 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">(6)</td>
                            <td class="px-3 py-2 text-sm text-gray-700">专利申请及知识产权事务费</td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 间接费 -->
                          <tr class="bg-green-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">二</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">间接费</td>
                            <td class="px-3 py-2 text-sm text-gray-500">项目直接费—设备购置费-现场实施费</td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                          
                          <!-- 自主研发项目/内委项目/外委项目 -->
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">1</td>
                            <td class="px-3 py-2 text-sm text-gray-700">自主研发项目/内委项目/外委项目</td>
                            <td class="px-3 py-2 text-sm text-gray-500">项目直接费—设备购置费-现场实施费</td>
                            <td class="px-3 py-2">
                              <div class="grid grid-cols-3 gap-1">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                                <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-500"></td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    
                    <div class="flex justify-end space-x-2">
                      <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700">
                        保存预算
                      </button>
                      <button class="px-3 py-2 text-sm bg-gray-600 text-white rounded-md hover:bg-gray-700">
                        导出预算表
                      </button>
                    </div>
                  </div>
                </div>

                <!-- 立项结论 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">立项结论</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[100px]">
                    项目已通过立项审批，获得开发资金支持，预计投入200万元。
                  </div>
                </div>

                <!-- 立项附件 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">立项附件</label>
                  <div class="space-y-2">
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>立项申请书.pdf</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>预算审批表.xlsx</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- 开发环节页签 -->
            <div id="development-tab" class="tab-content hidden">
              <div class="space-y-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">开发结论</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[100px]">
                    核心功能开发完成，正在进行功能测试和性能优化。
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">开发附件</label>
                  <div class="space-y-2">
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>系统架构设计文档.pdf</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>数据库设计文档.pdf</span>
                    </div>
                  </div>
                </div>

                <!-- 开发阶段料工费管理 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">料工费管理</label>
                  <div class="space-y-3">
                    <div class="text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded-md">
                      说明：开发阶段的材料费用、工时、服务费等成本管理，填写后系统自动计算分摊比例。
                    </div>
                    
                    <!-- 料工费表格 -->
                    <div class="overflow-x-auto border border-gray-200 rounded-lg">
                      <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                          <tr>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">序号</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">费用类型</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">费用名称</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单位</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单价(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">小计(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">分摊比例(%)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">分摊金额(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">备注</th>
                          </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                          <!-- 材料费用 -->
                          <tr class="bg-blue-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">1</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">材料费用</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入材料名称">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>个</option>
                                <option>套</option>
                                <option>台</option>
                                <option>件</option>
                                <option>米</option>
                                <option>千克</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                          
                          <!-- 工时 -->
                          <tr class="bg-green-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">2</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">工时</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入工作内容">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>小时</option>
                                <option>天</option>
                                <option>月</option>
                                <option>人天</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                          
                          <!-- 服务费 -->
                          <tr class="bg-yellow-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">3</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">服务费</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入服务内容">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>次</option>
                                <option>项</option>
                                <option>月</option>
                                <option>年</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    
                    <!-- 料工费汇总 -->
                    <div class="grid grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg">
                      <div class="text-center">
                        <div class="text-lg font-semibold text-blue-600" id="dev-material-total">0.00</div>
                        <div class="text-sm text-gray-600">材料费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-green-600" id="dev-labor-total">0.00</div>
                        <div class="text-sm text-gray-600">工时费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-yellow-600" id="dev-service-total">0.00</div>
                        <div class="text-sm text-gray-600">服务费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-purple-600" id="dev-total-cost">0.00</div>
                        <div class="text-sm text-gray-600">总费用</div>
                      </div>
                    </div>
                    
                    <!-- 操作按钮 -->
                    <div class="flex justify-between">
                      <div class="flex space-x-2">
                        <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700" onclick="addDevCostRow()">
                          添加费用项
                        </button>
                        <button class="px-3 py-2 text-sm bg-gray-600 text-white rounded-md hover:bg-gray-700" onclick="calculateDevCosts()">
                          计算费用
                        </button>
                      </div>
                      <div class="flex space-x-2">
                        <button class="px-3 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700" onclick="saveDevCosts()">
                          保存费用
                        </button>
                        <button class="px-3 py-2 text-sm bg-purple-600 text-white rounded-md hover:bg-purple-700" onclick="exportDevCosts()">
                          导出费用
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- 测试环节页签 -->
            <div id="testing-tab" class="tab-content hidden">
              <div class="space-y-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">测试结论</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[100px]">
                    功能测试通过，性能测试达标，准备进入部署阶段。
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">测试附件</label>
                  <div class="space-y-2">
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>测试计划文档.pdf</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>测试报告.pdf</span>
                    </div>
                  </div>
                </div>

                <!-- 测试阶段料工费管理 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">料工费管理</label>
                  <div class="space-y-3">
                    <div class="text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded-md">
                      说明：测试阶段的材料费用、工时、服务费等成本管理，填写后系统自动计算分摊比例。
                    </div>
                    
                    <!-- 料工费表格 -->
                    <div class="overflow-x-auto border border-gray-200 rounded-lg">
                      <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                          <tr>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">序号</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">费用类型</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">费用名称</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单位</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单价(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">小计(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">分摊比例(%)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">分摊金额(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">备注</th>
                          </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                          <!-- 材料费用 -->
                          <tr class="bg-blue-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">1</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">材料费用</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入材料名称">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>个</option>
                                <option>套</option>
                                <option>台</option>
                                <option>件</option>
                                <option>米</option>
                                <option>千克</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                          
                          <!-- 工时 -->
                          <tr class="bg-green-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">2</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">工时</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入工作内容">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>小时</option>
                                <option>天</option>
                                <option>月</option>
                                <option>人天</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                          
                          <!-- 服务费 -->
                          <tr class="bg-yellow-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">3</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">服务费</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入服务内容">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>次</option>
                                <option>项</option>
                                <option>月</option>
                                <option>年</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    
                    <!-- 料工费汇总 -->
                    <div class="grid grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg">
                      <div class="text-center">
                        <div class="text-lg font-semibold text-blue-600" id="test-material-total">0.00</div>
                        <div class="text-sm text-gray-600">材料费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-green-600" id="test-labor-total">0.00</div>
                        <div class="text-sm text-gray-600">工时费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-yellow-600" id="test-service-total">0.00</div>
                        <div class="text-sm text-gray-600">服务费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-purple-600" id="test-total-cost">0.00</div>
                        <div class="text-sm text-gray-600">总费用</div>
                      </div>
                    </div>
                    
                    <!-- 操作按钮 -->
                    <div class="flex justify-between">
                      <div class="flex space-x-2">
                        <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700" onclick="addTestCostRow()">
                          添加费用项
                        </button>
                        <button class="px-3 py-2 text-sm bg-gray-600 text-white rounded-md hover:bg-gray-700" onclick="calculateTestCosts()">
                          计算费用
                        </button>
                      </div>
                      <div class="flex space-x-2">
                        <button class="px-3 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700" onclick="saveTestCosts()">
                          保存费用
                        </button>
                        <button class="px-3 py-2 text-sm bg-purple-600 text-white rounded-md hover:bg-purple-700" onclick="exportTestCosts()">
                          导出费用
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- 部署环节页签 -->
            <div id="deployment-tab" class="tab-content hidden">
              <div class="space-y-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">上线结论</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[100px]">
                    系统已成功上线到生产环境，运行稳定，用户反馈良好。
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">上线附件</label>
                  <div class="space-y-2">
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>上线方案文档.pdf</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>运维手册.pdf</span>
                    </div>
                  </div>
                </div>

                <!-- 上线阶段料工费管理 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">料工费管理</label>
                  <div class="space-y-3">
                    <div class="text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded-md">
                      说明：上线阶段的材料费用、工时、服务费等成本管理，填写后系统自动计算分摊比例。
                    </div>
                    
                    <!-- 料工费表格 -->
                    <div class="overflow-x-auto border border-gray-200 rounded-lg">
                      <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                          <tr>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">序号</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">费用类型</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">费用名称</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单位</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单价(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">小计(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">分摊比例(%)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">分摊金额(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">备注</th>
                          </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                          <!-- 材料费用 -->
                          <tr class="bg-blue-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">1</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">材料费用</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入材料名称">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>个</option>
                                <option>套</option>
                                <option>台</option>
                                <option>件</option>
                                <option>米</option>
                                <option>千克</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                          
                          <!-- 工时 -->
                          <tr class="bg-green-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">2</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">工时</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入工作内容">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>小时</option>
                                <option>天</option>
                                <option>月</option>
                                <option>人天</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                          
                          <!-- 服务费 -->
                          <tr class="bg-yellow-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">3</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">服务费</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入服务内容">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>次</option>
                                <option>项</option>
                                <option>月</option>
                                <option>年</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    
                    <!-- 料工费汇总 -->
                    <div class="grid grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg">
                      <div class="text-center">
                        <div class="text-lg font-semibold text-blue-600" id="deploy-material-total">0.00</div>
                        <div class="text-sm text-gray-600">材料费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-green-600" id="deploy-labor-total">0.00</div>
                        <div class="text-sm text-gray-600">工时费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-yellow-600" id="deploy-service-total">0.00</div>
                        <div class="text-sm text-gray-600">服务费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-purple-600" id="deploy-total-cost">0.00</div>
                        <div class="text-sm text-gray-600">总费用</div>
                      </div>
                    </div>
                    
                    <!-- 操作按钮 -->
                    <div class="flex justify-between">
                      <div class="flex space-x-2">
                        <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700" onclick="addDeployCostRow()">
                          添加费用项
                        </button>
                        <button class="px-3 py-2 text-sm bg-gray-600 text-white rounded-md hover:bg-gray-700" onclick="calculateDeployCosts()">
                          计算费用
                        </button>
                      </div>
                      <div class="flex space-x-2">
                        <button class="px-3 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700" onclick="saveDeployCosts()">
                          保存费用
                        </button>
                        <button class="px-3 py-2 text-sm bg-purple-600 text-white rounded-md hover:bg-purple-700" onclick="exportDeployCosts()">
                          导出费用
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- 决策环节页签 -->
            <div id="decision-tab" class="tab-content hidden">
              <div class="space-y-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">决策结论</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[100px]">
                    项目已通过决策层审批，获得正式立项资格，进入需求确认阶段。
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">决策附件</label>
                  <div class="space-y-2">
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>决策会议纪要.pdf</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>决策审批表.xlsx</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- 需求确认环节页签 -->
            <div id="requirement-tab" class="tab-content hidden">
              <div class="space-y-6">
                <!-- 需求确认结论 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">需求确认结论</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[100px]">
                    业务需求已确认，功能需求文档已签署，技术需求已明确，准备进入详细设计阶段。
                  </div>
                </div>

                <!-- 需求确认附件 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">需求确认附件</label>
                  <div class="space-y-2">
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>需求确认书.pdf</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>功能需求规格说明书.pdf</span>
                    </div>
                  </div>
                </div>

                <!-- 料工费填写 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">料工费填写</label>
                  <div class="space-y-4">
                    <div class="text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded-md">
                      说明：请填写项目所需的材料费用、工时和服务费，并设置相应的分摊比例。
                    </div>
                    
                    <!-- 料工费表格 -->
                    <div class="overflow-x-auto border border-gray-200 rounded-lg">
                      <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                          <tr>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">序号</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">费用类型</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">费用名称</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单位</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单价(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">小计(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">分摊比例(%)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">分摊金额(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">备注</th>
                          </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                          <!-- 材料费用 -->
                          <tr class="bg-blue-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">1</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">材料费用</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入材料名称">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>个</option>
                                <option>套</option>
                                <option>台</option>
                                <option>件</option>
                                <option>米</option>
                                <option>千克</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                          
                          <!-- 工时 -->
                          <tr class="bg-green-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">2</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">工时</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入工作内容">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>小时</option>
                                <option>天</option>
                                <option>月</option>
                                <option>人天</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                          
                          <!-- 服务费 -->
                          <tr class="bg-yellow-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">3</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">服务费</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入服务内容">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>次</option>
                                <option>项</option>
                                <option>月</option>
                                <option>年</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    
                    <!-- 汇总信息 -->
                    <div class="grid grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg">
                      <div class="text-center">
                        <div class="text-lg font-semibold text-blue-600" id="total-material">0.00</div>
                        <div class="text-sm text-gray-600">材料费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-green-600" id="total-labor">0.00</div>
                        <div class="text-sm text-gray-600">工时费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-yellow-600" id="total-service">0.00</div>
                        <div class="text-sm text-gray-600">服务费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-gray-800" id="grand-total">0.00</div>
                        <div class="text-sm text-gray-600">费用总计</div>
                      </div>
                    </div>
                    
                    <!-- 操作按钮 -->
                    <div class="flex justify-between">
                      <div class="flex space-x-2">
                        <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700">
                          添加费用项
                        </button>
                        <button class="px-3 py-2 text-sm bg-gray-600 text-white rounded-md hover:bg-gray-700">
                          重置表格
                        </button>
                      </div>
                      <div class="flex space-x-2">
                        <button class="px-3 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700">
                          保存料工费
                        </button>
                        <button class="px-3 py-2 text-sm bg-purple-600 text-white rounded-md hover:bg-purple-700">
                          导出料工费表
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- 业务人员挂载数据集 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">业务人员挂载数据集</label>
                  <div class="space-y-4">
                    <div class="text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded-md">
                      说明：勾选选择当前资产下需要挂载的数据集，系统将自动统计相关的数据表数量和字段信息。
                    </div>
                    
                    <!-- 数据集选择表格 -->
                    <div class="overflow-x-auto border border-gray-200 rounded-lg">
                      <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                          <tr>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">序号</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">挂载数据集</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数据集类型</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数据表数量</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                          </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">1</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <div class="flex items-center space-x-2">
                                <input type="checkbox" id="dataset_1" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <label for="dataset_1" class="text-sm font-medium text-gray-900">订单生命周期数据集</label>
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">业务数据集</span>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <span class="text-gray-900">3张表</span>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <button class="text-blue-500 hover:text-blue-700" onclick="showDatasetDetails('order_lifecycle')" title="查看详情">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                              </button>
                            </td>
                          </tr>
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">2</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <div class="flex items-center space-x-2">
                                <input type="checkbox" id="dataset_2" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <label for="dataset_2" class="text-sm font-medium text-gray-900">订单分析数据集</label>
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <span class="inline-block bg-green-100 text-green-800 text-xs px-2 py-1 rounded">分析数据集</span>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <span class="text-gray-900">2张表</span>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <button class="text-blue-500 hover:text-blue-700" onclick="showDatasetDetails('order_analysis')" title="查看详情">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                              </button>
                            </td>
                          </tr>
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">3</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <div class="flex items-center space-x-2">
                                <input type="checkbox" id="dataset_3" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <label for="dataset_2" class="text-sm font-medium text-gray-900">用户行为数据集</label>
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <span class="inline-block bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded">行为数据集</span>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <span class="text-gray-900">4张表</span>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <button class="text-blue-500 hover:text-blue-700" onclick="showDatasetDetails('user_behavior')" title="查看详情">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                              </button>
                            </td>
                          </tr>
                          <tr>
                            <td class="px-3 py-2 text-sm text-gray-500">4</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <div class="flex items-center space-x-2">
                                <input type="checkbox" id="dataset_4" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <label for="dataset_4" class="text-sm font-medium text-gray-900">产品目录数据集</label>
                              </div>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <span class="inline-block bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded">目录数据集</span>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <span class="text-gray-900">2张表</span>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <button class="text-blue-500 hover:text-blue-700" onclick="showDatasetDetails('product_catalog')" title="查看详情">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                              </button>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    
                    <!-- 数据集选择说明 -->
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                      <h4 class="text-sm font-medium text-blue-900 mb-2">当前资产已挂载数据集：</h4>
                      <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="space-y-2">
                          <div class="flex items-center space-x-2">
                            <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">订单生命周期数据集</span>
                            <span class="text-gray-600">(3张表)</span>
                          </div>
                          <div class="text-gray-600 ml-4 text-xs">• 商城订单全生命周期分析表 (8个字段)</div>
                          <div class="text-gray-600 ml-4 text-xs">• 订单状态变更表 (6个字段)</div>
                          <div class="text-gray-600 ml-4 text-xs">• 支付流程记录表 (5个字段)</div>
                        </div>
                        <div class="space-y-2">
                          <div class="flex items-center space-x-2">
                            <span class="inline-block bg-green-100 text-green-800 text-xs px-2 py-1 rounded">订单分析数据集</span>
                            <span class="text-gray-600">(2张表)</span>
                          </div>
                          <div class="text-gray-600 ml-4 text-xs">• 订单基础信息表 (12个字段)</div>
                          <div class="text-gray-600 ml-4 text-xs">• 订单分析指标表 (7个字段)</div>
                        </div>
                      </div>
                    </div>
                    
                    <!-- 数据集选择汇总 -->
                    <div class="grid grid-cols-3 gap-4 p-4 bg-gray-50 rounded-lg">
                      <div class="text-center">
                        <div class="text-lg font-semibold text-blue-600" id="selected-datasets">0</div>
                        <div class="text-sm text-gray-600">已选数据集</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-green-600" id="total-tables">0</div>
                        <div class="text-sm text-gray-600">数据表总数</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-yellow-600" id="total-fields">0</div>
                        <div class="text-sm text-gray-600">字段总数</div>
                      </div>
                    </div>
                    
                    <!-- 操作按钮 -->
                    <div class="flex justify-between">
                      <div class="flex space-x-2">
                        <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700" onclick="selectAllDatasets()">
                          全选数据集
                        </button>
                        <button class="px-3 py-2 text-sm bg-gray-600 text-white rounded-md hover:bg-gray-700" onclick="clearAllDatasets()">
                          清空选择
                        </button>
                      </div>
                      <div class="flex space-x-2">
                        <button class="px-3 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700" onclick="saveDatasetSelection()">
                          保存数据集选择
                        </button>
                        <button class="px-3 py-2 text-sm bg-purple-600 text-white rounded-md hover:bg-purple-700" onclick="exportDatasetSelection()">
                          导出数据集配置
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- 详细设计环节页签 -->
            <div id="design-tab" class="tab-content hidden">
              <div class="space-y-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">设计结论</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[100px]">
                    系统架构设计完成，数据库设计完成，接口设计完成，UI设计完成，准备进入开发阶段。
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">设计附件</label>
                  <div class="space-y-2">
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>系统架构设计文档.pdf</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>数据库设计文档.pdf</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>UI设计稿.pdf</span>
                    </div>
                  </div>
                </div>

                <!-- 详细设计阶段料工费管理 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">料工费管理</label>
                  <div class="space-y-3">
                    <div class="text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded-md">
                      说明：详细设计阶段的材料费用、工时、服务费等成本管理，填写后系统自动计算分摊比例。
                    </div>
                    
                    <!-- 料工费表格 -->
                    <div class="overflow-x-auto border border-gray-200 rounded-lg">
                      <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                          <tr>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">序号</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">费用类型</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">费用名称</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单位</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单价(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">小计(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">分摊比例(%)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">分摊金额(元)</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">备注</th>
                          </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                          <!-- 材料费用 -->
                          <tr class="bg-blue-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">1</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">材料费用</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入材料名称">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>个</option>
                                <option>套</option>
                                <option>台</option>
                                <option>件</option>
                                <option>米</option>
                                <option>千克</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                          
                          <!-- 工时 -->
                          <tr class="bg-green-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">2</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">工时</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入工作内容">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>小时</option>
                                <option>天</option>
                                <option>月</option>
                                <option>人天</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                          
                          <!-- 服务费 -->
                          <tr class="bg-yellow-50">
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">3</td>
                            <td class="px-3 py-2 text-sm font-medium text-gray-900">服务费</td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="请输入服务内容">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <select class="w-full px-2 py-1 text-xs border border-gray-300 rounded">
                                <option>次</option>
                                <option>项</option>
                                <option>月</option>
                                <option>年</option>
                              </select>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0.00" min="0" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0" min="0" max="100" step="0.01">
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="number" class="w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100" placeholder="0.00" readonly>
                            </td>
                            <td class="px-3 py-2 text-sm text-gray-700">
                              <input type="text" class="w-full px-2 py-1 text-xs border border-gray-300 rounded" placeholder="备注信息">
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    
                    <!-- 料工费汇总 -->
                    <div class="grid grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg">
                      <div class="text-center">
                        <div class="text-lg font-semibold text-blue-600" id="design-material-total">0.00</div>
                        <div class="text-sm text-gray-600">材料费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-green-600" id="design-labor-total">0.00</div>
                        <div class="text-sm text-gray-600">工时费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-yellow-600" id="design-service-total">0.00</div>
                        <div class="text-sm text-gray-600">服务费用合计</div>
                      </div>
                      <div class="text-center">
                        <div class="text-lg font-semibold text-purple-600" id="design-total-cost">0.00</div>
                        <div class="text-sm text-gray-600">总费用</div>
                      </div>
                    </div>
                    
                    <!-- 操作按钮 -->
                    <div class="flex justify-between">
                      <div class="flex space-x-2">
                        <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700" onclick="addDesignCostRow()">
                          添加费用项
                        </button>
                        <button class="px-3 py-2 text-sm bg-gray-600 text-white rounded-md hover:bg-gray-700" onclick="calculateDesignCosts()">
                          计算费用
                        </button>
                      </div>
                      <div class="flex space-x-2">
                        <button class="px-3 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700" onclick="saveDesignCosts()">
                          保存费用
                        </button>
                        <button class="px-3 py-2 text-sm bg-purple-600 text-white rounded-md hover:bg-purple-700" onclick="exportDesignCosts()">
                          导出费用
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>



            <!-- 验收环节页签 -->
            <div id="acceptance-tab" class="tab-content hidden">
              <div class="space-y-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">验收结论</label>
                  <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[100px]">
                    项目已通过用户验收，功能满足需求，性能达到预期，质量符合标准。
                  </div>
                </div>
                
                <!-- 费用汇总 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">费用汇总</label>
                  <div class="bg-gray-50 rounded-lg p-4">
                    <div class="grid grid-cols-3 gap-4 mb-4">
                      <div class="text-center">
                        <div class="text-2xl font-bold text-blue-600" id="totalMaterialCost">¥0</div>
                        <div class="text-sm text-gray-600">材料费用</div>
                      </div>
                      <div class="text-center">
                        <div class="text-2xl font-bold text-green-600" id="totalLaborCost">¥0</div>
                        <div class="text-sm text-gray-600">人工费用</div>
                      </div>
                      <div class="text-center">
                        <div class="text-2xl font-bold text-purple-600" id="totalExpenseCost">¥0</div>
                        <div class="text-sm text-gray-600">费用支出</div>
                      </div>
                    </div>
                    <div class="text-center">
                      <div class="text-3xl font-bold text-red-600 border-t pt-4" id="totalAllCost">总计：¥0</div>
                    </div>
                  </div>
                </div>
                
                <!-- 资产使用年限 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">资产使用年限</label>
                  <div class="grid grid-cols-2 gap-4">
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">预计使用年限</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md" id="assetLifespan">5年</div>
                    </div>
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">折旧方法</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">直线折旧法</div>
                    </div>
                    <div class="col-span-2">
                      <label class="block text-xs text-gray-600 mb-1">使用年限说明</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[60px]">
                        根据数据资产的技术特性和业务价值，预计该资产可使用5年。在5年内，资产将保持其核心价值，之后可能需要技术升级或重新开发。
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- 相关论述 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">相关论述</label>
                  <div class="space-y-4">
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">技术价值评估</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[60px]">
                        该数据资产采用了先进的数据处理技术，具备良好的扩展性和维护性。技术架构合理，能够满足未来业务发展需求。
                      </div>
                    </div>
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">业务价值分析</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[60px]">
                        资产上线后将显著提升业务效率，预计每年可节省人力成本约30万元，提升数据处理速度50%以上。
                      </div>
                    </div>
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">风险评估</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[60px]">
                        主要风险包括技术更新迭代、业务需求变化等。建议建立定期评估机制，及时识别和应对风险。
                      </div>
                    </div>
                  </div>
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">验收附件</label>
                  <div class="space-y-2">
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></span>
                      </svg>
                      <span>验收报告.pdf</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-blue-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                      <span>用户确认书.pdf</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- 资产形成页签 -->
            <div id="asset-formation-tab" class="tab-content hidden">
              <div class="space-y-6">
                <!-- 分配数据集价值 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">分配数据集价值</label>
                  <div class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                      <div>
                        <label class="block text-xs text-gray-600 mb-1">数据集名称</label>
                        <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">用户行为分析数据集</div>
                      </div>
                      <div>
                        <label class="block text-xs text-gray-600 mb-1">数据集类型</label>
                        <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">结构化数据</div>
                      </div>
                      <div>
                        <label class="block text-xs text-gray-600 mb-1">更新频率</label>
                        <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">每日更新</div>
                      </div>
                      <div>
                        <label class="block text-xs text-gray-600 mb-1">数据来源</label>
                        <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">用户行为日志系统</div>
                      </div>
                    </div>

                    <div>
                      <label class="block text-xs text-gray-600 mb-1">本资产下挂载数据集</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[60px]">
                        1. 用户行为分析数据集（结构化数据，每日更新）<br>
                        2. 用户画像数据集（结构化数据，每周更新）<br>
                        3. 营销效果数据集（结构化数据，每日更新）
                      </div>
                    </div>
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">使用场景</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[60px]">
                        用户画像分析、个性化推荐、营销效果评估、产品功能优化、用户满意度分析等。
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- 评估价值报告 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">评估价值报告 <span class="text-xs text-gray-500">（非必填）</span></label>
                  <div class="space-y-4">
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">评估方法</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">成本法 + 收益法综合评估</div>
                    </div>
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">评估结论</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md min-h-[80px]">
                        基于成本法和收益法的综合评估，该数据资产的总价值约为200万元。其中开发成本约80万元，预期收益现值约120万元。资产具有良好的投资回报率和长期价值。
                      </div>
                    </div>
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">评估附件</label>
                      <div class="space-y-2">
                        <div class="flex items-center space-x-2 text-sm text-blue-600">
                          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                          </svg>
                          <span>数据资产评估报告.pdf</span>
                        </div>
                        <div class="flex items-center space-x-2 text-sm text-blue-600">
                          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                          </svg>
                          <span>价值评估计算表.xlsx</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- 资产登记信息 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">资产登记信息</label>
                  <div class="grid grid-cols-2 gap-4">
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">资产编号</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">DA-2024-001</div>
                    </div>
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">登记日期</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">2024年12月25日</div>
                    </div>
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">资产状态</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">已登记</div>
                    </div>
                    <div>
                      <label class="block text-xs text-gray-600 mb-1">管理责任人</label>
                      <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">数据资产管理部</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>


          </div>
        </div>
      </div>
    </div>

    <!-- 项目编辑模态框 -->
    <div id="projectEditModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
      <div class="relative top-20 mx-auto p-5 border w-4/5 max-w-4xl shadow-lg rounded-md bg-white">
        <div class="mt-3">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-medium text-gray-900">发起预研</h3>
            <button onclick="closeProjectEditModal()" class="text-gray-400 hover:text-gray-600">
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>
          
          <!-- 页签导航 -->
          <div class="border-b border-gray-200 mb-6">
            <nav class="-mb-px flex space-x-6 overflow-x-auto" aria-label="Tabs">
              <button onclick="showEditTab('basic')" class="edit-tab-button border-b-2 border-blue-500 py-2 px-1 text-sm font-medium text-blue-600 whitespace-nowrap" data-tab="basic">
                项目基本信息
              </button>
              <button onclick="showEditTab('research')" class="edit-tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="research">
                预研环节
              </button>
            </nav>
          </div>
          
          <!-- 页签内容 -->
          <div class="mt-6">
            <!-- 项目基本信息页签 -->
            <div id="edit-basic-tab" class="edit-tab-content">
              <form id="projectEditForm">
                <div class="grid grid-cols-2 gap-6">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">项目名称 *</label>
                    <input type="text" id="editProjectName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">项目类型</label>
                    <input type="text" value="数据资产" readonly class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">负责人 *</label>
                    <input type="text" id="editProjectManager" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">创建时间</label>
                    <input type="text" id="editProjectCreateTime" readonly class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100">
                  </div>
                  <div class="col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-2">项目描述</label>
                    <textarea id="editProjectDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请描述项目的基本信息..."></textarea>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">当前状态</label>
                    <input type="text" id="editProjectStatus" readonly class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">当前阶段</label>
                    <input type="text" id="editProjectStage" readonly class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100">
                  </div>
                </div>
                
                <div class="flex justify-end space-x-3 mt-6">
                  <button type="button" onclick="closeProjectEditModal()" class="btn-secondary">取消</button>
                  <button type="submit" class="btn-primary">确认提交</button>
                </div>
              </form>
            </div>
            
            <!-- 预研环节页签 -->
            <div id="edit-research-tab" class="edit-tab-content hidden">
              <div class="flex justify-center items-center min-h-[200px]">
                <button onclick="initiateResearch()" class="btn-primary">
                  <i class="fas fa-rocket mr-2"></i>发起预研
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 提交预研结果模态框 -->
    <div id="researchDetailsModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
      <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-2/3 lg:w-1/2 shadow-lg rounded-md bg-white">
        <div class="mt-3">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-medium text-gray-900">提交预研结果</h3>
            <button onclick="closeResearchDetailsModal()" class="text-gray-400 hover:text-gray-600">
              <i class="fas fa-times"></i>
            </button>
          </div>
          
          <div class="space-y-6">
            <!-- 预研结论 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">预研结论 *</label>
              <textarea id="researchConclusion" rows="4" placeholder="请输入预研结论和建议..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
            </div>
            
            <!-- 附件上传 -->
            <div>
              <h4 class="font-medium text-gray-900 mb-3">预研文件上传</h4>
              <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center" 
                   ondrop="handleDrop(event)" 
                   ondragover="handleDragOver(event)" 
                   ondragleave="handleDragLeave(event)">
                <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                <p class="text-sm text-gray-600">拖拽文件到此处或点击上传</p>
                <p class="text-xs text-gray-500 mt-1">支持 PDF、Word、Excel 等格式，单个文件不超过 10MB</p>
                <button type="button" onclick="document.getElementById('fileInput').click()" class="mt-2 btn-secondary">选择文件</button>
                <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.xls,.xlsx" class="hidden" onchange="handleFileUpload(event)">
              </div>
              <div id="uploadedFiles" class="mt-3 space-y-2">
                <!-- 已上传文件列表 -->
              </div>
            </div>
            
            <div class="flex justify-end space-x-3 pt-4">
              <button type="button" onclick="closeResearchDetailsModal()" class="btn-secondary">取消</button>
              <button type="button" onclick="submitResearchResultFinal()" class="btn-primary">提交预研结果</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 财务汇总模态框 -->
    <div id="financialSummaryModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
      <div class="relative top-20 mx-auto p-5 border w-4/5 max-w-6xl shadow-lg rounded-md bg-white">
        <div class="mt-3">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-medium text-gray-900">财务汇总报告</h3>
            <button onclick="closeFinancialSummaryModal()" class="text-gray-400 hover:text-gray-600">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          
          <!-- 汇总信息头部 -->
          <div class="bg-blue-50 p-4 rounded-lg mb-6">
            <div class="grid grid-cols-4 gap-4">
              <div class="text-center">
                <div class="text-2xl font-bold text-blue-600" id="totalBudget">¥0</div>
                <div class="text-sm text-gray-600">总预算</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-green-600" id="totalExpense">¥0</div>
                <div class="text-sm text-gray-600">已支出</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-orange-600" id="remainingBudget">¥0</div>
                <div class="text-sm text-gray-600">剩余预算</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-purple-600" id="expenseRate">0%</div>
                <div class="text-sm text-gray-600">支出率</div>
              </div>
            </div>
          </div>
          
          <!-- 季度汇总表格 -->
          <div class="mb-6">
            <h4 class="text-md font-medium text-gray-900 mb-3">季度财务汇总</h4>
            <div class="overflow-x-auto border border-gray-200 rounded-lg">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                  <tr>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">季度</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">预算金额</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">实际支出</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">差异</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">完成率</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">备注</th>
                  </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200" id="quarterlySummaryTable">
                  <!-- 季度数据将通过JavaScript动态生成 -->
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- 费用分类汇总 -->
          <div class="mb-6">
            <h4 class="text-md font-medium text-gray-900 mb-3">费用分类汇总</h4>
            <div class="grid grid-cols-2 gap-6">
              <div class="bg-gray-50 p-4 rounded-lg">
                <h5 class="text-sm font-medium text-gray-700 mb-3">直接费用</h5>
                <div class="space-y-2">
                  <div class="flex justify-between text-sm">
                    <span class="text-gray-600">设备购置费</span>
                    <span class="font-medium" id="equipmentCost">¥0</span>
                  </div>
                  <div class="flex justify-between text-sm">
                    <span class="text-gray-600">材料费</span>
                    <span class="font-medium" id="materialCost">¥0</span>
                  </div>
                  <div class="flex justify-between text-sm">
                    <span class="text-gray-600">人工费</span>
                    <span class="font-medium" id="laborCost">¥0</span>
                  </div>
                  <div class="flex justify-between text-sm">
                    <span class="text-gray-600">其他直接费</span>
                    <span class="font-medium" id="otherDirectCost">¥0</span>
                  </div>
                  <div class="border-t pt-2 mt-2">
                    <div class="flex justify-between text-sm font-medium">
                      <span>直接费用合计</span>
                      <span id="totalDirectCost">¥0</span>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="bg-gray-50 p-4 rounded-lg">
                <h5 class="text-sm font-medium text-gray-700 mb-3">间接费用</h5>
                <div class="space-y-2">
                  <div class="flex justify-between text-sm">
                    <span class="text-gray-600">管理费</span>
                    <span class="font-medium" id="managementCost">¥0</span>
                  </div>
                  <div class="flex justify-between text-sm">
                    <span class="text-gray-600">财务费</span>
                    <span class="font-medium" id="financialCost">¥0</span>
                  </div>
                  <div class="flex justify-between text-sm">
                    <span class="text-gray-600">其他间接费</span>
                    <span class="font-medium" id="otherIndirectCost">¥0</span>
                  </div>
                  <div class="border-t pt-2 mt-2">
                    <div class="flex justify-between text-sm font-medium">
                      <span>间接费用合计</span>
                      <span id="totalIndirectCost">¥0</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 操作按钮 -->
          <div class="flex justify-between items-center pt-4 border-t">
            <div class="flex space-x-2">
              <button onclick="submitFinancialSummary()" class="px-4 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700">
                <i class="fas fa-check mr-2"></i>提交
              </button>
            </div>
            <div class="flex space-x-2">
              <button onclick="closeFinancialSummaryModal()" class="px-4 py-2 text-sm bg-gray-600 text-white rounded-md hover:bg-gray-700">
                关闭
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 新建项目模态框 -->
    <div id="newProjectModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
      <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-2/3 lg:w-1/2 shadow-lg rounded-md bg-white">
        <div class="mt-3">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-medium text-gray-900">新建项目</h3>
            <button onclick="closeNewProjectModal()" class="text-gray-400 hover:text-gray-600">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          
          <form id="newProjectForm" class="space-y-4">
            <!-- 项目名称 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">项目名称 *</label>
              <input type="text" id="newProjectName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入项目名称">
            </div>
            
            <!-- 负责人 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">负责人 *</label>
              <input type="text" id="newProjectManager" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入负责人姓名">
            </div>
            
            <!-- 项目类型 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">项目类型 *</label>
              <select id="newProjectType" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">请选择项目类型</option>
                <option value="信息类">信息类</option>
                <option value="科技类">科技类</option>
              </select>
            </div>
            
            <!-- 立项类型 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">立项类型 *</label>
              <select id="newEstablishmentType" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">请选择立项类型</option>
                <option value="二开自研">二开自研</option>
                <option value="其他">其他</option>
                <option value="待定">待定</option>
              </select>
            </div>
            
            <!-- 资产类型 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">资产类型 *</label>
              <select id="newAssetType" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">请选择资产类型</option>
                <option value="数据资产">数据资产</option>
                <option value="软件资产">软件资产</option>
                <option value="平台资产">平台资产</option>
                <option value="系统资产">系统资产</option>
              </select>
            </div>
            
            <!-- 资产描述 -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">资产描述</label>
              <textarea id="newAssetDescription" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入资产描述..."></textarea>
            </div>
            
            <div class="flex justify-end space-x-3 pt-4">
              <button type="button" onclick="closeNewProjectModal()" class="btn-secondary">取消</button>
              <button type="submit" class="btn-primary">确认创建</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- 提交预研模态框 -->
    <div id="initiateResearchModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
      <div class="relative top-20 mx-auto p-5 border w-4/5 max-w-4xl shadow-lg rounded-md bg-white">
        <div class="mt-3">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-medium text-gray-900">提交预研</h3>
            <button onclick="closeInitiateResearchModal()" class="text-gray-400 hover:text-gray-600">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          
          <form id="initiateResearchForm" class="space-y-6">
            <!-- 项目基本信息 -->
            <div class="bg-gray-50 p-4 rounded-lg">
              <h4 class="text-md font-medium text-gray-900 mb-4">项目基本信息</h4>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">项目名称</label>
                  <input type="text" id="researchProjectName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">项目类型</label>
                  <input type="text" value="数据资产" class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100" readonly>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">负责人</label>
                  <input type="text" id="researchProjectManager" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="col-span-2">
                  <label class="block text-sm font-medium text-gray-700 mb-2">项目描述</label>
                  <textarea id="researchProjectDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required></textarea>
                </div>
              </div>
            </div>
            
            <!-- 预研信息 -->
            <div class="bg-blue-50 p-4 rounded-lg">
              <h4 class="text-md font-medium text-gray-900 mb-4">预研信息</h4>
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">预研结论</label>
                  <textarea id="researchConclusion" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="请输入预研结论..." required></textarea>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">上传附件</label>
                  <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                    <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                      <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <div class="flex text-sm text-gray-600 mt-2">
                      <label for="file-upload" class="relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500">
                        <span>上传文件</span>
                        <input id="file-upload" name="file-upload" type="file" class="sr-only" multiple>
                      </label>
                      <p class="pl-1">或拖拽文件到此处</p>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">支持 PDF, DOC, DOCX, XLS, XLSX 格式</p>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="flex justify-end space-x-3">
              <button type="button" onclick="closeInitiateResearchModal()" class="btn-secondary">取消</button>
              <button type="submit" class="btn-primary">提交预研</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </main>

  <script>
    // 侧边栏切换功能
    let sidebarCollapsed = false;
    
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const mainContent = document.querySelector('main');
      const toggleBtn = document.getElementById('sidebar-toggle');
      
      if (sidebarCollapsed) {
        sidebar.classList.remove('sidebar-collapsed');
        sidebar.classList.add('sidebar-expanded');
        mainContent.classList.remove('sidebar-collapsed');
        mainContent.classList.add('sidebar-expanded');
        toggleBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
        toggleBtn.classList.remove('left-4');
        toggleBtn.classList.add('left-64');
      } else {
        sidebar.classList.remove('sidebar-expanded');
        sidebar.classList.add('sidebar-collapsed');
        mainContent.classList.remove('sidebar-expanded');
        mainContent.classList.add('sidebar-collapsed');
        toggleBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
        toggleBtn.classList.remove('left-64');
        toggleBtn.classList.add('left-4');
      }
      
      sidebarCollapsed = !sidebarCollapsed;
    }

    // 子菜单切换功能
    function toggleSubMenu(menuId) {
      const submenu = document.getElementById(menuId + '-submenu');
      const arrow = document.getElementById(menuId + '-arrow');
      
      if (submenu.classList.contains('hidden')) {
        submenu.classList.remove('hidden');
        arrow.style.transform = 'rotate(180deg)';
      } else {
        submenu.classList.add('hidden');
        arrow.style.transform = 'rotate(0deg)';
      }
    }



    // 添加项目到表格
    function addProjectToTable(project) {
      const tbody = document.querySelector('#initiator-content tbody');
      const newRow = document.createElement('tr');
      newRow.setAttribute('data-project-id', project.id);
      
      // 根据项目状态确定操作按钮
      let actionButton = '';
      let statusBadge = '';
      
      // 设置状态徽章样式
      switch(project.approvalStatus) {
        case '待填写':
          statusBadge = '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-600">待填写</span>';
          actionButton = '<button onclick="editProject(\'' + project.id + '\')" class="text-green-600 hover:text-green-900">编辑内容</button>';
          break;
        case '草稿':
          statusBadge = '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800">草稿</span>';
          actionButton = '<button onclick="editProject(\'' + project.id + '\')" class="text-green-600 hover:text-green-900">编辑内容</button>';
          break;
        case '已驳回':
          statusBadge = '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">已驳回</span>';
          actionButton = '<button onclick="editProject(\'' + project.id + '\')" class="text-green-600 hover:text-green-900">编辑内容</button>';
          break;
        case '待审批':
          statusBadge = '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">待审批</span>';
          actionButton = '<button onclick="viewProject(\'' + project.id + '\')" class="text-blue-600 hover:text-blue-900">查看详情</button>';
          break;
        case '已完成':
          statusBadge = '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">已完成</span>';
          actionButton = '<button onclick="viewProject(\'' + project.id + '\')" class="text-blue-600 hover:text-blue-900">查看详情</button>';
          break;
        default:
          statusBadge = '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-600">待填写</span>';
          actionButton = '<button onclick="editProject(\'' + project.id + '\')" class="text-green-600 hover:text-green-900">编辑内容</button>';
      }
      
      newRow.innerHTML = `
        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${project.name}</td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${project.manager}</td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${project.createTime}</td>
        <td class="px-6 py-4 whitespace-nowrap">
          <span class="px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800">${project.status}</span>
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          ${statusBadge}
        </td>
        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
          ${actionButton}
        </td>
      `;
      
      tbody.insertBefore(newRow, tbody.firstChild);
      
      // 更新项目数据，保存完整的项目信息
      window.projectData = window.projectData || {};
      window.projectData[project.id] = {
        ...project,
        projectType: project.projectType || '信息类',
        establishmentType: project.establishmentType || '二开自研',
        assetType: project.assetType || '数据资产'
      };
    }

    // 发起预研模态框相关函数
    function closeInitiateResearchModal() {
      document.getElementById('initiateResearchModal').classList.add('hidden');
    }

    // 提交预研表单处理
    document.getElementById('initiateResearchForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const projectName = document.getElementById('researchProjectName').value;
      const projectManager = document.getElementById('researchProjectManager').value;
      const projectDescription = document.getElementById('researchProjectDescription').value;
      const researchConclusion = document.getElementById('researchConclusion').value;
      
      if (!projectName || !projectManager || !projectDescription || !researchConclusion) {
        alert('请填写所有必填字段！');
        return;
      }
      
      // 创建新项目（包含预研信息）
      const newProject = {
        id: 'project' + Date.now(),
        name: projectName,
        manager: projectManager,
        description: projectDescription,
        createTime: new Date().toISOString().split('T')[0],
        status: '预研中',
        stage: '预研阶段',
        progress: 30,
        researchConclusion: researchConclusion,
        researchAttachments: ['预研报告.pdf', '技术分析.docx'] // 示例附件
      };
      
      // 添加到表格
      addProjectToTable(newProject);
      
      // 关闭模态框
      closeInitiateResearchModal();
      
      alert('预研提交成功！');
    });

    function submitResearchInitiation() {
      // 这里可以添加提交逻辑
      alert('预研环节已成功发起！');
      closeInitiateResearchModal();
    }

    // 项目操作相关函数
    function viewProject(projectId) {
      // 跳转到项目详情页面
      window.location.href = `项目详情.html?id=${projectId}`;
    }

    // 全局变量记录当前编辑的项目ID
    let currentEditingProjectId = null;

    function editProject(projectId) {
      // 点击编辑内容不展示弹窗
      console.log('编辑项目:', projectId);
      // 原来的弹窗逻辑已移除
    }

    // 获取项目数据
    function getProjectData(projectId) {
      // 首先检查动态创建的项目数据
      if (window.projectData && window.projectData[projectId]) {
        return window.projectData[projectId];
      }
      
      // 静态项目数据
      const projectData = {
        'project1': {
          name: '数据质量管理系统',
          manager: '张三',
          projectType: '信息类',
          establishmentType: '二开自研',
          assetType: '数据资产',
          description: '构建企业级数据质量管理系统，提升数据治理能力，实现数据全生命周期的质量管控。',
          createTime: '2024-01-15',
          status: '预研中',
          stage: '预研阶段',
          progress: 30,
          notes: '项目已进入预研阶段，正在进行技术可行性分析。',
          approvalHistory: [
            {
              status: 'rejected',
              approver: '王经理',
              time: '2024-01-18',
              remark: '技术方案不够详细，建议补充系统架构设计和技术选型说明。'
            }
          ]
        },
        'project2': {
          name: '移动端数据展示',
          manager: '李四',
          projectType: '科技类',
          establishmentType: '其他',
          assetType: '软件资产',
          description: '开发移动端数据可视化应用，支持多维度数据展示和交互分析。',
          createTime: '2024-01-10',
          status: '立项中',
          stage: '立项阶段',
          progress: 60,
          notes: '项目已通过预研，正在准备立项材料。',
          approvalHistory: [
            {
              status: 'rejected',
              approver: '王经理',
              time: '2024-01-12',
              remark: '技术方案不够详细，建议补充移动端适配方案和性能优化策略。'
            },
            {
              status: 'approved',
              approver: '张总监',
              time: '2024-01-15',
              remark: '预研方案完整，技术路线清晰，同意进入立项阶段。'
            }
          ]
        },
        'project3': {
          name: '数据湖平台建设',
          manager: '王五',
          projectType: '信息类',
          establishmentType: '待定',
          assetType: '平台资产',
          description: '构建企业级数据湖平台，支持多源数据集成、存储和分析，为数据驱动决策提供支撑。',
          createTime: '2024-01-20',
          status: '开发中',
          stage: '开发阶段',
          progress: 45,
          notes: '核心架构已完成，正在进行功能模块开发。',
          approvalHistory: [
            {
              status: 'rejected',
              approver: '技术委员会',
              time: '2024-01-21',
              remark: '架构设计需要进一步优化，建议增加数据安全防护措施和灾备方案。'
            },
            {
              status: 'approved',
              approver: '李经理',
              time: '2024-01-22',
              remark: '预研结论充分，技术方案可行，同意立项。'
            },
            {
              status: 'approved',
              approver: '赵总监',
              time: '2024-01-25',
              remark: '预算合理，资源配置到位，同意进入开发阶段。'
            }
          ]
        },
        'project4': {
          name: 'BI报表系统升级',
          manager: '赵六',
          projectType: '科技类',
          establishmentType: '二开自研',
          assetType: '系统资产',
          description: '升级现有BI报表系统，提升性能和用户体验，支持更丰富的数据可视化功能。',
          createTime: '2024-01-25',
          status: '测试中',
          stage: '测试阶段',
          progress: 80,
          notes: '功能开发完成，正在进行系统测试和性能优化。'
        }
      };
      
      return projectData[projectId] || {};
    }

    // 模态框控制函数
    function closeProjectViewModal() {
      document.getElementById('projectViewModal').classList.add('hidden');
    }

    function closeProjectEditModal() {
      document.getElementById('projectEditModal').classList.add('hidden');
    }

    // 编辑弹窗页签切换函数
    function showEditTab(tabName) {
      // 隐藏所有编辑页签内容
      const editTabContents = document.querySelectorAll('.edit-tab-content');
      editTabContents.forEach(content => {
        content.classList.add('hidden');
      });
      
      // 移除所有编辑页签按钮的激活状态
      const editTabButtons = document.querySelectorAll('.edit-tab-button');
      editTabButtons.forEach(button => {
        button.classList.remove('border-b-2', 'border-blue-500', 'text-blue-600');
        button.classList.add('border-b-2', 'border-transparent', 'text-gray-500');
      });
      
      // 显示选中的编辑页签内容
      const selectedEditTab = document.getElementById('edit-' + tabName + '-tab');
      if (selectedEditTab) {
        selectedEditTab.classList.remove('hidden');
      }
      
      // 激活选中的编辑页签按钮
      const selectedEditButton = document.querySelector(`[data-tab="${tabName}"]`);
      if (selectedEditButton) {
        selectedEditButton.classList.remove('border-transparent', 'text-gray-500');
        selectedEditButton.classList.add('border-blue-500', 'text-blue-600');
      }
    }

    // 发起预研函数
    function initiateResearch() {
      // 显示确认对话框
      if (confirm('确定要发起预研吗？这将启动项目的预研阶段。')) {
        // 更新项目状态
        if (window.projectData && window.projectData[currentEditingProjectId]) {
          window.projectData[currentEditingProjectId].status = '预研中';
          window.projectData[currentEditingProjectId].stage = '预研阶段';
        }
        
        // 更新表格中的状态显示
        const statusCell = document.querySelector(`tr[data-project-id="${currentEditingProjectId}"] td:nth-child(5) span`);
        if (statusCell) {
          statusCell.textContent = '预研中';
          statusCell.className = 'status-active px-2 py-1 text-xs font-semibold rounded-full';
        }
        
        // 关闭编辑弹窗
        closeProjectEditModal();
        
        // 显示成功提示
        alert('预研已成功发起！项目状态已更新为"预研中"。');
      }
    }

    // 项目编辑表单提交
    document.getElementById('projectEditForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const projectName = document.getElementById('editProjectName').value;
      const projectManager = document.getElementById('editProjectManager').value;
      const projectDescription = document.getElementById('editProjectDescription').value;
      
      if (!projectName || !projectManager) {
        alert('请填写必填字段！');
        return;
      }
      
      // 更新表格中的项目信息
      updateProjectInTable(projectName, projectManager, projectDescription);
      
      // 关闭模态框
      closeProjectEditModal();
      
      alert('项目信息已更新！');
    });

    // 更新表格中的项目信息
    function updateProjectInTable(name, manager, description) {
      // 获取当前编辑的项目ID
      const currentProjectId = getCurrentEditingProjectId();
      if (!currentProjectId) return;
      
      // 更新项目数据
      if (window.projectData && window.projectData[currentProjectId]) {
        window.projectData[currentProjectId].name = name;
        window.projectData[currentProjectId].manager = manager;
        window.projectData[currentProjectId].description = description;
      }
      
      // 更新表格显示
      const row = document.querySelector(`tr[data-project-id="${currentProjectId}"]`);
      if (row) {
        const nameCell = row.querySelector('td:nth-child(1)');
        const managerCell = row.querySelector('td:nth-child(3)');
        
        if (nameCell) nameCell.textContent = name;
        if (managerCell) managerCell.textContent = manager;
      }
    }
    
    // 获取当前正在编辑的项目ID
    function getCurrentEditingProjectId() {
      return currentEditingProjectId;
    }

    function startResearch(projectId) {
      alert('开始预研项目：' + projectId);
    }

    function submitResearch(projectId) {
      alert('提交预研结果：' + projectId);
    }

    function viewDetails(projectId) {
      // 跳转到项目详情页面
      window.open(`项目详情.html?id=${projectId}`, '_blank');
    }

    // 预研人员视角相关函数
    function filterResearchTasks() {
      const filterValue = document.getElementById('researchFilter').value;
      console.log('筛选预研任务：', filterValue);
      // 这里可以添加实际的筛选逻辑
    }

    function refreshResearchTasks() {
      console.log('刷新预研任务列表');
      // 这里可以添加实际的刷新逻辑
    }

    function viewResearchDetails(projectId) {
      document.getElementById('researchDetailsModal').classList.remove('hidden');
      // 这里可以加载项目详情数据
    }

    function closeResearchDetailsModal() {
      document.getElementById('researchDetailsModal').classList.add('hidden');
    }

    function startResearchTask(projectId) {
      console.log('开始预研任务：', projectId);
      // 更新任务状态为进行中
      alert('预研任务已开始！');
    }

    function submitResearchResult(projectId) {
      console.log('提交预研结果：', projectId);
      
      // 显示提交预研弹窗
      document.getElementById('researchDetailsModal').classList.remove('hidden');
      
      // 存储当前项目ID，用于后续提交
      window.currentProjectId = projectId;
    }

    function submitResearchResultFinal() {
      console.log('最终提交预研结果');
      
      // 验证必填字段
      const conclusion = document.getElementById('researchConclusion').value;
      
      if (!conclusion.trim()) {
        alert('请填写预研结论！');
        return;
      }
      
      // 提交预研结果
      alert('预研结果已提交！');
      closeResearchDetailsModal();
      
      // 更新项目状态为已完成
      const projectId = window.currentProjectId;
      if (projectId) {
        updateProjectStatus(projectId, 'completed');
        updateProjectActions(projectId);
      }
      
      // 清空表单
      document.getElementById('researchConclusion').value = '';
      document.getElementById('uploadedFiles').innerHTML = '';
      
      // 清除当前项目ID
      window.currentProjectId = null;
    }
    
    // 更新项目状态
    function updateProjectStatus(projectId, status) {
      const row = document.querySelector(`tr[data-project-id="${projectId}"]`);
      
      if (row) {
        const statusCell = row.querySelector('td:nth-child(6) span');
        if (statusCell) {
          statusCell.className = 'status-completed px-2 py-1 text-xs font-semibold rounded-full';
          statusCell.textContent = '已完成';
        }
      }
    }
    
    // 更新项目操作按钮
    function updateProjectActions(projectId) {
      const row = document.querySelector(`tr[data-project-id="${projectId}"]`);
      
      if (row) {
        const actionsCell = row.querySelector('td:nth-child(7)');
        if (actionsCell) {
          actionsCell.innerHTML = `<button onclick="viewProject('${projectId}')" class="text-blue-600 hover:text-blue-900">查看详情</button>`;
        }
      }
    }

    function saveResearchProgress() {
      console.log('保存预研进度');
      alert('预研进度已保存！');
    }

    function downloadResearchReport(projectId) {
      console.log('下载预研报告：', projectId);
      alert('开始下载预研报告...');
    }

    // 审批人员视角相关函数
    
    // 显示审批人员新建项目弹窗
    function showApproverNewProjectModal() {
      document.getElementById('approverNewProjectModal').classList.remove('hidden');
      // 清空表单
      document.getElementById('approverNewProjectForm').reset();
    }

    // 关闭审批人员新建项目弹窗
    function closeApproverNewProjectModal() {
      document.getElementById('approverNewProjectModal').classList.add('hidden');
    }

    // 创建审批人员新项目
    function createApproverProject() {
      const projectName = document.getElementById('approverProjectName').value;
      const projectManager = document.getElementById('approverProjectManager').value;
      const projectType = document.getElementById('approverProjectType').value;
      const establishmentType = document.getElementById('approverEstablishmentType').value;
      const assetType = document.getElementById('approverAssetType').value;
      const assetDescription = document.getElementById('approverAssetDescription').value;
      
      if (!projectName || !projectManager || !projectType || !establishmentType || !assetType) {
        alert('请填写所有必填字段！');
        return;
      }
      
      // 创建新项目
      const newProject = {
        id: 'project' + Date.now(),
        name: projectName,
        manager: projectManager,
        projectType: projectType,
        establishmentType: establishmentType,
        assetType: assetType,
        description: assetDescription,
        createTime: new Date().toISOString().split('T')[0],
        status: '可行性研究环节',
        stage: '研究环节',
        approvalStatus: '待审批',  // 审批人员新建的项目默认为待审批状态
        progress: 0
      };
      
      // 添加到审批人员视角表格
      addProjectToApproverTable(newProject);
      
      // 关闭模态框
      closeApproverNewProjectModal();
      
      alert('项目创建成功！');
    }

    // 添加项目到审批人员视角表格
    function addProjectToApproverTable(project) {
      const tbody = document.querySelector('#approver-content tbody');
      const newRow = document.createElement('tr');
      newRow.setAttribute('data-project-id', project.id);
      
      // 设置状态徽章样式 - 审批人员新建的项目默认为待审批
      const statusBadge = '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">待审批</span>';
      
      // 待审批状态的操作按钮
      const actionButtons = `
        <button onclick="reviewProject('${project.id}')" class="text-blue-600 hover:text-blue-900 mr-3">审核</button>
        <button onclick="viewDetails('${project.id}')" class="text-green-600 hover:text-green-900">查看详情</button>
      `;
      
      newRow.innerHTML = `
        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${project.name}</td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${project.manager}</td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${project.createTime}</td>
        <td class="px-6 py-4 whitespace-nowrap">
          <span class="status-pending px-2 py-1 text-xs font-semibold rounded-full">${project.status}</span>
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          ${statusBadge}
        </td>
        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
          ${actionButtons}
        </td>
      `;
      
      // 插入到表格顶部
      tbody.insertBefore(newRow, tbody.firstChild);
    }

    // 审核项目
    function reviewProject(projectId) {
      console.log('审核项目：', projectId);
      // 跳转到项目详情页面进行审核
      window.open(`项目详情.html?id=${projectId}`, '_blank');
    }

    function viewApprovalHistory(projectId) {
      console.log('查看审批历史：', projectId);
      // 审批历史现在在详情页签中展示
    }

    function viewRejectionReason(projectId) {
      console.log('查看驳回原因：', projectId);
      // 驳回原因现在在详情页签中展示
    }

    // 更新项目流程状态
    function updateProjectFlow(projectId, stage) {
      // 这里可以添加更新流程状态的逻辑
      console.log('项目', projectId, '进入阶段：', stage);
    }

    // 显示流程阶段信息
    function showStageInfo(stageName) {
      const stageInfo = {
        '预研': '技术可行性分析、市场调研、风险评估',
        '立项': '项目立项申请、预算评估、资源分配',
        '决策': '管理层决策、项目优先级确定',
        '需求确认': '详细需求分析、用户故事编写、验收标准制定',
        '详细设计': '系统架构设计、数据库设计、接口设计',
        '开发': '编码实现、单元测试、代码审查',
        '测试': '集成测试、系统测试、用户验收测试',
        '上线': '生产环境部署、监控配置、性能调优',
        '验收': '用户验收、文档交付、培训完成',

        '资产形成': '资产登记、标签管理、目录更新'
      };
      
      const info = stageInfo[stageName] || '暂无详细信息';
      alert(`${stageName}阶段：\n${info}`);
    }

    // 模拟项目流程推进
    function advanceProjectStage(projectId, currentStage, nextStage) {
      // 这里可以添加实际的流程推进逻辑
      console.log(`项目${projectId}从${currentStage}推进到${nextStage}`);
      
      // 更新流程显示
      updateFlowDisplay(nextStage);
    }

    // 更新流程显示
    function updateFlowDisplay(currentStage) {
      const stages = ['预研', '立项', '决策', '需求确认', '详细设计', '开发', '测试', '上线', '验收', '资产形成'];
      const currentIndex = stages.indexOf(currentStage);
      
      stages.forEach((stage, index) => {
        const stageElement = document.getElementById(`stage-${stage.toLowerCase().replace(/\s+/g, '-')}`);
        const connectorElement = document.getElementById(`connector-${index}`);
        
        if (index < currentIndex) {
          // 已完成阶段
          stageElement.classList.add('completed');
          stageElement.classList.remove('active', 'pending');
          if (connectorElement) {
            connectorElement.classList.add('completed');
            connectorElement.classList.remove('active');
          }
        } else if (index === currentIndex) {
          // 当前阶段
          stageElement.classList.add('active');
          stageElement.classList.remove('completed', 'pending');
          if (connectorElement) {
            connectorElement.classList.add('active');
            connectorElement.classList.remove('completed');
          }
        } else {
          // 待完成阶段
          stageElement.classList.add('pending');
          stageElement.classList.remove('active', 'completed');
          if (connectorElement) {
            connectorElement.classList.remove('active', 'completed');
          }
        }
      });
    }

    // 用户下拉菜单切换
    function toggleUserDropdown() {
      const dropdownMenu = document.getElementById('user-dropdown-menu');
      const arrow = document.getElementById('dropdown-arrow');
      
      if (dropdownMenu.classList.contains('hidden')) {
        dropdownMenu.classList.remove('hidden');
        arrow.style.transform = 'rotate(180deg)';
      } else {
        dropdownMenu.classList.add('hidden');
        arrow.style.transform = 'rotate(0deg)';
      }
    }

    // 点击外部关闭用户下拉菜单
    document.addEventListener('click', function(event) {
      const userDropdown = document.getElementById('user-dropdown');
      const dropdownMenu = document.getElementById('user-dropdown-menu');
      
      if (!userDropdown.contains(event.target)) {
        dropdownMenu.classList.add('hidden');
        document.getElementById('dropdown-arrow').style.transform = 'rotate(0deg)';
      }
    });

    // 页面加载完成后初始化图表
    document.addEventListener('DOMContentLoaded', function() {
      // 这里可以初始化图表等组件
      console.log('页面加载完成');
      
      // 测试审批历史加载功能
      setTimeout(() => {
        console.log('开始测试审批历史加载功能...');
        testApprovalHistoryLoading();
      }, 1000);
    });

    // 测试审批历史加载功能
    function testApprovalHistoryLoading() {
      console.log('=== 测试审批历史加载功能 ===');
      
      // 测试1：检查getProjectData函数
      const testProject1 = getProjectData('project1');
      console.log('测试项目1数据:', testProject1);
      console.log('项目1审批历史:', testProject1.approvalHistory);
      
      const testProject2 = getProjectData('project2');
      console.log('测试项目2数据:', testProject2);
      console.log('项目2审批历史:', testProject2.approvalHistory);
      
      // 测试2：检查审批历史容器是否存在
      const container = document.getElementById('viewApprovalHistory');
      console.log('审批历史容器元素:', container);
      
      // 测试3：模拟设置当前项目ID并加载审批历史
      if (container) {
        console.log('模拟加载项目1的审批历史...');
        window.currentViewingProjectId = 'project1';
        loadApprovalHistory();
      } else {
        console.error('审批历史容器不存在！');
      }
    }

    // 新建项目模态框控制函数
    function showNewProjectModal() {
      document.getElementById('newProjectModal').classList.remove('hidden');
      // 清空表单
      document.getElementById('newProjectForm').reset();
    }
    
    function closeNewProjectModal() {
      document.getElementById('newProjectModal').classList.add('hidden');
    }
    
    // 新建项目表单提交
    document.getElementById('newProjectForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const projectName = document.getElementById('newProjectName').value;
      const projectManager = document.getElementById('newProjectManager').value;
      const projectType = document.getElementById('newProjectType').value;
      const establishmentType = document.getElementById('newEstablishmentType').value;
      const assetType = document.getElementById('newAssetType').value;
      const assetDescription = document.getElementById('newAssetDescription').value;
      
      if (!projectName || !projectManager || !projectType || !establishmentType || !assetType) {
        alert('请填写所有必填字段！');
        return;
      }
      
      // 创建新项目对象
      const newProject = {
        id: 'project' + Date.now(),
        name: projectName,
        manager: projectManager,
        projectType: projectType,
        establishmentType: establishmentType,
        assetType: assetType,
        description: assetDescription,
        createTime: new Date().toISOString().split('T')[0],
        status: '可行性研究环节',
        stage: '研究环节',
        approvalStatus: '待填写',
        progress: 0
      };
      
      // 添加到项目表格
      addProjectToTable(newProject);
      
      // 关闭模态框
      closeNewProjectModal();
      
      alert('项目创建成功！');
    });

    // 主标签页切换函数
    function switchTab(tabName) {
      console.log('切换标签页:', tabName);
      
      // 隐藏所有标签页内容
      const tabContents = document.querySelectorAll('.tab-content');
      tabContents.forEach(content => {
        if (content.id.includes('-content')) {
          content.classList.add('hidden');
          console.log('隐藏内容:', content.id);
        }
      });
      
      // 移除所有标签页按钮的激活状态
      const tabButtons = document.querySelectorAll('.tab-button');
      tabButtons.forEach(button => {
        button.classList.remove('active', 'border-b-2', 'border-blue-500', 'text-blue-600');
        button.classList.add('border-b-2', 'border-transparent', 'text-gray-500');
      });
      
      // 显示选中的标签页内容
      const selectedTab = document.getElementById(tabName + '-content');
      if (selectedTab) {
        selectedTab.classList.remove('hidden');
        console.log('显示内容:', selectedTab.id);
      } else {
        console.error('未找到标签页内容:', tabName + '-content');
      }
      
      // 激活选中的标签页按钮
      const selectedButton = document.getElementById('tab-' + tabName);
      if (selectedButton) {
        selectedButton.classList.remove('border-transparent', 'text-gray-500');
        selectedButton.classList.add('active', 'border-blue-500', 'text-blue-600');
        console.log('激活按钮:', selectedButton.id);
      } else {
        console.error('未找到标签页按钮:', tabName);
      }
    }

    // 页签切换函数 - 只处理模态框内的页签，不影响主标签页
    function showTab(tabName) {
      console.log('切换模态框页签:', tabName);
      
      // 只隐藏模态框内的页签内容，不影响主标签页
      const modalTabContents = document.querySelectorAll('[id$="-tab"]');
      modalTabContents.forEach(content => {
        content.classList.add('hidden');
        console.log('隐藏模态框页签:', content.id);
      });
      
      // 只处理模态框内的页签按钮
      const modalTabButtons = document.querySelectorAll('[data-tab]');
      modalTabButtons.forEach(button => {
        button.classList.remove('border-b-2', 'border-blue-500', 'text-blue-600');
        button.classList.add('border-b-2', 'border-transparent', 'text-gray-500');
      });
      
      // 显示选中的页签内容
      const selectedTab = document.getElementById(tabName + '-tab');
      if (selectedTab) {
        selectedTab.classList.remove('hidden');
        console.log('显示模态框页签:', selectedTab.id);
        
        // 如果是预研环节页签，加载审批历史
        if (tabName === 'research') {
          console.log('切换到预研环节页签，准备加载审批历史...');
          loadApprovalHistory();
        }
      } else {
        console.error('未找到模态框页签内容:', tabName + '-tab');
      }
      
      // 激活选中的页签按钮
      const selectedButton = document.querySelector(`[data-tab="${tabName}"]`);
      if (selectedButton) {
        selectedButton.classList.remove('border-transparent', 'text-gray-500');
        selectedButton.classList.add('border-blue-500', 'text-blue-600');
        console.log('激活模态框页签按钮:', tabName);
      } else {
        console.error('未找到模态框页签按钮:', tabName);
      }
    }

    function createProject() {
      // 获取表单数据
      const projectName = document.getElementById('projectName').value;
      const projectManager = document.getElementById('projectManager').value;
      const assetType = document.getElementById('assetType').value;
      const projectDescription = document.getElementById('projectDescription').value;
      
      // 验证必填字段
      if (!projectName || !projectManager || !assetType) {
        alert('请填写项目名称、负责人和资产类型！');
        return;
      }
      
      // 创建新项目对象
      const newProject = {
        id: 'project' + Date.now(), // 生成唯一ID
        name: projectName,
        type: '数据资产',
        assetType: assetType,
        manager: projectManager,
        description: projectDescription,
        createDate: new Date().toISOString().split('T')[0], // 当前日期
        status: '项目已发起'
      };
      
      // 这里可以添加将项目保存到数据库或本地存储的逻辑
      console.log('新建项目:', newProject);
      
      // 显示成功提示
      alert('项目创建成功！');
      
      // 关闭新建项目模态框
      closeNewProjectModal();
      
      // 清空表单
      document.getElementById('newProjectForm').reset();
      
      // 可以选择刷新项目列表或直接添加到列表中
      // 这里可以根据实际需求实现
    }

    // 文件上传处理函数
    function handleFileUpload(event) {
      const files = event.target.files;
      const uploadedFilesContainer = document.getElementById('uploadedFiles');
      
      if (files.length > 0) {
        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          
          // 检查文件大小（10MB限制）
          if (file.size > 10 * 1024 * 1024) {
            alert(`文件 ${file.name} 超过10MB限制，请选择较小的文件。`);
            continue;
          }
          
          // 创建文件项
          const fileItem = document.createElement('div');
          fileItem.className = 'flex items-center justify-between bg-gray-50 p-2 rounded-md';
          fileItem.innerHTML = `
            <div class="flex items-center space-x-2">
              <i class="fas fa-file text-blue-500"></i>
              <span class="text-sm text-gray-700">${file.name}</span>
              <span class="text-xs text-gray-500">(${(file.size / 1024 / 1024).toFixed(2)} MB)</span>
            </div>
            <button type="button" onclick="removeFile(this)" class="text-red-500 hover:text-red-700">
              <i class="fas fa-times"></i>
            </button>
          `;
          
          uploadedFilesContainer.appendChild(fileItem);
        }
      }
      
      // 清空input，允许重复选择相同文件
      event.target.value = '';
    }

    // 移除文件函数
    function removeFile(button) {
      button.parentElement.remove();
    }

    // 拖拽上传相关函数
    function handleDragOver(event) {
      event.preventDefault();
      event.currentTarget.classList.add('border-blue-400', 'bg-blue-50');
    }

    function handleDragLeave(event) {
      event.preventDefault();
      event.currentTarget.classList.remove('border-blue-400', 'bg-blue-50');
    }

    function handleDrop(event) {
      event.preventDefault();
      event.currentTarget.classList.remove('border-blue-400', 'bg-blue-50');
      
      const files = event.dataTransfer.files;
      if (files.length > 0) {
        // 创建文件列表
        const fileList = new DataTransfer();
        for (let i = 0; i < files.length; i++) {
          fileList.items.add(files[i]);
        }
        
        // 触发文件上传处理
        const fileInput = document.getElementById('fileInput');
        fileInput.files = fileList.files;
        
        // 手动触发change事件
        const changeEvent = new Event('change', { bubbles: true });
        fileInput.dispatchEvent(changeEvent);
      }
    }

    // 加载审批历史
    function loadApprovalHistory() {
      console.log('开始加载审批历史...');
      console.log('当前查看的项目ID:', window.currentViewingProjectId);
      
      const projectId = window.currentViewingProjectId;
      if (!projectId) {
        console.error('没有设置当前查看的项目ID');
        return;
      }
      
      const projectData = getProjectData(projectId);
      console.log('获取到的项目数据:', projectData);
      
      const approvalHistoryContainer = document.getElementById('viewApprovalHistory');
      console.log('审批历史容器:', approvalHistoryContainer);
      
      if (!approvalHistoryContainer) {
        console.error('找不到审批历史容器元素');
        return;
      }
      
      // 检查是否有审批历史
      if (!projectData.approvalHistory || projectData.approvalHistory.length === 0) {
        console.log('项目没有审批历史，显示默认信息');
        approvalHistoryContainer.innerHTML = '<div class="text-sm text-gray-500 text-center py-4 bg-blue-50 border border-blue-200 rounded-lg"><i class="fas fa-info-circle text-blue-600 mr-2"></i>暂无审批历史</div>';
        return;
      }
      
      console.log('项目审批历史:', projectData.approvalHistory);
      
      // 生成审批历史HTML
      const historyHTML = projectData.approvalHistory.map(record => {
        const isApproved = record.status === 'approved';
        const isRejected = record.status === 'rejected';
        
        let statusClass = '';
        let statusIcon = '';
        let statusText = '';
        
        if (isApproved) {
          statusClass = 'bg-green-50 border-green-200';
          statusIcon = 'fa-check-circle text-green-600';
          statusText = '审批通过';
        } else if (isRejected) {
          statusClass = 'bg-red-50 border-red-200';
          statusIcon = 'fa-times-circle text-red-600';
          statusText = '审批驳回';
        }
        
        return `
          <div class="${statusClass} border rounded-lg p-3">
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-2">
                <i class="fas ${statusIcon}"></i>
                <span class="text-sm font-medium ${isApproved ? 'text-green-800' : 'text-red-800'}">${statusText}</span>
              </div>
              <span class="text-xs ${isApproved ? 'text-green-600' : 'text-red-600'}">${record.time}</span>
            </div>
            <div class="mt-2 text-sm ${isApproved ? 'text-green-700' : 'text-red-700'}">
              <p><strong>审批人：</strong>${record.approver}</p>
              <p><strong>审批意见：</strong>${record.remark}</p>
            </div>
          </div>
        `;
      }).join('');
      
      console.log('生成的审批历史HTML:', historyHTML);
      approvalHistoryContainer.innerHTML = historyHTML;
      console.log('审批历史加载完成');
    }
    
    // 计算费用汇总
    function calculateTotalCosts() {
      console.log('开始计算费用汇总...');
      
      let totalMaterialCost = 0;
      let totalLaborCost = 0;
      let totalExpenseCost = 0;
      
      // 获取所有阶段的料工费数据
      const stages = ['design', 'development', 'testing', 'deployment'];
      
      stages.forEach(stage => {
        const stageContainer = document.getElementById(`${stage}-tab`);
        if (stageContainer) {
          // 计算材料费用
          const materialRows = stageContainer.querySelectorAll('tr.bg-blue-50');
          materialRows.forEach(row => {
            const quantityInput = row.querySelector('input[placeholder="0"]');
            const priceInput = row.querySelector('input[placeholder="0.00"]');
            if (quantityInput && priceInput) {
              const quantity = parseFloat(quantityInput.value) || 0;
              const price = parseFloat(priceInput.value) || 0;
              totalMaterialCost += quantity * price;
            }
          });
          
          // 计算人工费用
          const laborRows = stageContainer.querySelectorAll('tr.bg-green-50');
          laborRows.forEach(row => {
            const quantityInput = row.querySelector('input[placeholder="0"]');
            const priceInput = row.querySelector('input[placeholder="0.00"]');
            if (quantityInput && priceInput) {
              const quantity = parseFloat(quantityInput.value) || 0;
              const price = parseFloat(priceInput.value) || 0;
              totalLaborCost += quantity * price;
            }
          });
          
          // 计算费用支出
          const expenseRows = stageContainer.querySelectorAll('tr.bg-yellow-50');
          expenseRows.forEach(row => {
            const quantityInput = row.querySelector('input[placeholder="0"]');
            const priceInput = row.querySelector('input[placeholder="0.00"]');
            if (quantityInput && priceInput) {
              const quantity = parseFloat(quantityInput.value) || 0;
              const price = parseFloat(priceInput.value) || 0;
              totalExpenseCost += quantity * price;
            }
          });
        }
      });
      
      // 更新费用汇总显示
      document.getElementById('totalMaterialCost').textContent = `¥${totalMaterialCost.toFixed(2)}`;
      document.getElementById('totalLaborCost').textContent = `¥${totalLaborCost.toFixed(2)}`;
      document.getElementById('totalExpenseCost').textContent = `¥${totalExpenseCost.toFixed(2)}`;
      document.getElementById('totalAllCost').textContent = `总计：¥${(totalMaterialCost + totalLaborCost + totalExpenseCost).toFixed(2)}`;
      
      console.log('费用汇总计算完成:', {
        material: totalMaterialCost,
        labor: totalLaborCost,
        expense: totalExpenseCost,
        total: totalMaterialCost + totalLaborCost + totalExpenseCost
      });
    }
    
    // 页面加载完成后自动计算费用汇总
    document.addEventListener('DOMContentLoaded', function() {
      // 延迟执行，确保所有元素都已加载
      setTimeout(() => {
        calculateTotalCosts();
      }, 1000);
    });
    
    // 监听费用输入变化，实时更新汇总
    function setupCostCalculation() {
      const costInputs = document.querySelectorAll('input[type="number"]');
      costInputs.forEach(input => {
        input.addEventListener('input', () => {
          setTimeout(calculateTotalCosts, 100);
        });
      });
    }
    
    // 在显示验收环节时计算费用汇总
    function showAcceptanceTab() {
      showTab('acceptance');
      setTimeout(calculateTotalCosts, 500);
    }
    
    // 财务汇总相关函数
    function showFinancialSummary() {
      // 显示财务汇总模态框
      document.getElementById('financialSummaryModal').classList.remove('hidden');
      
      // 加载财务数据
      loadFinancialData();
    }
    
    function closeFinancialSummaryModal() {
      document.getElementById('financialSummaryModal').classList.add('hidden');
    }
    
    function loadFinancialData() {
      // 模拟财务数据加载
      const currentYear = new Date().getFullYear();
      const quarters = [
        { quarter: `${currentYear}年Q1`, budget: 500000, expense: 450000, difference: 50000, rate: 90, note: '预算执行良好' },
        { quarter: `${currentYear}年Q2`, budget: 600000, expense: 580000, difference: 20000, rate: 97, note: '支出接近预算' },
        { quarter: `${currentYear}年Q3`, budget: 700000, expense: 650000, difference: 50000, rate: 93, note: '按计划执行' },
        { quarter: `${currentYear}年Q4`, budget: 800000, expense: 0, difference: 800000, rate: 0, note: '待执行' }
      ];
      
      // 填充季度汇总表格
      const tableBody = document.getElementById('quarterlySummaryTable');
      tableBody.innerHTML = quarters.map(q => `
        <tr class="hover:bg-gray-50">
          <td class="px-4 py-3 text-sm font-medium text-gray-900">${q.quarter}</td>
          <td class="px-4 py-3 text-sm text-gray-700">¥${q.budget.toLocaleString()}</td>
          <td class="px-4 py-3 text-sm text-gray-700">¥${q.expense.toLocaleString()}</td>
          <td class="px-4 py-3 text-sm ${q.difference >= 0 ? 'text-green-600' : 'text-red-600'}">¥${q.difference.toLocaleString()}</td>
          <td class="px-4 py-3 text-sm">
            <div class="flex items-center">
              <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                <div class="bg-blue-600 h-2 rounded-full" style="width: ${q.rate}%"></div>
              </div>
              <span class="text-sm text-gray-600">${q.rate}%</span>
            </div>
          </td>
          <td class="px-4 py-3 text-sm text-gray-600">${q.note}</td>
        </tr>
      `).join('');
      
      // 计算汇总数据
      const totalBudget = quarters.reduce((sum, q) => sum + q.budget, 0);
      const totalExpense = quarters.reduce((sum, q) => sum + q.expense, 0);
      const remainingBudget = totalBudget - totalExpense;
      const expenseRate = totalBudget > 0 ? Math.round((totalExpense / totalBudget) * 100) : 0;
      
      // 更新汇总信息
      document.getElementById('totalBudget').textContent = `¥${totalBudget.toLocaleString()}`;
      document.getElementById('totalExpense').textContent = `¥${totalExpense.toLocaleString()}`;
      document.getElementById('remainingBudget').textContent = `¥${remainingBudget.toLocaleString()}`;
      document.getElementById('expenseRate').textContent = `${expenseRate}%`;
      
      // 更新费用分类汇总
      document.getElementById('equipmentCost').textContent = '¥350,000';
      document.getElementById('materialCost').textContent = '¥180,000';
      document.getElementById('laborCost').textContent = '¥420,000';
      document.getElementById('otherDirectCost').textContent = '¥130,000';
      document.getElementById('totalDirectCost').textContent = '¥1,080,000';
      
      document.getElementById('managementCost').textContent = '¥45,000';
      document.getElementById('financialCost').textContent = '¥25,000';
      document.getElementById('otherIndirectCost').textContent = '¥30,000';
      document.getElementById('totalIndirectCost').textContent = '¥100,000';
    }
    
    function submitFinancialSummary() {
      // 提交财务汇总
      alert('财务汇总提交中...\n提交内容包括：\n• 季度财务汇总\n• 费用分类明细\n• 预算执行情况\n• 财务风险分析\n\n提交后将进入审批流程');
    }
  </script>
</body>
</html> 
</html> 